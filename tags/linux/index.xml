<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Linux on Edmonds Commerce Dev Blog</title>
    <link>https://edmondscommerce.github.io/tags/linux/</link>
    <description>Recent content in Linux on Edmonds Commerce Dev Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 12 Dec 2016 18:13:32 +0000</lastBuildDate>
    <atom:link href="https://edmondscommerce.github.io/tags/linux/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Replacing Failed Drive in Zfs Zpool (on Proxmox)</title>
      <link>https://edmondscommerce.github.io/replacing-failed-drive-in-zfs-zpool-on-proxmox/</link>
      <pubDate>Mon, 12 Dec 2016 18:13:32 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/replacing-failed-drive-in-zfs-zpool-on-proxmox/</guid>
      <description>

&lt;p&gt;Recently we had one of our Proxmox machines suffer a failed disk drive.&lt;/p&gt;

&lt;p&gt;Thankfully, replacing a failed disk in a ZFS zpool is remarkably simple if you know how.&lt;/p&gt;

&lt;p&gt;In this example, we are using the ZFS configuration as per the Proxmox installer which also creates a boot partition which is not part of the zpool. Seems like a pretty sensible idea to me.&lt;/p&gt;

&lt;p&gt;Here is how we can look at the status of our zpool and see that it has a failed disk:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@cluster1 zpool status -v
  pool: rpool
 state: DEGRADED
status: One or more devices could not be used because the label is missing or
    invalid.  Sufficient replicas exist for the pool to continue
    functioning in a degraded state.
action: Replace the device using &#39;zpool replace&#39;.
   see: http://zfsonlinux.org/msg/ZFS-8000-4J
  scan: none requested
config:

    NAME                      STATE     READ WRITE CKSUM
    rpool                     DEGRADED     0     0     0
      raidz1-0                DEGRADED     0     0     0
        sdb2                  ONLINE       0     0     0
        sdc2                  ONLINE       0     0     0
        sdd2                  ONLINE       0     0     0
        14456048953908038050  FAULTED      0     0     0  was /dev/sdd2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So you can see that &lt;code&gt;/dev/sdd2&lt;/code&gt; has died and is no longer available. The numeric ID that is in place of sdd2 is important so make sure you have note of it.&lt;/p&gt;

&lt;p&gt;Now lets assume that you have figured out which drive the failed one is, whipped it out and slotted in a shiny new replacement drive that is at least as big as the one it is replacing. The next step is to actually add in the new drive.&lt;/p&gt;

&lt;h1 id=&#34;step-one-know-your-drive-ids&#34;&gt;Step one: Know your Drive IDs&lt;/h1&gt;

&lt;p&gt;To avoid misery, you need to make absolutely sure you know which drives are which. If you replace a drive then the IDs (sda etc) can get shuffled around, so you need to double check.&lt;/p&gt;

&lt;p&gt;The easiest way I think is to look in &lt;code&gt;/dev/disk/by-id&lt;/code&gt; and in there you should notice one disk that has no partitions - that is your new one.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@cluster1 cd /dev/disk/by-id/
/dev/disk/by-id
root@cluster1 ll
total 0
drwxr-xr-x 2 root root 560 Dec 12 12:08 .
drwxr-xr-x 6 root root 120 Dec 12 12:08 ..
lrwxrwxrwx 1 root root   9 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRREL -&amp;gt; ../../sdd
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRREL-part1 -&amp;gt; ../../sdd1
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRREL-part2 -&amp;gt; ../../sdd2
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRREL-part9 -&amp;gt; ../../sdd9
lrwxrwxrwx 1 root root   9 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRS0J -&amp;gt; ../../sdc
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRS0J-part1 -&amp;gt; ../../sdc1
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRS0J-part2 -&amp;gt; ../../sdc2
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRS0J-part9 -&amp;gt; ../../sdc9
lrwxrwxrwx 1 root root   9 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRV9T -&amp;gt; ../../sdb
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRV9T-part1 -&amp;gt; ../../sdb1
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRV9T-part2 -&amp;gt; ../../sdb2
lrwxrwxrwx 1 root root  10 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YCRV9T-part9 -&amp;gt; ../../sdb9
lrwxrwxrwx 1 root root   9 Dec 12 12:08 ata-ST1000DX001-1NS162_Z4YE995W -&amp;gt; ../../sda
lrwxrwxrwx 1 root root   9 Dec 12 12:08 wwn-0x5000c50090cca172 -&amp;gt; ../../sdc
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cca172-part1 -&amp;gt; ../../sdc1
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cca172-part2 -&amp;gt; ../../sdc2
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cca172-part9 -&amp;gt; ../../sdc9
lrwxrwxrwx 1 root root   9 Dec 12 12:08 wwn-0x5000c50090cd24c4 -&amp;gt; ../../sdb
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cd24c4-part1 -&amp;gt; ../../sdb1
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cd24c4-part2 -&amp;gt; ../../sdb2
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cd24c4-part9 -&amp;gt; ../../sdb9
lrwxrwxrwx 1 root root   9 Dec 12 12:08 wwn-0x5000c50090cd2ff2 -&amp;gt; ../../sdd
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cd2ff2-part1 -&amp;gt; ../../sdd1
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cd2ff2-part2 -&amp;gt; ../../sdd2
lrwxrwxrwx 1 root root  10 Dec 12 12:08 wwn-0x5000c50090cd2ff2-part9 -&amp;gt; ../../sdd9
lrwxrwxrwx 1 root root   9 Dec 12 12:08 wwn-0x5000c50092c1f5b2 -&amp;gt; ../../sda
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So in our example, the new disk is &lt;code&gt;sda&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&#34;step-two-partitions&#34;&gt;Step two: Partitions&lt;/h1&gt;

&lt;p&gt;We need to get our drive set up with the right partition table. Thankfully this is easy enough because we can just copy this from a healthy drive.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Warning - make sure you have the next command right before running it&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;pre&gt;&lt;code&gt;# Use these variables to make sure you have this the right way around

newDisk=&#39;/dev/sda&#39;

healthyDisk=&#39;/dev/sdb&#39;

sgdisk -R &amp;quot;$newDisk&amp;quot; &amp;quot;$healthyDisk&amp;quot;
sgdisk -G &amp;quot;$newDisk
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;step-three-boot-partition&#34;&gt;Step three: Boot partition&lt;/h1&gt;

&lt;p&gt;In our example, partition one is boot and can be just copied directly from a healthy disk (we will sort out ZFS partition later)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Use these variables to make sure you have this the right way around

newDiskBootPartition=&#39;/dev/sda1&#39;

healthyDiskBootPartition=&#39;/dev/sdb1&#39;

dd if=&amp;quot;$healthyDiskBootPartition&amp;quot; of=&amp;quot;$newDiskBootPartition&amp;quot; bs=512
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;step-four-add-to-zpool&#34;&gt;Step four: Add to zpool&lt;/h1&gt;

&lt;p&gt;Now we are going to add the new disk to the zpool and replace the failed one.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;newDiskZFSPartition=&#39;/dev/sda2`
#Put your failed disk ID here - as reported in `zpool status -v` - eg 14456048953908038050
failedDiskPartitionID=&#39;&#39;

zpool replace rpool &amp;quot;$failedDiskPartitionID&amp;quot; &amp;quot;$newDiskZFSPartition&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That should give you the warning:
&lt;em&gt;Make sure to wait until resilver is done before rebooting.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;You can keep track of the reslivering process by running &lt;code&gt;zpool status -v&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;eg&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@cluster1 zpool status -v
  pool: rpool
 state: DEGRADED
status: One or more devices is currently being resilvered.  The pool will
    continue to function, possibly in a degraded state.
action: Wait for the resilver to complete.
  scan: resilver in progress since Mon Dec 12 12:14:43 2016
    91.9M scanned out of 1.87T at 7.66M/s, 71h0m to go
    22.6M resilvered, 0.00% done
config:

    NAME                        STATE     READ WRITE CKSUM
    rpool                       DEGRADED     0     0     0
      raidz1-0                  DEGRADED     0     0     0
        sdb2                    ONLINE       0     0     0
        sdc2                    ONLINE       0     0     0
        sdd2                    ONLINE       0     0     0
        replacing-3             UNAVAIL      0     0     0
          14456048953908038050  FAULTED      0     0     0  was /dev/sdd2
          sda2                  ONLINE       0     0     0  (resilvering)

errors: No known data errors

&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Note on this, the time to go (eg 71h0m) was wildly pessimistic - actually took around 4 hours&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&#34;step-five-reboot&#34;&gt;Step five: Reboot&lt;/h1&gt;

&lt;p&gt;Once the reslivering process has finished, you can reboot the machine to make sure that everything is back to normal health&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@cluster1 zpool status -v
  pool: rpool
 state: ONLINE
  scan: resilvered 456G in 4h42m with 0 errors on Mon Dec 12 16:57:37 2016
config:

    NAME        STATE     READ WRITE CKSUM
    rpool       ONLINE       0     0     0
      raidz1-0  ONLINE       0     0     0
        sdc2    ONLINE       0     0     0
        sdd2    ONLINE       0     0     0
        sde2    ONLINE       0     0     0
        sdb2    ONLINE       0     0     0

errors: No known data errors
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Basic Clustat and Clusvcadm Usage</title>
      <link>https://edmondscommerce.github.io/basic-clustat-and-clusvcadm-usage/</link>
      <pubDate>Wed, 02 Nov 2016 15:55:15 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/basic-clustat-and-clusvcadm-usage/</guid>
      <description>

&lt;p&gt;I had to work on one of UKFasts clustered servers today and learnt a few new commands. I wanted to record
these here mainly for my future self but hopefully you&amp;rsquo;ll find them useful too.&lt;/p&gt;

&lt;h1 id=&#34;clustat&#34;&gt;clustat&lt;/h1&gt;

&lt;p&gt;This is the first command you&amp;rsquo;ll want to run (as root) on the server. This will give you the current
status of all the cluster nodes and services.&lt;/p&gt;

&lt;h1 id=&#34;clusvcadm&#34;&gt;clusvcadm&lt;/h1&gt;

&lt;p&gt;This is the command you&amp;rsquo;ll use to managage services (such as mysql).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;-r &amp;ndash; relocate service. On UKFasts setup this will move the service to the other running node
(there are only 2).&lt;/li&gt;
&lt;li&gt;-e &amp;ndash; enable service. This is how you manually start services.&lt;/li&gt;
&lt;li&gt;-d &amp;ndash; disable service. This is how you manually stop services.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;useful-links&#34;&gt;Useful Links&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://linux.die.net/man/8/clustat&#34; target=&#34;_blank&#34;&gt;clustat man page&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://linux.die.net/man/8/clusvcadm&#34; target=&#34;_blank&#34;&gt;clusvcadm man page&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Basic atop Usage</title>
      <link>https://edmondscommerce.github.io/basic-atop-usage/</link>
      <pubDate>Wed, 26 Oct 2016 11:29:38 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/basic-atop-usage/</guid>
      <description>

&lt;h1 id=&#34;what-is-atop&#34;&gt;What is atop?&lt;/h1&gt;

&lt;p&gt;Taken from the man page:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The program atop is an interactive monitor to view the load on a Linux system. It shows the occupation
of the most critical hardware resources (from a performance point of view) on system level, i.e. cpu,
memory, disk and network.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&#34;raw-data-format&#34;&gt;Raw Data Format&lt;/h1&gt;

&lt;p&gt;The raw data format is a binary log file that atop can be configured to record. This log file can be
generated for any length of time and allows you to go back in time to debug system performance issues.&lt;/p&gt;

&lt;h1 id=&#34;setup&#34;&gt;Setup&lt;/h1&gt;

&lt;p&gt;You can install atop from most Linux repos or download it directly from their
&lt;a href=&#34;http://www.atoptool.nl/downloadatop.php&#34; target=&#34;_blank&#34;&gt;site&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In order to gain the benefits of the binary log file you can either configure atop to generate this
on an ongoing basis or you can run atop with the following command. This command would be most
useful for debugging easily repeatable bugs / issues.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;atop -w &amp;lt;log file path&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To configure atop for ongoing log generation you need to point a cron job at &lt;code&gt;atop.daily&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;0 0 * * * root /etc/atop/atop.daily
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;NOTE: this file seems to be missing from both Fedora and Centos when atop is installed from the repos.
I&amp;rsquo;m still looking into a fix for this.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;atop will write it&amp;rsquo;s log files to:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/var/log/atop/atop_YYYYMMDD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To read these log files use:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;atop -r &amp;lt;log file path&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;basic-usage&#34;&gt;Basic Usage&lt;/h1&gt;

&lt;p&gt;For more detailed usage info I recommend you check out the very detailed man page.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;? &amp;ndash; help&lt;/li&gt;
&lt;li&gt;g &amp;ndash; Generic output&lt;/li&gt;
&lt;li&gt;m &amp;ndash; Memory output&lt;/li&gt;
&lt;li&gt;d &amp;ndash; Disk output&lt;/li&gt;
&lt;li&gt;n &amp;ndash; Network output&lt;/li&gt;
&lt;li&gt;c &amp;ndash; Show commandline of the process&lt;/li&gt;
&lt;li&gt;u &amp;ndash; Show activity by user&lt;/li&gt;
&lt;li&gt;p &amp;ndash; Show cumulative activity per program&lt;/li&gt;
&lt;li&gt;z &amp;ndash; Freeze the output&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When viewing a binary log:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;t &amp;ndash; View next sample&lt;/li&gt;
&lt;li&gt;T &amp;ndash; View previous sample&lt;/li&gt;
&lt;li&gt;r &amp;ndash; Rewind to the beginning&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;useful-links&#34;&gt;Useful Links&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://linux.die.net/man/1/atop&#34; target=&#34;_blank&#34;&gt;atop(1) - Linux man page&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Find All Email Addresses in a Folder (eg Codebase)</title>
      <link>https://edmondscommerce.github.io/find-all-email-addresses-in-a-folder-eg-codebase/</link>
      <pubDate>Tue, 04 Oct 2016 16:12:06 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/find-all-email-addresses-in-a-folder-eg-codebase/</guid>
      <description>&lt;p&gt;Here is a nice little one liner to search recursively in a directory and then pull out all email addresses that it finds&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;grep -shoPR &#39;[a-zA-Z_]+?@domain.co.uk&#39; * | sort -u

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will quickly find all email addresses and hten give you a sorted unique list&lt;/p&gt;

&lt;p&gt;Handy!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>&#39;command failed: tar&#39; when running &#39;npm install phantomjs&#39;</title>
      <link>https://edmondscommerce.github.io/command-failed-tar-when-running-npm-install-phantomjs/</link>
      <pubDate>Thu, 15 Sep 2016 17:29:23 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/command-failed-tar-when-running-npm-install-phantomjs/</guid>
      <description>&lt;p&gt;As part of installing phantomjs when buoilding a development environment for Magento 2 I encountered a problem where it failed to install. The error presented to me was&lt;/p&gt;

&lt;p&gt;&lt;code&gt;Error: Command failed: tar jxf /usr/lib/node_modules/phantomjs/phantomjs/phantomjs-{version}.tar.bz2&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;I was able to run &lt;code&gt;tar&lt;/code&gt;, and &lt;code&gt;tar&lt;/code&gt; was in my &lt;code&gt;$PATH&lt;/code&gt;, so I was confused about the problem.&lt;/p&gt;

&lt;p&gt;Turns out because the file was a bzip one, it was trying to execute &lt;code&gt;bzip2&lt;/code&gt; within &lt;code&gt;tar&lt;/code&gt;, hence why it seemed like &lt;code&gt;tar&lt;/code&gt; was failing.&lt;/p&gt;

&lt;p&gt;Simple answer: &lt;code&gt;yum/dnf/apt-get install bzip2&lt;/code&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Nginx Allow Ip Range</title>
      <link>https://edmondscommerce.github.io/nginx-allow-ip-range/</link>
      <pubDate>Tue, 13 Sep 2016 09:59:14 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/nginx-allow-ip-range/</guid>
      <description>&lt;p&gt;When specifying Nginx config, a common requirement is to control access to particular routes or even servers and use IP addresses as the method of restriction.&lt;/p&gt;

&lt;p&gt;Generally that&amp;rsquo;s quite simple, you can just &lt;code&gt;allow 123.123.123.123;&lt;/code&gt; for any IPs you want to allow and then conclude with &lt;code&gt;deny all;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;However - what if you have quite a large range of IPs to block - do you need to do a separate allow for each line?&lt;/p&gt;

&lt;p&gt;The answer of course is no, there is a much more elegant solution, however it uses the rather opaque &lt;a href=&#34;https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing&#34; target=&#34;_blank&#34;&gt;CIDR&lt;/a&gt; format for specifying the range.&lt;/p&gt;

&lt;p&gt;I could explain it to you but I&amp;rsquo;d be lying if I pretended I understand it. Instead, here is a link to a great little calculator in which you can specify the starting and ending IPs and it will give you the correct CIDR notation to paste in - yay!&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.ipaddressguide.com/cidr#range&#34; target=&#34;_blank&#34;&gt;http://www.ipaddressguide.com/cidr#range&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Just paste in your starting and ending IPs (eg &lt;code&gt;123.123.123.100&lt;/code&gt; and &lt;code&gt;123.123.123.150&lt;/code&gt;) and press &lt;strong&gt;Calculate&lt;/strong&gt; and you will then get the CIDR version, in this instance:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;123.123.123.100/30
123.123.123.104/29
123.123.123.112/28
123.123.123.128/28
123.123.123.144/30
123.123.123.148/31
123.123.123.150/32
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Much better than 50 lines of config. I&amp;rsquo;d suggest putting a comment above it explaining what its actually doing in your config though.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Magento 2 Quick Start and Common Gotchas</title>
      <link>https://edmondscommerce.github.io/magento-2-quick-start-and-common-gotchas/</link>
      <pubDate>Mon, 05 Sep 2016 10:40:56 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-2-quick-start-and-common-gotchas/</guid>
      <description>

&lt;p&gt;This post is actually the content for a &lt;a href=&#34;http://www.meetup.com/PHP-E-Commerce-Leeds-Bradford-Meetup/events/233554811/&#34; target=&#34;_blank&#34;&gt;presentation&lt;/a&gt; I gave recently at the &lt;a href=&#34;http://www.meetup.com/PHP-E-Commerce-Leeds-Bradford-Meetup/&#34; target=&#34;_blank&#34;&gt;PHP E-Commerce Leeds/Bradford Meetup&lt;/a&gt;.
&lt;a name=&#34;contents&#34;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;contents&#34;&gt;Contents&lt;/h1&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#intro&#34;&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#installing_dependencies&#34;&gt;Installing Dependencies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#preparing_install&#34;&gt;Preparing to Install Magento 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#installing_magento2&#34;&gt;Installing and Configuring Magento 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#further&#34;&gt;Further Notes and Tips&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;a name=&#34;intro&#34;&gt;&lt;/a&gt;&lt;a href=&#34;#contents&#34;&gt;back to top&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;introduction&#34;&gt;Introduction&lt;/h1&gt;

&lt;p&gt;In this presentation, we will be getting &lt;a href=&#34;https://magento.com/developers/magento2&#34; target=&#34;_blank&#34;&gt;Magento 2&lt;/a&gt; installed and working. There are many ways you can approach this including choice of Linux distribution, database, web server, PHP version and many more. The following is by no means the only way to approach this task, but it is the way we have chosen at &lt;a href=&#34;https://www.edmondscommerce.co.uk&#34; target=&#34;_blank&#34;&gt;Edmonds Commerce&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In summary here are our choices:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Option&lt;/th&gt;
&lt;th&gt;Choice&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Linux Distribution&lt;/td&gt;
&lt;td&gt;CentOS 7&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Web Server&lt;/td&gt;
&lt;td&gt;Nginx&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Database&lt;/td&gt;
&lt;td&gt;Percona 5.6&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;PHP Version&lt;/td&gt;
&lt;td&gt;7 (not less than 7.0.6)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;PHP SAPI&lt;/td&gt;
&lt;td&gt;PHP-FPM&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;PHP OPcache&lt;/td&gt;
&lt;td&gt;Zend OPcache&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Magento Version&lt;/td&gt;
&lt;td&gt;Latest (2.1 at time of writing)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Magento Installation Type&lt;/td&gt;
&lt;td&gt;Integrator&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Magento Installation Method&lt;/td&gt;
&lt;td&gt;Command Line&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;We will write the article on the basis of you already having a clean Centos 7 installation. This could be a Virtual Machine, LXC container or an actual virtual or dedicated server. If you aren&amp;rsquo;t sure, I&amp;rsquo;d suggest starting out with &lt;a href=&#34;https://www.virtualbox.org/&#34; target=&#34;_blank&#34;&gt;VirtualBox&lt;/a&gt; as the easiest cross platform way to create local Virtual Machines.&lt;/p&gt;

&lt;p&gt;Unless otherwise specified, you can assume the commands provided are to be entered onto a BASH command line terminal on your Linux server.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; Where a command has a clear placeholder for your own value, you might want to copy/paste into a text editor and edit the command before you paste it into your terminal&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;a name=&#34;installing_dependencies&#34;&gt;&lt;/a&gt;&lt;a href=&#34;#contents&#34;&gt;back to top&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;installing-dependencies&#34;&gt;Installing Dependencies&lt;/h1&gt;

&lt;p&gt;This section is all about getting you form a basic Linux installation (CentOS in this case) and installing everything that you will need to run Magento 2.&lt;/p&gt;

&lt;p&gt;Magento provide some good documentation on &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/install-gde/system-requirements-tech.html&#34; target=&#34;_blank&#34;&gt;Magento 2 requirements&lt;/a&gt; which clearly describe what needs to be available. Here we are going to take our basic CentOS machine and get it ready with all the requirements in place.&lt;/p&gt;

&lt;h2 id=&#34;basic-centos-setup&#34;&gt;Basic CentOS Setup&lt;/h2&gt;

&lt;p&gt;The first thing I&amp;rsquo;d suggest you do with your CentoOS machine is run a full yum upgrade&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;yum -y upgrade
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Once this is done, it&amp;rsquo;s time to start installing some basics:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt;  the below is not a complete CentOS setup guide, its a taste of the kinds of things you might want to do. A full guide is beyond the scope of this article.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# some basics&lt;/span&gt;
yum -y install epel-release

yum -y install &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    htop &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    iftop &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    curl &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    wget &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    tar &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    vim &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    bash_completion &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    sudo &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    logrotate &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    p7zip &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    yum-utils &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    openssl    

&lt;span class=&#34;c1&#34;&gt;# cron install and start&lt;/span&gt;
yum -y install crontabs
service crond start
chkconfig crond on

&lt;span class=&#34;c1&#34;&gt;# install SSH - I leave securing it etc to you&lt;/span&gt;
yum install openssh-server
systemctl &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; sshd
systemctl start sshd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; For a production server, you will need to make sure that sufficient time and effort is put into &lt;strong&gt;properly locking it down and securing it&lt;/strong&gt;, or ensuring that your hosting company has done this for you.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;magento2-user&#34;&gt;Magento2 User&lt;/h2&gt;

&lt;p&gt;We now need to create a user that will be the owner of the files of the Magento 2 site. For our purposes, I&amp;rsquo;m going to call this user magento2.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;useradd magento2 -p YOUR_PASSWORD_HERE

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We will use this user later on.&lt;/p&gt;

&lt;h2 id=&#34;mysql&#34;&gt;MySQL&lt;/h2&gt;

&lt;p&gt;Magento requires MySQL 5.6&lt;/p&gt;

&lt;p&gt;This is quite a specific requirement and if you try to run it on another version you will see issues so it makes sense just to do what is recommended.&lt;/p&gt;

&lt;p&gt;Rather than use original MySQL, we tend to prefer to use Percona which has a reputation for high performance.&lt;/p&gt;

&lt;p&gt;Here are some commands to install Percona 5.6&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;yum -y install http://www.percona.com/downloads/percona-release/redhat/0.1-3/percona-release-0.1-3.noarch.rpm

yum -y install Percona-Server-server-56
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then we need to fix an issue with the MySQL socket permissions.&lt;/p&gt;

&lt;p&gt;Copy and paste all of the following into your terminal in one go:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;mv /usr/lib/systemd/system/mysqld.service /usr/lib/systemd/system/mysqld.orig

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;# Systemd service file for Percona Server&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;#&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;# # This service file is to start PS just with mysqld_safe&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;#&lt;/span&gt;

&lt;span class=&#34;s1&#34;&gt;[Unit]&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;Description=MySQL Percona Server&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;After=network.target&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;After=syslog.target&lt;/span&gt;

&lt;span class=&#34;s1&#34;&gt;[Install]&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;WantedBy=multi-user.target&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;Alias=mysql.service&lt;/span&gt;

&lt;span class=&#34;s1&#34;&gt;[Service]&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;# Needed to create system tables etc.&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;ExecStartPre=/usr/bin/mysql-systemd pre&lt;/span&gt;

&lt;span class=&#34;s1&#34;&gt;# Start main service&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;ExecStart=/usr/bin/mysqld_safe&lt;/span&gt;

&lt;span class=&#34;s1&#34;&gt;# Dont signal startup success before a ping works&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;ExecStartPost=/usr/bin/mysql-systemd post&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;ExecStartPost=/bin/bash -c &amp;quot;chmod 777 /var/lib/mysql/mysql.sock&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;# Give up if ping dont get an answer&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;TimeoutSec=600&lt;/span&gt;

&lt;span class=&#34;s1&#34;&gt;Restart=always&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;RestartSec=3&lt;/span&gt;
&lt;span class=&#34;s1&#34;&gt;PrivateTmp=false&amp;#39;&lt;/span&gt; &amp;gt; /usr/lib/systemd/system/mysqld.service

systemctl daemon-reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then get MySQL running&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;systemctl &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; mysqld

systemctl start mysqld

systemctl status mysqld
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then you need to secure your MySQL installation, set a root password etc. There is a simple way to do this, just run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;mysql_secure_installation
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You can just hit return for most quesions and accept the (sensible) default actions. The only thing you need to put in is the root password.&lt;/p&gt;

&lt;p&gt;Keep track of your root password as you will need that next.&lt;/p&gt;

&lt;p&gt;One you have done the MySQL secure installation, you should create a &lt;code&gt;.my.cnf&lt;/code&gt; file in the home folder of any users you want to be able to connect to mysql easily. For example &lt;code&gt;root&lt;/code&gt; and &lt;code&gt;magento&lt;/code&gt; users.&lt;/p&gt;

&lt;p&gt;First - create a BASH variable with your MySQL root password.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mysqlRootPassword&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;PUT_YOUR_ROOT_PASSWORD_HERE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then run the following to create your &lt;code&gt;.my.cnf&lt;/code&gt; files&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;[client]&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;user=root&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;password=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$mysqlRootPassword&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;   &amp;gt; ~/.my.cnf
chmod &lt;span class=&#34;m&#34;&gt;600&lt;/span&gt; ~/.my.cnf

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;[client]&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;user=root&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;password=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$mysqlRootPassword&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;   &amp;gt; /home/magento2/.my.cnf
chown magento2:magento2 /home/magento2/.my.cnf
chmod &lt;span class=&#34;m&#34;&gt;600&lt;/span&gt; /home/magento2/.my.cnf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;php-fpm&#34;&gt;PHP-FPM&lt;/h2&gt;

&lt;p&gt;PHP-FPM (Fast Process Manager) is currently the best practice approach for installing PHP. Also, if you want to use Nginx then it is basically essential as there is no equivalent of Apache&amp;rsquo;s mod_php for Nginx.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm

yum -y install php70w-fpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;extensions&#34;&gt;Extensions&lt;/h3&gt;

&lt;p&gt;We also need to make sure that a variety of PHP extensions are also installed. The following code snippet creates an array of extensions and then loops through and installs them. You need to copy and paste the whole snippet into your terminal.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;extensions&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=(&lt;/span&gt;
curl
dom
gd
mbstring
mcrypt
imap
cli
mysql
opcache
pdo
soap
xml
intl
bcmath
process
&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; extension in &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;extensions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[@]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
    yum -y install php70w-&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;extension&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We now have PHP installed and can run the following command to confirm:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;php -v
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We should see something along the lines of:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span&gt;&lt;/span&gt;PHP 7.0.10 (cli) (built: Aug 20 2016 07:47:25) ( NTS )
Copyright (c) 1997-2016 The PHP Group
Zend Engine v3.0.0, Copyright (c) 1998-2016 Zend Technologies
    with Zend OPcache v7.0.10, Copyright (c) 1999-2016, by Zend Technologies
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The important thing to note here is that we have a version of PHP 7 higher than 7.0.5&lt;/p&gt;

&lt;h3 id=&#34;configuration&#34;&gt;Configuration&lt;/h3&gt;

&lt;p&gt;We now need to modify PHP configuration to make sure the correct settings are in place.&lt;/p&gt;

&lt;h4 id=&#34;timezone&#34;&gt;Timezone&lt;/h4&gt;

&lt;p&gt;This needs to be set. If you are in the UK you probably want this to be set to
Europe/London&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;date.timezone = Europe/London&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/php.ini
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&#34;memory-limit&#34;&gt;Memory Limit&lt;/h4&gt;

&lt;p&gt;For development, compilation and other complex tasks, Magento needs a hefty memory limit. 2 GB is recommended. Obviously this means that you should be running this on a machine that has plenty of memory. If you are using Virtualbox or other virtualisation, make sure you allocate enough memory to your machine to be able to support it. We also need to get PHP configured with this memory limit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;memory_limit = 2G&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/php.ini
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&#34;errors&#34;&gt;Errors&lt;/h4&gt;

&lt;p&gt;For development, you need to get error reporting and displaying of errors set up. To do this you will need to open the file &lt;code&gt;/etc/php.ini&lt;/code&gt; and find the line &lt;code&gt;display_errors = Off&lt;/code&gt; and change the &lt;code&gt;Off&lt;/code&gt; to &lt;code&gt;On&lt;/code&gt;. There are other development related settings you might want to adjust as well.&lt;/p&gt;

&lt;h3 id=&#34;php-fpm-backend&#34;&gt;PHP-FPM backend&lt;/h3&gt;

&lt;p&gt;We need to have PHP-FPM listening for connections. There is a default &lt;code&gt;www&lt;/code&gt; pool however I generally prefer to create my own with just the config I need.&lt;/p&gt;

&lt;p&gt;To create a pool, simply make a new file in &lt;code&gt;/etc/php-fpm.d/&lt;/code&gt; called &lt;code&gt;php-fpm-backend.conf&lt;/code&gt;. In this file you can put your own choice of configuration options.&lt;/p&gt;

&lt;p&gt;You need to edit this file and enter in your chosen configuration. If you are not sure how to do this, you should probably install nano and use that as a command line text editor which is the easiest one to get started with.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;yum -y install nano
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /etc/php-fpm.d/
nano php-fpm-backend.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then for the file contents you can put something along the lines of:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span&gt;&lt;/span&gt;[php-fpm-backend]

listen = &amp;#39;/var/run/php-fcgi-php-fpm-backend.sock&amp;#39;
listen.allowed_clients = 127.0.0.1
listen.owner = nginx
listen.group = nginx
listen.mode = 0660

user = magento2
group = magento2

pm = ondemand
pm.max_children = 500
pm.start_servers = 50
pm.min_spare_servers = 50
pm.max_spare_servers = 50
pm.max_requests = 500

request_terminate_timeout = 600
;request_slowlog_timeout = 1
;slowlog = /var/log/php-fpm/php-fpm-backend-slow.log

catch_workers_output = yes

php_admin_value[error_log] = /var/log/php-fpm/php-fpm-backend-error.log
php_admin_flag[log_errors] = on
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; The user/group has been set to the magento2 user we created earlier&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I&amp;rsquo;d generally rename the default www pool so that it is disabled:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /etc/php-fpm.d
mv www.conf www.conf.disabled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You can&amp;rsquo;t start PHP-FPM until we have installed Nginx, lets do that now.&lt;/p&gt;

&lt;h2 id=&#34;nginx&#34;&gt;Nginx&lt;/h2&gt;

&lt;p&gt;For the web server, the thing that actually receives and serves HTTP requests, we are going to use Nginx&lt;/p&gt;

&lt;p&gt;To get the latest version, we will need to install the official Nginx repository&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;wget http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm
yum -y install nginx-release-centos-7-0.el7.ngx.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then to install Nginx we simply&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;yum -y install nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;configuration-1&#34;&gt;Configuration&lt;/h3&gt;

&lt;p&gt;Nginx requires the correct configuration to properly run a site and access PHP-FPM.&lt;/p&gt;

&lt;p&gt;Nginx has a nice file include syntax which allows you to keep your configuration organised and stick to the DRY principle, especially if you are configuring more than one site.&lt;/p&gt;

&lt;p&gt;I prefer to create a folder inside &lt;code&gt;/etc/nginx/&lt;/code&gt; called &lt;code&gt;includes&lt;/code&gt; which contains config files in the formant &lt;code&gt;filename.conf&lt;/code&gt;and then any configuration for specific vhosts can be included with the syntax &lt;code&gt;include includes/filename.conf;&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&#34;magento-2&#34;&gt;Magento 2&lt;/h4&gt;

&lt;p&gt;Configuring Nginx can be a bit tricky if you are not used to it. Thankfully Magento have provided a pretty good &lt;a href=&#34;https://github.com/magento/magento2/blob/develop/nginx.conf.sample&#34; target=&#34;_blank&#34;&gt;baseline Nginx configuration template&lt;/a&gt; to use for your sites. This configuration file requires you to define a variable value and then the rest of the configuration is based upon that. You can save this file to your includes directory. Note there are things in there that you might want to adjust as you see fit, for example the memory limit, so open it and have a look.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;mkdir -p /etc/nginx/includes

&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /etc/nginx/includes

wget https://raw.githubusercontent.com/magento/magento2/develop/nginx.conf.sample -O magento2.conf

vim magento2.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&#34;php-fpm-backend-1&#34;&gt;PHP-FPM backend&lt;/h4&gt;

&lt;p&gt;We need to let Nginx know about our PHP-FPM service, and we can add this with an &lt;code&gt;upstream&lt;/code&gt; block.&lt;/p&gt;

&lt;p&gt;Edit &lt;code&gt;/etc/nginx/nginx.conf&lt;/code&gt; and somewhere before  &amp;lsquo;include /etc/nginx/conf.d/*.conf&amp;rsquo; we need to add the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span&gt;&lt;/span&gt;    upstream fastcgi_backend {
            server unix:/var/run/php-fcgi-php-fpm-backend.sock;
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; the path to the socket is as you configured in your custom PHP-FPM pool above.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;vhost&#34;&gt;Vhost&lt;/h4&gt;

&lt;p&gt;Finally we need to set Nginx up to actually serve a site on a particular domain name. Thanks to the fact that the majority of required config is handled by the Magento include, our Vhost configuration can be quite sparse.&lt;/p&gt;

&lt;p&gt;The vhost configuration files live in &lt;code&gt;/etc/nginx/conf.d&lt;/code&gt; and by conventtion, the domain name should be reflected in the filename. For our purposes lets say the domain name is &lt;code&gt;www.magento2.local&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /etc/nginx/conf.d

cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; &amp;#39;EOF&amp;#39; &amp;gt;  www.magento2.local.conf&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;server {&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;    listen 80;&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;    server_name www.magento2.local;&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;    set $MAGE_ROOT /var/www/vhosts/www.magento2.local;&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;    include includes/magento2.conf;&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;    error_log /var/log/nginx/www.magento2.local.error.log info;&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;    access_log /var/log/nginx/www.magento2.local.access.log main;&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You can disable the default Nginx site by doing:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;mv default.conf default.conf.disabled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then you can make sure your Nginx configuration is correct by doing:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;nginx -t
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;h3 id=&#34;gotcha-nginx-pid-file-inconsistency&#34;&gt;&lt;em&gt;GOTCHA: Nginx PID file inconsistency&lt;/em&gt;&lt;/h3&gt;

&lt;p&gt;Unfortunatley the official Nginx repository installation has a mismatch between the &lt;code&gt;/etc/nginx/nginx.conf&lt;/code&gt; configuration and the systemd configuration in &lt;code&gt;/usr/lib/systemd/system/nginx.service&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;grep &lt;span class=&#34;s1&#34;&gt;&amp;#39;nginx.pid&amp;#39;&lt;/span&gt; /etc/nginx/nginx.conf
&lt;span class=&#34;c1&#34;&gt;# pid        /var/run/nginx.pid;&lt;/span&gt;

grep &lt;span class=&#34;s1&#34;&gt;&amp;#39;nginx.pid&amp;#39;&lt;/span&gt; /usr/lib/systemd/system/nginx.service
&lt;span class=&#34;c1&#34;&gt;# PIDFile=/run/nginx.pid&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We need the path the PID file to be the same in both files otherwise it won&amp;rsquo;t work. So to do this lets edit &lt;code&gt;/etc/nginx/nginx.conf&lt;/code&gt;, find the line &lt;code&gt;pid        /var/run/nginx.pid;&lt;/code&gt; and remove &lt;code&gt;/var&lt;/code&gt; so it becomes: &lt;code&gt;pid               /run/nginx.pid;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;You can do this using your choice of editor, eg nano&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nano /etc/nginx/nginx.conf
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;start-the-nginx-and-php-fpm-services&#34;&gt;Start the Nginx and PHP-FPM Services&lt;/h3&gt;

&lt;p&gt;Start Nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;systemctl &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; nginx
systemctl start nginx
systemctl status nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And then finally we need to start PHP-FPM&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;systemctl &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; php-fpm
systemctl start php-fpm
systemctl status php-fpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;create-vhost-folder-and-test&#34;&gt;Create Vhost Folder and Test&lt;/h3&gt;

&lt;p&gt;We need to make sure everything so far is working, so lets just do a phpinfo file.&lt;/p&gt;

&lt;p&gt;Lets make the document root and create an index file that calls &lt;code&gt;phpinfo();&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir -p /var/www/vhosts/www.magento2.local/pub
echo &#39;&amp;lt;?php phpinfo();&#39; &amp;gt; /var/www/vhosts/www.magento2.local/pub/index.php
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now on your &lt;strong&gt;local machine&lt;/strong&gt;, you need to create a HOSTS file entry to point to this installation. That is platform dependent but on linux you might do something like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo echo &amp;quot;192.168.1.123 www.magento2.local&amp;quot; &amp;gt;&amp;gt; /etc/hosts
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Where &lt;code&gt;192.168.1.123&lt;/code&gt; is whatever IP address your CentOS machine has. To see the IP address of your CentOS machine you can run &lt;code&gt;ip addr&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;You should now be able to go to &lt;a href=&#34;http://www.magento2.local/&#34; target=&#34;_blank&#34;&gt;http://www.magento2.local/&lt;/a&gt; and see the PHP info page.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;a name=&#34;preparing_install&#34;&gt;&lt;/a&gt;&lt;a href=&#34;#contents&#34;&gt;back to top&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;preparing-to-install-magento-2&#34;&gt;Preparing to Install Magento 2&lt;/h1&gt;

&lt;p&gt;This section is all about getting ready to actually install your Magento 2 site. There are a few options for installing Magento 2 however I have taken the liberty of choosing the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/install-gde/prereq/integrator_install.html&#34; target=&#34;_blank&#34;&gt;Integrator option&lt;/a&gt; using composer as that is the one that is most relevant to us.&lt;/p&gt;

&lt;h2 id=&#34;composer&#34;&gt;Composer&lt;/h2&gt;

&lt;p&gt;We are now nearly ready to start installing Magento 2 itself, there is one last tool we need to install: &lt;a href=&#34;https://getcomposer.org/&#34; target=&#34;_blank&#34;&gt;composer&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Composer has basically revolutionised PHP development, bringing us a solid and reliable dependency management system. It&amp;rsquo;s great that Magento haved decided to use it with Magento 2.&lt;/p&gt;

&lt;p&gt;In the spirit of getting this done quickly, here are the commands to install Composer, just run them:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;expectedSignature&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;wget https://composer.github.io/installer.sig -O - -q&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
php -r &lt;span class=&#34;s2&#34;&gt;&amp;quot;copy(&amp;#39;https://getcomposer.org/installer&amp;#39;, &amp;#39;composer-setup.php&amp;#39;);&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;actualSignature&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;php -r &lt;span class=&#34;s2&#34;&gt;&amp;quot;echo hash_file(&amp;#39;SHA384&amp;#39;, &amp;#39;composer-setup.php&amp;#39;);&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expectedSignature&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$actualSignature&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    php composer-setup.php
    rm composer-setup.php
    mv composer.phar /bin/composer
    composer --version
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
    &amp;gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ERROR: Invalid installer signature&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; 1
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;marketplace-authentication&#34;&gt;Marketplace Authentication&lt;/h2&gt;

&lt;p&gt;Before you can download Magento, you need to get access keys. There are full instructions &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/install-gde/prereq/connect-auth.html&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ultimately, you need to log in and get to &lt;a href=&#34;https://marketplace.magento.com/customer/accessKeys/list/&#34; target=&#34;_blank&#34;&gt;this page&lt;/a&gt; where you will see a Public Key and a Private Key.&lt;/p&gt;

&lt;p&gt;You have one set of keys by default. However you can generate as many as you need and I suggest you use this feature to give you a new set of keys for each project. This way, if ever a set of keys is compromised then you can simply remove the keys from your account.&lt;/p&gt;

&lt;p&gt;For our purposes, lets hit the big orange Create a New Access Key button and for the name put - www.magento2.local.&lt;/p&gt;

&lt;p&gt;This will then generate new keys for you. Take a note of these as we will need them later.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; Strongly advise you use separate access keys for each project. Why not just use the intended primary domain of the project as the key name.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;magento-file-owner&#34;&gt;Magento File Owner&lt;/h2&gt;

&lt;p&gt;So far, the guide has assumed that you are running commands as the root user of your machine. However, any Linux or Unix user will tell you that doing everything as root is definitely not a good idea.&lt;/p&gt;

&lt;p&gt;We need to change the owner of the vhost directory.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /var/www/vhosts/www.magento2.local
chown -R magento2:magento2 .
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And then we need to become the magento2 user:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;su magento2
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;_&lt;strong&gt;Note:&lt;/strong&gt; Read these &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/config-guide/prod/prod_file-sys-perms.html&#34; target=&#34;_blank&#34;&gt;official docs&lt;/a&gt; which describe how to properly lock down permissions in production_&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;From here on we are now running as the magento2 Linux user and can move onto installing Magento 2.&lt;/p&gt;

&lt;p&gt;First make sure you are the correct user:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;whoami
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You should be your magento2 user.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; Remember, from here you should not be running any commands as root, you should be the magento2 user&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;using-composer-create-project&#34;&gt;Using Composer Create Project&lt;/h2&gt;

&lt;p&gt;Get your access keys on hand (otherwise known as username and password).&lt;/p&gt;

&lt;p&gt;Firstly we need to clear out our pub directory and phpinfo file.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /var/www/vhosts/www.magento2.local
rm -rf pub
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then we are ready to use the composer create project to set up Magento 2:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;composer create-project --repository-url=https://repo.magento.com/ magento/project-community-edition .
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You will be asked for a username and password.&lt;/p&gt;

&lt;p&gt;The username is your &lt;strong&gt;Public Key&lt;/strong&gt; and the password is your &lt;strong&gt;Private Key&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Reminder, you can get these from &lt;a href=&#34;https://marketplace.magento.com/customer/accessKeys/list/&#34; target=&#34;_blank&#34;&gt;https://marketplace.magento.com/customer/accessKeys/list/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Once you run the command, you will have the option to store these credentials which I&amp;rsquo;d suggest is probably a good idea.&lt;/p&gt;

&lt;p&gt;You should then see a load of composer output along the lines of:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Installing magento/project-community-edition (2.1.1)
  - Installing magento/project-community-edition (2.1.1)
    Downloading: 100%         

Created project in .
Loading composer repositories with package information
Updating dependencies (including require-dev)
  - Installing magento/magento-composer-installer (0.1.11)
    Downloading: 100%         

  - Installing symfony/process (v2.8.10)
    Downloading: 100%         

  - Installing magento/framework (100.1.1)
    Downloading: 100%         

  - Installing magento/language-zh_hans_cn (100.1.0)
    Downloading: 100%         

# ...(continues for quite some time)

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And once that has completed you will see lots of suggestions of other things you might want to install with Composer, eg&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;magento/framework suggests installing ext-imagick (Use Image Magick &amp;gt;=3.0.0 as an optional alternative image processing library)
magento/module-theme suggests installing magento/module-theme-sample-data (Sample Data version:100.1.*)
magento/module-catalog suggests installing magento/module-catalog-sample-data (Sample Data version:100.1.*)
# ...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can ignore this for now&lt;/p&gt;

&lt;h2 id=&#34;magento-2-database&#34;&gt;Magento 2 Database&lt;/h2&gt;

&lt;p&gt;We need to create a MySQL database for Magento2 to use. Assuming you created a .my.cnf file in the home directory of your magento2 user, you can just run the following on the terminal:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;mysql -e &lt;span class=&#34;s2&#34;&gt;&amp;quot;CREATE DATABASE magento2_database CHARACTER SET utf8 COLLATE utf8_general_ci;&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now we need to create a user for this database, feel free to set usernames and passwords as you see fit, and make sure you take note as you will need them later.&lt;/p&gt;

&lt;p&gt;First set some variable values:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;dbUser&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;magento2_dbuser
 &lt;span class=&#34;nv&#34;&gt;dbPass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;YOUR_DB_USER_PASSWORD_HERE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And then use them to create the user&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt; mysql -e &lt;span class=&#34;s2&#34;&gt;&amp;quot;CREATE USER &amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbUser&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;@&amp;#39;localhost&amp;#39; IDENTIFIED BY &amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbPass&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39; &amp;quot;&lt;/span&gt;
 mysql -e &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;     GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, REFERENCES, INDEX, ALTER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, EVENT, TRIGGER &lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;     ON magento2_database.* &lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;     TO &amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbUser&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;@&amp;#39;localhost&amp;#39; IDENTIFIED BY &amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbPass&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;     flush privileges;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt; &amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And then double check its worked&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt; mysql -e &lt;span class=&#34;s2&#34;&gt;&amp;quot;SHOW GRANTS FOR &amp;#39;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbUser&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;@&amp;#39;localhost&amp;#39;&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;If you want to change the database name to something more meaningful then of course you are free to replace &lt;code&gt;magento2_database&lt;/code&gt; with whatever you would like, same goes for the user &lt;code&gt;magento2_dbuser&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&#34;permissions&#34;&gt;Permissions&lt;/h2&gt;

&lt;p&gt;Magento 2 developer documentation goes into a nice clear level of detail about how you might want ot set up permissions. You can read the relevant section &lt;a href=&#34;http://devdocs.magento.com/guides/v2.0/install-gde/prereq/file-system-perms.html#perms-private&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We&amp;rsquo;ve simplified our permissions by configuring PHP-FPM to run this pool as our magento2 user so the instructions aren&amp;rsquo;t completely relevant to our configuration, but are worth being aware of.&lt;/p&gt;

&lt;p&gt;One command we do need to run though is this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;chmod 700 bin/magento
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Which makes the CLI tool executable.&lt;/p&gt;

&lt;p&gt;You are now ready to actually install Magento2&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;a name=&#34;installing_magento2&#34;&gt;&lt;/a&gt;&lt;a href=&#34;#contents&#34;&gt;back to top&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;installing-and-configuring-magento-2&#34;&gt;Installing and Configuring Magento 2&lt;/h1&gt;

&lt;p&gt;This section takes us through the installation process and basic post install configuration&lt;/p&gt;

&lt;h2 id=&#34;command-line-install&#34;&gt;Command Line Install&lt;/h2&gt;

&lt;p&gt;We are going to use the command line installer which is nicely documented on the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/install-gde/install/cli/install-cli.html&#34; target=&#34;_blank&#34;&gt;official documentation&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The command line tool in Magento is likely to be something we use a lot so lets add it to our PATH.&lt;/p&gt;

&lt;p&gt;Then update your &lt;code&gt;~/.bashrc&lt;/code&gt; file to extend your PATH:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;PATH=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$PATH&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:/var/www/vhosts/www.magento2.local/bin&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt; ~/.bashrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now you need to move into the project root directory&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /var/www/vhosts/www.magento2.local
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We are going to prepare an installation script and then run it, so run the following command to create the script&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt; &#39;EOF&#39; &amp;gt; bin/installScript.bash
#!/usr/bin/env bash
magento setup:install \
    --admin-firstname &amp;quot;ADMIN_FIRSTNAME_HERE&amp;quot; \
    --admin-lastname &amp;quot;ADMIN_LASTNAME_HERE&amp;quot; \
    --admin-email &amp;quot;ADMIN_EMAIL_HERE&amp;quot; \
    --admin-user &amp;quot;ADMIN_USERNAME_HERE&amp;quot; \
    --admin-password &amp;quot;ADMIN_PASSWORD_HERE&amp;quot; \
    --db-host &amp;quot;localhost&amp;quot; \
    --db-name &amp;quot;magento2_database&amp;quot; \
    --db-user &amp;quot;magento2_dbuser&amp;quot; \
    --db-password &amp;quot;DB_PASSWORD_HERE&amp;quot; \
    --db-prefix &amp;quot;&amp;quot; \
    --base-url &amp;quot;http://www.magento2.local/&amp;quot; \
    --use-secure &amp;quot;0&amp;quot; \
    --language &amp;quot;en_GB&amp;quot; \
    --currency &amp;quot;GBP&amp;quot; \
    --timezone &amp;quot;Europe/London&amp;quot; \
    --use-rewrites 1 \
    --backend-frontname &amp;quot;admin&amp;quot;;
EOF
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then edit your script and replace the UPPER_CASE variables. If you previously installed nano then you can use that.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; Your password must be at least 7 characters and your password must include both numeric and alphabetic characters.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;pre&gt;&lt;code&gt;nano bin/installScript.bash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once you are done, you can make it executable&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;chmod 700 bin/installScript.bash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Finally, you are ready to run the install&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;./bin/installScript.bash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once that has completed you should be able to see the front end on&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.magento2.local/&#34; target=&#34;_blank&#34;&gt;http://www.magento2.local/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and the admin on&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.magento2.local/admin&#34; target=&#34;_blank&#34;&gt;http://www.magento2.local/admin&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;reinstallation-of-magento-2&#34;&gt;Reinstallation of Magento 2&lt;/h2&gt;

&lt;p&gt;Should there be any problems and you want to reinstall, you&amp;rsquo;ve now created a nice easy to use script to repeat the process without having to remember lots of parameters.&lt;/p&gt;

&lt;p&gt;To reinstall, simply:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mysql -e &amp;quot;DROP DATABASE IF EXISTS magento2_database;&amp;quot;
mysql -e &amp;quot;CREATE DATABASE magento2_database CHARACTER SET utf8 COLLATE utf8_general_ci;&amp;quot;
./bin/installScript.bash
chmod 700 bin/magento
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; This will totally wipe out the database (warning, that&amp;rsquo;s destructive). You might want to backup the database first just in case.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;post-install-tasks&#34;&gt;Post Install Tasks&lt;/h2&gt;

&lt;p&gt;There are some other tasks you probably want to do once you have the installation working:&lt;/p&gt;

&lt;h3 id=&#34;setup-cron-jobs&#34;&gt;Setup Cron Jobs&lt;/h3&gt;

&lt;p&gt;Cron jobs run on a schedule in the background and handle things like updating indexes and other background tasks. You can read more about the cron tasks on the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.0/config-guide/cli/config-cli-subcommands-cron.html#config-cli-cron-bkg&#34; target=&#34;_blank&#34;&gt;official docs&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We need to set up a crontab for our magento2 user with the correct entries.&lt;/p&gt;

&lt;p&gt;My preferred way to do this is to have a a &lt;code&gt;_crontab_temp&lt;/code&gt; file which is tracked in the project and can then be used to easily track and possibly revert any changes to cron configuration.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /var/www/vhosts/www.magento2.local
cat &amp;lt;&amp;lt; &#39;EOF&#39; &amp;gt; _crontab_temp
* * * * * /usr/bin/php /var/www/vhosts/www.magento2.local/bin/magento cron:run | grep -v &amp;quot;Ran jobs by schedule&amp;quot; &amp;gt;&amp;gt; /var/www/magento2/var/log/magento.cron.log
* * * * * /usr/bin/php /var/www/vhosts/www.magento2.local/update/cron.php &amp;gt;&amp;gt; /var/www/magento2/var/log/update.cron.log
* * * * * /usr/bin/php /var/www/vhosts/www.magento2.local/bin/magento setup:cron:run &amp;gt;&amp;gt; /var/www/magento2/var/log/setup.cron.log
EOF
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then to actually add this to the crontab, simply&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;crontab _crontab_temp

crontab -l
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;reindex&#34;&gt;Reindex&lt;/h3&gt;

&lt;p&gt;As described in the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.0/config-guide/cli/config-cli-subcommands-index.html&#34; target=&#34;_blank&#34;&gt;official docs&lt;/a&gt;, you can reindex on the command line easily using the magento command.&lt;/p&gt;

&lt;p&gt;Assuming you have already added the bin directory to your PATH, you can just run&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;magento indexer:reindex
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And you should see output along the lines of :&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Design Config Grid index has been rebuilt successfully in 00:00:00
Customer Grid index has been rebuilt successfully in 00:00:00
Category Products index has been rebuilt successfully in 00:00:00
Product Categories index has been rebuilt successfully in 00:00:00
Product Price index has been rebuilt successfully in 00:00:00
Product EAV index has been rebuilt successfully in 00:00:00
Stock index has been rebuilt successfully in 00:00:00
Catalog Rule Product index has been rebuilt successfully in 00:00:00
Catalog Product Rule index has been rebuilt successfully in 00:00:00
Catalog Search index has been rebuilt successfully in 00:00:00
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;change-modes&#34;&gt;Change Modes&lt;/h3&gt;

&lt;p&gt;Magento2 can run in one of three modes, production, default and developer. You want to run in production for live sites. For development locally, you probably want to be in developer mode.&lt;/p&gt;

&lt;p&gt;You can see your current mode by running&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;magento deploy:mode:show
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;By default, Magento 2 is in the aptly named mode &amp;ldquo;default&amp;rdquo;. This is a compromise and should not be used, you really want to be in either production or developer modes.&lt;/p&gt;

&lt;p&gt;You can change to developer mode by running these commands:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /var/www/vhosts/www.magento2.local
rm -rf /var/di/*
rm -rf /var/generation/* 
magento deploy:mode:set developer
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Read more about modes &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/config-guide/cli/config-cli-subcommands-mode.html&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt; and also &lt;a href=&#34;http://devdocs.magento.com/guides/v2.0/config-guide/bootstrap/magento-modes.html&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;compile&#34;&gt;Compile&lt;/h3&gt;

&lt;p&gt;Magento2 makes heavy use of compiled code PHP code. This takes your source PHP and creates &amp;ldquo;compiled&amp;rdquo; PHP code which is actually used in production.&lt;/p&gt;

&lt;p&gt;You can read about the compilation process on the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/config-guide/cli/config-cli-subcommands-compiler.html&#34; target=&#34;_blank&#34;&gt;official docs&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In a nutshell though, you simply need to run this command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;magento setup:di:compile
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once this has completed you should see output along the lines of:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Compilation was started.
%message% 0/7 [&amp;gt;---------------------------]   0% 1 sec 40.0 MiB%message% 0/7 [&amp;gt;---------------------------]   0% 1 sec 40.0 MiBProxies code generation... 0/7 [&amp;gt;---------------------------]   0% 1 sec 40.0 MiB
Proxies code generation... 1/7 [====&amp;gt;-----------------------]  14% 1 sec 42.0 MiB
Repositories code generation... 1/7 [====&amp;gt;-----------------------]  14% 1 sec 42.0 MiB
Repositories code generation... 2/7 [========&amp;gt;-------------------]  28% 13 secs 132.0 MiB
Service data attributes generation... 2/7 [========&amp;gt;-------------------]  28% 13 secs 132.0 MiB
Service data attributes generation... 3/7 [============&amp;gt;---------------]  42% 13 secs 134.0 MiB
Application code generator... 3/7 [============&amp;gt;---------------]  42% 13 secs 134.0 MiB
Application code generator... 4/7 [================&amp;gt;-----------]  57% 29 secs 150.0 MiB
Interceptors generation... 4/7 [================&amp;gt;-----------]  57% 29 secs 150.0 MiB
Interceptors generation... 5/7 [====================&amp;gt;-------]  71% 45 secs 168.0 MiB
Area configuration aggregation... 5/7 [====================&amp;gt;-------]  71% 45 secs 168.0 MiB
Area configuration aggregation... 6/7 [========================&amp;gt;---]  85% 2 mins 238.0 MiB
Interception cache generation... 6/7 [========================&amp;gt;---]  85% 2 mins 238.0 MiB
Interception cache generation... 7/7 [============================] 100% 2 mins 238.0 MiB
Generated code and dependency injection configuration successfully.
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;a name=&#34;further&#34;&gt;&lt;/a&gt;&lt;a href=&#34;#contents&#34;&gt;back to top&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&#34;further-notes-and-tips&#34;&gt;Further Notes and Tips&lt;/h1&gt;

&lt;h2 id=&#34;documentation-versions&#34;&gt;Documentation Versions&lt;/h2&gt;

&lt;p&gt;If you search Google, you will probably find the docs for version 2.0 in the results. You can see this in the URL &lt;code&gt;http://devdocs.magento.com/guides/v2.0/....&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Actually, you need to be looking at the documentation for the version you are working with, currently 2.1. If you do find a page in the results, you can generally just change the version number in the URL to make sure you are looking at the right version, eg &lt;code&gt;http://devdocs.magento.com/guides/v2.1/...&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Often, there will be no difference, but occasionally there are signficant differences and you can end up going down the rabbit hole if you are reading the wrong docs.&lt;/p&gt;

&lt;p&gt;On the flip side, you might find that the documentation for your version is incomplete and so you need to use the previous documentation. That&amp;rsquo;s fine, but I&amp;rsquo;d strongly suggest you check for up to date docs first and then use legacy docs as required.&lt;/p&gt;

&lt;h2 id=&#34;installing-the-sample-data&#34;&gt;Installing the Sample Data&lt;/h2&gt;

&lt;p&gt;Magento 1 had an option to install a set of sample data which was really handy. It gave you a nice representation of the different kinds of products, categories and configurations you might expect to see on a real store. The other advantage was that everyone could base their customisations on the default theme with this sample data and if it worked with this then there was a good chance it would work in general.&lt;/p&gt;

&lt;p&gt;That concept has been carried over into Magento 2 and so, depending on the type of project you are working on, you might want to install the sample data.&lt;/p&gt;

&lt;p&gt;You can read the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/install-gde/install/sample-data.html&#34; target=&#34;_blank&#34;&gt;official docs&lt;/a&gt; (incomplete at the time of writing). We will be using the composer method for which there is a magento CLI tool command.&lt;/p&gt;

&lt;p&gt;To fully install the sample data, run the following commands&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;magento sampledata:deploy
magento setup:upgrade
magento setup:di:compile
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; You must be in developer mode to install the sample data&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;As the docs say though, you should not build a production site from a database that has had the sample data. Your main use case for using the sample data is for generic theme/module development that you expect to be used on multiple client sites.&lt;/p&gt;

&lt;h2 id=&#34;flushing-caches-and-indexes&#34;&gt;Flushing Caches and Indexes&lt;/h2&gt;

&lt;p&gt;When developing, it&amp;rsquo;s likely that you will want to flush caches and reindex on a fairly regular basis. Thankfully the new CLI tool makes this simple&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;magento cache:clean
magento indexer:reindex
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;updating&#34;&gt;Updating&lt;/h2&gt;

&lt;p&gt;As Magento 2 is using composer, you can update all of the library and framework code using the standard composer syntax, simply:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /var/www/vhosts/www.magento2.local
composer update
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will check all of the packages in the project for updated versions and will then update them. Finally it will update the &lt;code&gt;composer.lock&lt;/code&gt; file with these updated versions.&lt;/p&gt;

&lt;h2 id=&#34;removing-index-php-from-front-end-urls&#34;&gt;Removing index.php From Front End URls&lt;/h2&gt;

&lt;p&gt;We don&amp;rsquo;t want index.php in our front end URLs and as we are using Nginx there is no need to.&lt;/p&gt;

&lt;p&gt;To remove them we need to log into the Magento admin and then go to&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;STORES -&amp;gt; configuration -&amp;gt; GENERAL -&amp;gt; Web -&amp;gt; Search Engine Optimisation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;In here there is a drop down option for Use Web Server Rewrites. Set this to Yes, then flush all caches and the index.php should be gone from URLs.&lt;/p&gt;

&lt;h2 id=&#34;varnish-cache&#34;&gt;Varnish Cache&lt;/h2&gt;

&lt;p&gt;Varnish is a full page caching system that sits in front of your normal web server as a reverse proxy. This is something that you can do with Nginx on it&amp;rsquo;s own. What Varnish does which is also allows elements of the page to still be dynamic, pulling in just those elements using a technique called Edge Side Includes or ESI.&lt;/p&gt;

&lt;p&gt;Magento 1 does not officially support Varnish but most production sites these days will be using it thanks to third party extentions that provide Varnish support.&lt;/p&gt;

&lt;p&gt;For Magento 2, Varnish support has been baked in and is something that you almost certainly want to enable to get the best performance.&lt;/p&gt;

&lt;p&gt;You can read the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/config-guide/varnish/config-varnish.html&#34; target=&#34;_blank&#34;&gt;offical documentation&lt;/a&gt; about Varnish to understand more about it.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The following commands should be run as the root user&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;For us to install Varnish, we firstly need to make sure that we are going to get a compatible version.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; for Magento 2, you really want to be running Varnish 4&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;To find out exactly what version you would install you can run this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;yum info varnish
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Which should give us something along the lines of:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: centos.mirroring.pulsant.co.uk
 * epel: fr.mirror.babylon.network
 * extras: mirror.econdc.com
 * updates: mirror.ukhost4u.com
 * webtatic: uk.repo.webtatic.com
Available Packages
Name        : varnish
Arch        : x86_64
Version     : 4.0.3
Release     : 3.el7
Size        : 421 k
Repo        : epel/x86_64
Summary     : High-performance HTTP accelerator
URL         : http://www.varnish-cache.org/
Licence     : BSD
Description : This is Varnish Cache, a high-performance HTTP accelerator.
            : Documentation wiki and additional information about Varnish is
            : available on the following web site: http://www.varnish-cache.org/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note the bit we care about - &lt;code&gt;Version     : 4.0.3&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&#34;install-varnish&#34;&gt;Install Varnish&lt;/h3&gt;

&lt;p&gt;After we have confirmed that we will definitely get Varnish 4 from yum, we can do the install&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;yum -y install varnish
varnishd -V
systemctl enable varnish
systemctl start varnish
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;configure-varnish-and-nginx&#34;&gt;Configure Varnish and Nginx&lt;/h3&gt;

&lt;p&gt;One thing that needs to be understood is that Varnish is a web server and listens to HTTP connections in exactly the same was as Nginx. We need to decide which of the two services is going to be the one that external browsers are actually hitting.&lt;/p&gt;

&lt;p&gt;Another factor in here is that Varnish does not support SSL, so if you are planning to use HTTPS (and you really should) then you will need Nginx to be the server that clients connect to on port 80 (for redirecting to SSL) and port 443 (for the actual SSL web traffic).&lt;/p&gt;

&lt;p&gt;Here is how we are going to lay this out:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;center&#34;&gt;Port&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;Public&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;Server&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;Connects To&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;80 (http)&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;yes&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Nginx&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Varnish (6081)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;443 (https)&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;yes&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Nginx&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Varnish (6081)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;6081&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;no&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Varnish&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Nginx (8080)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;8080&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;no&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Nginx&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;PHP-FPM (socket)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;As this article has more of a development focus, we will not worry about the https 443 for now.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note:&lt;/strong&gt; this differs from the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/config-guide/varnish/config-varnish-configure.html&#34; target=&#34;_blank&#34;&gt;official documentation&lt;/a&gt; which recommends that you have Varnish listening on port 80.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The first thing we need to do is get our main Magento server listening on port 8080. To do this we need to edit the file &lt;code&gt;/etc/nginx/conf.d/www.magneto2.local.conf&lt;/code&gt; and change &lt;code&gt;listen 80;&lt;/code&gt; to &lt;code&gt;listen 127.0.0.1:8080;&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nano /etc/nginx/conf.d/www.magento2.local.conf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We also need to add a new server block in this file which will actually listen on port 80 (and optionally also 443) and will then pass the request to Varnish.&lt;/p&gt;

&lt;p&gt;Run the following command to add a new server block which is listening on port 80 and 443 and proxy passing to Varnish on 6081&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat &amp;lt;&amp;lt; &#39;EOF&#39; &amp;gt;&amp;gt; /etc/nginx/conf.d/www.magento2.local.conf
server{
    listen 80;
    #uncomment the below 4 lines and update the paths to your SSL keys to enable SSL
    #listen 443 ssl http2;
    #ssl_certificate      /etc/nginx/ssl/domain.com.crt;
    #ssl_certificate_key  /etc/nginx/ssl/domain.com.key;
    #ssl_trusted_certificate /etc/nginx/ssl/domain.com.crt;
    server_name www.magento2.local;
    location / {
        proxy_pass            http://127.0.0.1:6081;
        proxy_read_timeout    90;
        proxy_connect_timeout 90;
        proxy_redirect        off;
        proxy_max_temp_file_size 0;
        proxy_buffering off;
        proxy_request_buffering off;
        #Enable Keepalives
        proxy_http_version 1.1;
        proxy_set_header Connection &amp;quot;&amp;quot;;
        
        proxy_set_header      X-Real-IP $remote_addr;
        proxy_set_header      X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header      X-Forwarded-Proto http;
        proxy_set_header      X-Forwarded-Port 80;
        proxy_set_header      Host $host;
    }
    error_log /var/log/nginx/public.www.magento2.local.error.log info;
    access_log /var/log/nginx/public.www.magento2.local.access.log main;
}
EOF

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once this is done we need to test and then reload nginx config&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nginx -t

systemctl reload nginx
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And after this, you should be able to access the site in your browser. You might notice it is a lot faster.&lt;/p&gt;

&lt;h3 id=&#34;configure-magento-to-use-varnish&#34;&gt;Configure Magento to Use Varnish&lt;/h3&gt;

&lt;p&gt;You can read the &lt;a href=&#34;http://devdocs.magento.com/guides/v2.1/config-guide/varnish/config-varnish-magento.html&#34; target=&#34;_blank&#34;&gt;official documentation&lt;/a&gt; which covers what needs to be done.&lt;/p&gt;

&lt;p&gt;Some of the config might not be obvious though, here is what I would suggest for starters:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;center&#34;&gt;Option&lt;/th&gt;
&lt;th align=&#34;center&#34;&gt;Value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;Caching Application&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Varnish&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;TTL for public content&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;Use system value&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;Access list&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;localhost&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;Backend host&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;localhost&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;center&#34;&gt;Backend port&lt;/td&gt;
&lt;td align=&#34;center&#34;&gt;8080&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Once you have filled this out, you will need to hit the orange Save Config button in the top right.&lt;/p&gt;

&lt;p&gt;Once the config is saved, you can export the VCL file. You need to hit the button Export VCL for Varnish 4. This will download a file to your &lt;strong&gt;local machine&lt;/strong&gt; which you should open in a text editor.&lt;/p&gt;

&lt;p&gt;We need to take the contents of this file and get them onto a file on your server. For now lets just copy and paste the contents.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Local Machine:&lt;/strong&gt; open the downloaded vcl file, select all and copy the contents&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Server:&lt;/strong&gt; run the following commands and then paste the contents, save and close&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /etc/varnish
mv default.vcl default.vcl.backup
nano default.vcl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Paste in the contents and save the file, then we need to restart Varnish&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;systemctl restart varnish
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;For some reason I found that Varnish cache was not clearing unless I also ran the following:&lt;/p&gt;

&lt;p&gt;Run the following as the &lt;strong&gt;magento2&lt;/strong&gt; user:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;magento setup:config:set --http-cache-hosts=127.0.0.1:6081
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This was mentioned on &lt;a href=&#34;http://devdocs.magento.com/guides/v2.0/config-guide/varnish/use-varnish-cache.html#use-varnish-magento-purge&#34; target=&#34;_blank&#34;&gt;this page of the official docs&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After running this command, doing &lt;code&gt;magento cache:clean&lt;/code&gt; will flush the Varnish cache&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Ssh Copy Id As Another User in Bash</title>
      <link>https://edmondscommerce.github.io/ssh-copy-id-as-another-user-in-bash/</link>
      <pubDate>Wed, 27 Jul 2016 13:01:02 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/ssh-copy-id-as-another-user-in-bash/</guid>
      <description>&lt;p&gt;Here is a nice BASH one liner that will allow you as (presumably root) copy another users SSH keys up to a server.&lt;/p&gt;

&lt;p&gt;This is ideal for setting up multiple users on a machine as the root user in bulk as part of a batch process.&lt;/p&gt;

&lt;p&gt;Ideally you will have already added the server to your ssh_config file so that ports, users etc do not need to be specified and also you have run &lt;code&gt;ssh-copy-id serverName&lt;/code&gt; as root so that you no longer have to set any passwords.&lt;/p&gt;

&lt;p&gt;Then for each user, simply run this command, replacing the placeholders as you see fit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;cat /home/__USER__/.ssh/id_rsa.pub &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh __SERVER__ &lt;span class=&#34;s2&#34;&gt;&amp;quot;tee -a ~/.ssh/authorized_keys&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I tried a few techniques before settling on this one as by far the cleanest and easiest. Original credit goes to this &lt;a href=&#34;http://superuser.com/a/978182/573510&#34; target=&#34;_blank&#34;&gt;answer on superuser.com&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Fixing Logrotate Rotating Its Own Files</title>
      <link>https://edmondscommerce.github.io/fixing-logrotate-rotating-its-own-files/</link>
      <pubDate>Tue, 26 Jul 2016 17:50:25 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/fixing-logrotate-rotating-its-own-files/</guid>
      <description>&lt;p&gt;From time to time I come across a server that has had logRotate setup in such a way that it is rotating its own files creating hundreds of copies and increasing disk usage rather than controlling it&lt;/p&gt;

&lt;p&gt;This is caused by a misconfiguration of the logrotate config file. The file that is causing the problems can normally be found be running the following command&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;user@host$ grep &lt;span class=&#34;s1&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; /etc/logrotate.d/*
/etc/logrotate.d/misconfiguredFile:/path/to/logs/* &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Which should display all of the paths that include a wild card that are being checked and rotated. The problem happens when the file path end s with a wildcard, as on the next run the newly rotated files will be checked and rotated again.&lt;/p&gt;

&lt;p&gt;The simple way to fix this is to either specify which files need to be rotated exactly, or add the expected suffix to the path (i.e. /path/to/dir/*log).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Running out of disk space but df shows you have lots of space left</title>
      <link>https://edmondscommerce.github.io/linux/vps/server/running-out-of-disk-space-but-df-shows-you-have-lots-of-space-left.html</link>
      <pubDate>Thu, 07 May 2015 10:32:04 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/linux/vps/server/running-out-of-disk-space-but-df-shows-you-have-lots-of-space-left.html</guid>
      <description>&lt;p&gt;Had a strange occurency this morning with an server reporting it had no disk space when disk usage according to df was at 50%. After some head scratching I decided to read the man page for the df command and came across the -i flag. According the man page this lists inode information instead of block usage. After running it I got the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;Filesystem      Inodes   IUsed  IFree IUse% Mounted on
/dev/xvda1     &lt;span class=&#34;m&#34;&gt;2621440&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2621440&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  100% /
udev            &lt;span class=&#34;m&#34;&gt;124879&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;398&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;124481&lt;/span&gt;    1% /dev
tmpfs           &lt;span class=&#34;m&#34;&gt;126892&lt;/span&gt;     &lt;span class=&#34;m&#34;&gt;288&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;126604&lt;/span&gt;    1% /run
none            &lt;span class=&#34;m&#34;&gt;126892&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;126888&lt;/span&gt;    1% /run/lock
none            &lt;span class=&#34;m&#34;&gt;126892&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;126891&lt;/span&gt;    1% /run/shm
none            &lt;span class=&#34;m&#34;&gt;126892&lt;/span&gt;       &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;126891&lt;/span&gt;    1% /run/user
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;So it turned out that the system had reached its max inodes so the next line of investigation was to find any excess of files in an directory. Which was sone by using:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; i in /var/*&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; find &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; wc -l&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This will list the total number of files in a given directory. You can change the path to work your way down the directory tree finding directories with lots of files. In the end we found excess of old logs which I was able to remove.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Blocking Direct IP Access in Apache</title>
      <link>https://edmondscommerce.github.io/apache/blocking-direct-ip-access-in-apache.html</link>
      <pubDate>Wed, 03 Dec 2014 15:08:37 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/apache/blocking-direct-ip-access-in-apache.html</guid>
      <description>&lt;p&gt;If you are using Name based virtual hosts, you may want to simply block any bots etc that try to access your server by direct IP address. It&amp;rsquo;s unlikely a real user would try to hit your server by using the actual IP address.&lt;/p&gt;

&lt;p&gt;To do this, you can use this Virtual Host config:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;VirtualHost *:80&amp;gt;
    ServerName 123.123.123.123
    Redirect 403 /
    ErrorDocument 403 &amp;quot;No&amp;quot;
    DocumentRoot /dev/null/
    UseCanonicalName Off
    UserDir disabled
&amp;lt;/VirtualHost&amp;gt;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Of course, please change the IP to the real server IP address(es)&lt;/p&gt;

&lt;p&gt;And that&amp;rsquo;s it, anyone trying to hit the server by IP address will get a simple 403 error.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Compile NGINX with PageSpeed and ModSecurity on CentOS</title>
      <link>https://edmondscommerce.github.io/linux/compile-nginx-with-pagespeed-and-modsecurity-on-centos.html</link>
      <pubDate>Tue, 11 Nov 2014 14:06:37 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/linux/compile-nginx-with-pagespeed-and-modsecurity-on-centos.html</guid>
      <description>&lt;p&gt;ModSecurity is a brilliant addition to web servers to block any nefarious requests before they hit your application.
This improves security and reduces load if your server comes under attack as the requests are killed very quickly.&lt;/p&gt;

&lt;p&gt;PageSpeed is a module provided by Google to automatically improve the performance of your web pages in the browser. In a stroke it can offer a much more responsive front end with just a few configuration options.&lt;/p&gt;

&lt;p&gt;Nginx is a very fast and lightweight web server ideal for using with back end servers such as PHP-FPM.&lt;/p&gt;

&lt;p&gt;Here is a script that will download and compile Nginx with the two modules and also apply the correct ModSecurity configuration.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Please run as root&amp;quot;&lt;/span&gt;
yum install gcc-c++ pcre-dev pcre-devel zlib-devel make unzip

&lt;span class=&#34;nv&#34;&gt;NPS_VERSION&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1.9.32.2&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;NGINX_VERSION&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1.7.7&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;MODSEC_VERSION&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2.8.0

&lt;span class=&#34;nv&#34;&gt;NGINX_EXTRA_MODULES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot; --with-http_realip_module --with-http_ssl_module &amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;NGINX_ADD_MODULES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;WORKING_DIRECTORY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/opt/nginx_with_pagespeed_and_mod_security

mkdir -p &lt;span class=&#34;nv&#34;&gt;$WORKING_DIRECTORY&lt;/span&gt;


&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===============================================================================&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Mod Security&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Installing dependencies, grabbing the repo, checking out the tag for our version and building it&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;------------&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$WORKING_DIRECTORY&lt;/span&gt;
yum install libtool httpd-devel libxml2 libxml2-devel
git clone https://github.com/SpiderLabs/ModSecurity.git
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ModSecurity
git checkout tags/v&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;MODSEC_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;
./autogen.sh
./configure --enable-standalone-module --disable-mlogc
make
make install
&lt;span class=&#34;nv&#34;&gt;NGINX_ADD_MODULES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NGINX_ADD_MODULES&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; --add-module=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$WORKING_DIRECTORY&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/ModSecurity/nginx/modsecurity &amp;quot;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Mod Security Config and Rules&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;-----------------------------&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;For nginx, we have to get all the config and cat it all into one single config file&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
wget https://raw.githubusercontent.com/SpiderLabs/ModSecurity/master/modsecurity.conf-recommended
cat modsecurity.conf-recommended  &amp;gt; /etc/nginx/modsecurity.conf
wget https://github.com/SpiderLabs/owasp-modsecurity-crs/tarball/master -O owasp-modsecurity-crs.tar.gz
tar -xvzf owasp-modsecurity-crs.tar.gz
&lt;span class=&#34;nv&#34;&gt;CRS_DIR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;find . -type d -name SpiderLabs-owasp-modsecurity-crs*&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
cat &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CRS_DIR&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/modsecurity_crs_10_setup.conf.example &amp;gt;&amp;gt; /etc/nginx/modsecurity.conf
cat &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CRS_DIR&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/base_rules/modsecurity_*.conf &amp;gt;&amp;gt; /etc/nginx/modsecurity.conf
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; f in &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;find &lt;span class=&#34;nv&#34;&gt;$CRS_DIR&lt;/span&gt; -type f -name *.data&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;FILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;basename &lt;span class=&#34;nv&#34;&gt;$f&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;CMD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;cp &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; /etc/nginx/&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$FILE&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CMD&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CMD&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
cp ModSecurity/unicode.mapping /etc/nginx/unicode.mapping

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===============================================================================&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Page Speed&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;----------&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Downlading the pagespeed version and building this&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$WORKING_DIRECTORY&lt;/span&gt;
wget https://github.com/pagespeed/ngx_pagespeed/archive/release-&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NPS_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;-beta.zip
unzip release-&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NPS_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;-beta.zip
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ngx_pagespeed-release-&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NPS_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;-beta/
wget https://dl.google.com/dl/page-speed/psol/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NPS_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;.tar.gz
tar -xzvf &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NPS_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;.tar.gz  &lt;span class=&#34;c1&#34;&gt;# extracts to psol/&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;NGINX_ADD_MODULES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NGINX_ADD_MODULES&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; --add-module=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$WORKING_DIRECTORY&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/ngx_pagespeed-release-&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NPS_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;-beta &amp;quot;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===============================================================================&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Nginx&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;-----&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;Finally, compiling Nginx with our extra modules and the added modules and installing it&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$WORKING_DIRECTORY&lt;/span&gt;
wget http://nginx.org/download/nginx-&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NGINX_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;.tar.gz
tar -xvzf nginx-&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NGINX_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;.tar.gz
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; nginx-&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;NGINX_VERSION&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/
./configure &lt;span class=&#34;nv&#34;&gt;$NGINX_ADD_MODULES&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$NGINX_EXTRA_MODULES&lt;/span&gt;
make
sudo make install

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===============================================================================&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;COMPLETED INSTALL - CHECKING&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;checking the nginx version now, should be &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$NGINX_VERSION&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; and you should see our modules&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
nginx -V

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;And now doing a config test&amp;quot;&lt;/span&gt;
/etc/init.d/nginx configtest


&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===============================================================================&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;SCRIPT COMPLETED&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;However, you are not there yet&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;You need to go and look at the /etc/nginx/modsecurity.conf file and change settings there as appropriate&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Also you need to modify your nginx vhost config - see:&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#Configuration_Steps&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>SELinux and connecting to Mysql databases on Red Hat based distributions</title>
      <link>https://edmondscommerce.github.io/linux/se-linux-and-connecting-to-a-mysql-database.html</link>
      <pubDate>Fri, 07 Nov 2014 10:53:06 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/linux/se-linux-and-connecting-to-a-mysql-database.html</guid>
      <description>&lt;p&gt;SELinux can be restrictive by defult but prevent alot of security issues. One thing we found while trying it is that by default it will block network connections from being made via the httpd daemon. This is an issue if say on a development system you are running php via the apache module.&lt;/p&gt;

&lt;p&gt;To resolve this simply login via root or sudo to root privilige and run the following command:
    setsebool -P httpd_can_network_connect on
You should now be able to connect to connect to your database. This will also enable things like web api, curl calls and other php that requires network access.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Nice Gnome Shell Theme - Elegance Colours</title>
      <link>https://edmondscommerce.github.io/linux/nice-gnome-shell-theme-elegance-colours.html</link>
      <pubDate>Thu, 02 Oct 2014 09:11:11 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/linux/nice-gnome-shell-theme-elegance-colours.html</guid>
      <description>

&lt;p&gt;One of the nice features of Gnome Shell is that, with the help of the &lt;a href=&#34;https://extensions.gnome.org/extension/19/user-themes/&#34; target=&#34;_blank&#34;&gt;User Theme&lt;/a&gt; extension, you can really customise
your desktop experience to be something personalised.&lt;/p&gt;

&lt;p&gt;For me, the first thing is to set my desktop background to be a nice picture - something with wide open spaces, mountains and lots of sky.&lt;/p&gt;

&lt;p&gt;The next thing though is to set up a user theme. I like transparency and themes that allow my well chosen background image to shine through.&lt;/p&gt;

&lt;p&gt;For this reason I chose the &lt;a href=&#34;https://github.com/satya164/elegance-colors&#34; target=&#34;_blank&#34;&gt;Elegance Colors&lt;/a&gt; theme as it has a &amp;ldquo;clear&amp;rdquo; preset which also includes functionality to set the colour scheme based
on the background image which is pretty slick I think.&lt;/p&gt;

&lt;p&gt;For installation instructions, please see the &lt;a href=&#34;https://github.com/satya164/elegance-colors/blob/master/README.md&#34; target=&#34;_blank&#34;&gt;README on Github&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;quick-fedora-instructions-are-here&#34;&gt;Quick Fedora instructions are here:&lt;/h2&gt;

&lt;h3 id=&#34;create-repo&#34;&gt;Create Repo&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;sudo sh -c &lt;span class=&#34;s2&#34;&gt;&amp;quot; echo &amp;#39;[home_satya164_elegance-colors]&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;name=Elegance Colors Gnome Shell theme (Fedora_20)&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;type=rpm-md&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;baseurl=http://download.opensuse.org/repositories/home:/satya164:/elegance-colors/Fedora_20/&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;gpgcheck=1&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;gpgkey=http://download.opensuse.org/repositories/home:/satya164:/elegance-colors/Fedora_20/repodata/repomd.xml.key&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;enabled=1&amp;#39; &amp;gt; /etc/yum.repos.d/elegance-colors.repo&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;install-theme&#34;&gt;Install Theme&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;sudo yum install gnome-shell-theme-elegance-colors
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;run-the-setup&#34;&gt;Run the Setup&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;elegance-colors
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;switch-to-the-theme&#34;&gt;Switch to the Theme&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;gsettings &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; org.gnome.shell.extensions.user-theme name &lt;span class=&#34;s1&#34;&gt;&amp;#39;elegance-colors&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&#34;now-run-the-gui-and-set-it-up&#34;&gt;Now run the GUI and set it up&lt;/h3&gt;

&lt;p&gt;For this you can hit simply search for &amp;lsquo;Elegance Colors&amp;rsquo; from the dash to load the GUI.&lt;/p&gt;

&lt;p&gt;In the GUI you have presets and if you want transparency just choose the clear one. After that of course you can customise as you see fit&lt;/p&gt;

&lt;h2 id=&#34;fonts&#34;&gt;Fonts&lt;/h2&gt;

&lt;p&gt;To make the most of Fedora, its well worth following &lt;a href=&#34;http://worldofgnome.org/how-to-greatly-improve-font-rendering-under-fedora-20/&#34; target=&#34;_blank&#34;&gt;these instructions&lt;/a&gt; to improve font rendering.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>URGENT update BASH - big security issue</title>
      <link>https://edmondscommerce.github.io/security/urgent-update-bash-big-security-issue.html</link>
      <pubDate>Thu, 25 Sep 2014 15:18:14 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/security/urgent-update-bash-big-security-issue.html</guid>
      <description>

&lt;p&gt;Shell Shock is a BASH exploit that can allow the running of arbitrary commands on Linux servers.&lt;/p&gt;

&lt;p&gt;This is a newly discovered bug and affects a very large number of servers.&lt;/p&gt;

&lt;p&gt;There is a patch, you should ensure that your server&amp;rsquo;s BASH version is updated ASAP.&lt;/p&gt;

&lt;h3 id=&#34;centos-redhat-etc&#34;&gt;Centos, Redhat etc&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;yum clean all; yum -y update bash
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;ubuntu-debian-etc&#34;&gt;Ubuntu, Debian etc&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;apt-get install --only-upgrade bash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To check if you are vulnerable, you can run this code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;env X=&amp;quot;() { :;} ; echo VULNERABLE&amp;quot; /bin/sh -c &amp;quot;echo completed&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you see VULNERABLE then you need to update BASH.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>