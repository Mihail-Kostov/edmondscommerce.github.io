<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Scripting on Edmonds Commerce Dev Blog</title>
    <link>https://edmondscommerce.github.io/tags/scripting/</link>
    <description>Recent content in Scripting on Edmonds Commerce Dev Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 30 Aug 2012 09:27:16 +0000</lastBuildDate>
    <atom:link href="https://edmondscommerce.github.io/tags/scripting/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Linux Bash Scripting: Force Screen if not Cron Task</title>
      <link>https://edmondscommerce.github.io/linux/linux-bash-scripting-force-screen-if-not-cron-task.html</link>
      <pubDate>Thu, 30 Aug 2012 09:27:16 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/linux/linux-bash-scripting-force-screen-if-not-cron-task.html</guid>
      <description>&lt;p&gt;If you have a long running script that is designed to run as cron but may be run manually from the terminal then you may want to enforce screen so that the process can&amp;rsquo;t be aborted by the SSH terminal being closed for whatever reason.&lt;/p&gt;

&lt;p&gt;We already blogged about how to &lt;a href=&#34;http://www.edmondscommerce.co.uk/linux/force-a-bash-script-to-run-in-screen/&#34; title=&#34;Linux Force Screen&#34;&gt;force running as screen here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This is an extension of this that also checks for running as Cron and if so, does not force screen.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# First off, ensure running from Cron and if not, Screen&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -t &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Not running as Cron Task&amp;quot;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -n &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$STY&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;We are inside screen, good&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Not in a screen, please run with screen&amp;quot;&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Exiting&amp;quot;&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; 1
    &lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Running as Cron Task&amp;quot;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Simply paste this somewhere close to the top of your script before it does anything and this will work nicely.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Javascript User Scripting for Android - OnX</title>
      <link>https://edmondscommerce.github.io/android/javascript-user-scripting-for-android-onx.html</link>
      <pubDate>Mon, 18 Jun 2012 13:34:58 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/android/javascript-user-scripting-for-android-onx.html</guid>
      <description>&lt;p&gt;Just came across this interesting site:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.onx.ms/#recipesPage&#34;&gt;https://www.onx.ms/#recipesPage&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It seems to be a very nice system for really customising your Android experience.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Debugging Programmatically Opened Terminals in Gnome</title>
      <link>https://edmondscommerce.github.io/linux/debugging-programmatically-opened-terminals-in-gnome.html</link>
      <pubDate>Wed, 30 Nov 2011 13:59:21 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/linux/debugging-programmatically-opened-terminals-in-gnome.html</guid>
      <description>&lt;p&gt;&lt;div class=&#34;oldpost&#34;&gt;&lt;h4&gt;This is post is now quite old and the the information it contains may be out of date or innacurate.&lt;/h4&gt;
&lt;p&gt;
If you find any errors or have any suggestions to update the information &lt;a href=&#34;http://edmondscommerce.github.io/contact-us/index.html&#34;&gt;please let us know&lt;/a&gt;
or &lt;a href=&#34;https://github.com/edmondscommerce/edmondscommerce.github.io&#34;&gt;create a pull request on GitHub&lt;/a&gt;
&lt;/p&gt;
&lt;/div&gt;
If you are building something that is opening a terminal, perhaps a fancy URL handler or something similar but there are errors causing the terminal to instantly close, then this is the solution for you.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s actually really simple!&lt;/p&gt;

&lt;p&gt;Create a new profile&lt;/p&gt;

&lt;p&gt;Select the &amp;ldquo;Title and Command&amp;rdquo; tab&lt;/p&gt;

&lt;p&gt;at the bottom there is an option &amp;ldquo;when command exits&amp;rdquo;&lt;/p&gt;

&lt;p&gt;You can switch this to &amp;ldquo;Hold Terminal Open&amp;rdquo; which will keep the terminal open so you can see the error message and then fix it&lt;/p&gt;

&lt;p&gt;You need to add the following flag to your gnome-terminal launcher:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
gnome_terminal --window-with-profile={profile_name}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Beautiful!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Building Bash function libraries</title>
      <link>https://edmondscommerce.github.io/programming/linux/ubuntu/building-bash-function-libraries.html</link>
      <pubDate>Fri, 27 May 2011 10:04:15 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/programming/linux/ubuntu/building-bash-function-libraries.html</guid>
      <description>&lt;p&gt;&lt;div class=&#34;oldpost&#34;&gt;&lt;h4&gt;This is post is now quite old and the the information it contains may be out of date or innacurate.&lt;/h4&gt;
&lt;p&gt;
If you find any errors or have any suggestions to update the information &lt;a href=&#34;http://edmondscommerce.github.io/contact-us/index.html&#34;&gt;please let us know&lt;/a&gt;
or &lt;a href=&#34;https://github.com/edmondscommerce/edmondscommerce.github.io&#34;&gt;create a pull request on GitHub&lt;/a&gt;
&lt;/p&gt;
&lt;/div&gt;
Bash provides many powerful functions but how can you use these easily?&lt;/p&gt;

&lt;p&gt;If you spend any time using the command line, either to manage a server or on the desktop, you have to quickly become proficient with bash. You will also find the you carry out many of the same tasks time after time.&lt;/p&gt;

&lt;p&gt;This can quickly become tiresome and error prone, particularly if you are piping several commands together. However, bash provides several ways to make your life easier.&lt;/p&gt;

&lt;h3&gt;Aliases&lt;/h3&gt;

&lt;p&gt;If you are always going to be using the same flags with a command, you can ensure that they are called by default by using an alias.&lt;/p&gt;

&lt;p&gt;An alias is a shorthand that bash uses in order to fire commands. Several are included as standard with Ubuntu (and other distros) and are stored in your .bashrc file. You can edit these and add your own as the need occurs.&lt;/p&gt;

&lt;p&gt;An example of this is that I prefer the human readable file sizes when using ls. You can turn these on using the -h flag, but you have to include this every time you run the command. To make things easier I changed the alias for ll (long list) to read as follows&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
alias ll=&amp;quot;ls -ahlF&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This way I don&amp;rsquo;t need to remember to put the flag in.&lt;/p&gt;

&lt;p&gt;As you build up more of these commands, it makes sense to store them in a separate file so you can easily find and edit them. You can place all of you aliases in a file called .bash_aliases and they will be available for use.&lt;/p&gt;

&lt;h3&gt;Scripts&lt;/h3&gt;

&lt;p&gt;Aliases are fine for quickly calling simple commands, but many times you will need to carry out more complex tasks. In order to do this, you can make a script, and then call that.&lt;/p&gt;

&lt;p&gt;By placing everything into a script, you benefit from being able to carry out more complicated functions, and the easy of calling it from a single command.&lt;/p&gt;

&lt;p&gt;An example of this would be if you wanted to compare two branches in git, and see all of the files that had been created or modified, but not the files that had been deleted. You create a file called git_get_changed_files and put the following in&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#!/bin/bash
local ORIGINAL CHANGED FILES 
ORIGINAL=&amp;quot;$1&amp;quot;
CHANGED=&amp;quot;$2&amp;quot;

    FILES=$(git diff --name-status $ORIGINAL..$CHANGED public/ | awk &#39;{print $1&amp;quot;@@@@@&amp;quot;$2}&#39;)
    for FILE in $FILES
    do
            echo &amp;quot;$FILE&amp;quot; | awk -F &amp;quot;@@@@@&amp;quot; &#39;{ i=&amp;quot;&amp;quot;; if ($1 != &amp;quot;D&amp;quot;) print $2}&#39;
    done

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you place this in your home/bin folder you will then be able to run  git_get_changed_files like a normal command.&lt;/p&gt;

&lt;h3&gt;A Global Function Library&lt;/h3&gt;

&lt;p&gt;You can expand on this by creating a global library of functions. This works by putting all of the functions into a folder, where each file is a namespace for different functions.&lt;/p&gt;

&lt;p&gt;This can be achieved by creating a script that will source of all of the files in a folder, like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#!/bin/bash
for f in $(ls /path/to/folder/); 
    do source /path/to/folder/$f; 
done

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Call this script func and place it in your home/bin folder. Then you put a script in the folder referenced in the file and use the following structure.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
function parse.(){ # auto complete helper, second argument is a grep against the function list     
    if [[ &#39;&#39; == &amp;quot;$@&amp;quot; ]]
    then
        echo &amp;quot;Parse Namespaced Functions List&amp;quot;
        cat $BASH_SOURCE | grep &amp;quot;^function[^(]&amp;quot; | awk &#39;{j=&amp;quot; USAGE:&amp;quot;; for (i=5; i&amp;lt;=NF; i++) j=j&amp;quot; &amp;quot;$i; print $2&amp;quot; &amp;quot;j}&#39;
    else
        echo &amp;quot;Parse Functions Matching: $@&amp;quot;
        cat $BASH_SOURCE | grep &amp;quot;^function[^(]&amp;quot; | awk &#39;{j=&amp;quot; USAGE:&amp;quot;; for (i=5; i&amp;lt;=NF; i++) j=j&amp;quot; &amp;quot;$i; print $2&amp;quot; &amp;quot;j}&#39; | grep $@
    fi
}

function parse.access_log_top_ten_code() { # Show the top ten code from access_log: useage ...code $FILE $CODE
	FILE=$1
	CODE=$2
	echo &amp;quot;Count the top ten $CODE&#39;d pages&amp;quot;

	cat $FILE | awk &#39;{ i=($9==&amp;quot;$CODE&amp;quot; ) ? $7 : &amp;quot;&amp;quot;; print i; }&#39; | sort | uniq -c | sort -n | tail -n 11 | head -n 10
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In this folder a namespace of parse is created. Running&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
func parse. 

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Will list all of the function in the file. Running func parse. log will list all of the function that contain log in the function name or description. When the files are listed, the function name will be displayed with the comment along side it.&lt;/p&gt;

&lt;p&gt;As the func command sources all of the different files, you are able to makes use of the functions across different namespaces. This means that you can create a file that will format output and then use that in with your git functions.&lt;/p&gt;

&lt;p&gt;I hope that you are able to make use of this idea, and build your own library of functions. Anything that you thing would be useful to add to the library, please mention below.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>