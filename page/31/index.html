<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Edmonds Commerce Dev Blog</title>
  <meta name="author" content="EdmondsCommerce Development Team">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://edmondscommerce.github.io/page/31">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Edmonds Commerce Dev Blog" type="application/atom+xml">

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27853727-2', 'edmondscommerce.github.io');
  ga('send', 'pageview');

</script>

</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img height="20" src="https://2.gravatar.com/avatar/04b807394911b26ea8a79dbe25ea4e1a?d=https%3A%2F%2Fidenticons.github.com%2Fccb745f4b144d30c4b883330a1114834.png&amp;r=x&amp;s=140" width="20"> Dev Blog</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
                
                <li ><a href="/categories/index.html">Categories</a></li>
                
                <li ><a href="/contact-us/index.html">Contact</a></li>
                
            </ul>
            <ul class="nav pull-right">
                
                
                <li><a href="http://linkedin.com/in/edmondscommerce" title="Linkedin Profile"><i class="icon-linkedin-sign social-navbar"></i></a></li>
                
                
                
                <li><a href="http://plus.google.com/104488822194646220248" title="Google+ Profile"><i class="icon-google-plus-sign social-navbar"></i></a></li>
                
                
                
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="http://google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:edmondscommerce.github.io">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index">
      
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-30T13:59:21+00:00" pubdate data-updated="true">Nov 30<span>th</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/linux/debugging-programmatically-opened-terminals-in-gnome.html">Debugging Programmatically Opened Terminals in Gnome</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>If you are building something that is opening a terminal, perhaps a fancy URL handler or something similar but there are errors causing the terminal to instantly close, then this is the solution for you.</p>

<p>It&rsquo;s actually really simple!</p>

<p>Create a new profile</p>

<p>Select the &ldquo;Title and Command&rdquo; tab</p>

<p>at the bottom there is an option &ldquo;when command exits&rdquo;</p>

<p>You can switch this to &ldquo;Hold Terminal Open&rdquo; which will keep the terminal open so you can see the error message and then fix it</p>

<p>You need to add the following flag to your gnome-terminal launcher:</p>

<figure class='code panel panel-default'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>gnome_terminal --window-with-profile={profile_name}
</span></code></pre></td></tr></table></div></figure>


<p>Beautiful!</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-18T18:42:27+00:00" pubdate data-updated="true">Nov 18<span>th</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/magento/magento-merged-css-clear-not-working-solution.html">Magento Merged CSS Clear Not Working + Solution</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>If you are having an issue with Magento and the optional Merge CSS Files (beta) turned on and it not updating with recent CSS changes, you may appreciate this.</p>

<p>Unlike other cached elements that are stored in var/cache, Magento stores the cached and minified CSS files in media/css</p>

<p>If you simply delete the contents of this folder, your CSS changes should kick in as Magento is forced to rebuild these files.</p>

<p>There is an option in cache management to flush CSS storage but for some reason this wasn&rsquo;t working for me. Could be a permissions issue or something else I am not sure, we simply needed to get this change implemented (emergency live site fix) so flushing this folder manually did the trick.</p>

<p>Hope it helps someone else looking for Magento merged CSS clear not working, Magento CSS cache, Magento CSS Files beta</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-18T15:05:20+00:00" pubdate data-updated="true">Nov 18<span>th</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/linux/keep-ssh-alive.html">Keep Ssh Alive</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>Due to our load-balancing router being a little &ldquo;harsh&rdquo; on closing connections that appear to be unused, ssh often sits and hangs.</p>

<p>Using a standard ssh config option though we can set a server keep-alive (on the ssh client, which also keeps sshfs alive)</p>

<p>In the &ldquo;~/.ssh/config&rdquo; file, simply adding the following keeps the connection sending a small packet every 30 seconds :&ndash;
<code>ServerAliveInterval=30</code></p>

<p>I&rsquo;m sure windows clients like puTTY also have a similar option, and on a mac, it should be the same file as Linux.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-14T17:31:00+00:00" pubdate data-updated="true">Nov 14<span>th</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/git/quickly-make-a-deploy-folder-from-git.html">Quickly Make a Deploy Folder From Git</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>I needed to quickly generate a deploy folder that included all changes in the last two weeks. Using git and a little bit of bash magic I was able to put together a one liner to do this.</p>

<p>This works we use a public folder within our git structure which makes filtering the files easy, if you don&rsquo;t have this then you will have to change the grep filter to match your needs. Obviously you can change the since filter to get the files you need.</p>

<p><code>git log &mdash;since=&ldquo;2 weeks ago&rdquo; &mdash;name-status | grep public | sort | uniq | awk &lsquo;{print $2}&rsquo; | xargs -I % cp &mdash;parents % /path/to/deploy</code></p>

<p>Hope this helps in the future</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-14T12:48:00+00:00" pubdate data-updated="true">Nov 14<span>th</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/magento/magento-admin-backend-slow-quick-speed-tip.html">Magento Admin Backend Slow (Quick Speed Tip)</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>One of the things that can catch you out if you have a paranoid server admin is that various magento extensions will contact external servers (such as SagePay or Mailchimp).</p>

<p>If the server admin has blocked outbound web traffic (to avoid DDoS attacks and other malicious traffic), these extensions will slow you down at every step.</p>

<p>Simple answer, if you&rsquo;re running magento, ensure you have outbound traffic enabled.  Also, don&rsquo;t assume that just because you can use lynx, apt-get et al at the command prompt that you can as the web server user.  IPTables and pf both have checks for outbound user, so be sure to test as www-user or apache.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-10T18:30:05+00:00" pubdate data-updated="true">Nov 10<span>th</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/mysql/mysql_dump-not-restored-correctly-1064-using-btree-fix.html">Mysql_dump Not Restored Correctly 1064: USING BTREE + Fix</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>When migrating one server to another you often hit bumps in the road.  Todays was transferring a database from one server to another.</p>

<p>During this standard procedure I found that the restored database was missing a few tables.  Irritating as Magento doesn&rsquo;t like missing tables.</p>

<p>Digging down into the backup and extracting the first missing table I was able to replicate the error which came out as
<code>1064 &ndash; You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &lsquo;USING BTREE</code></p>

<p>I eventually found out that some versions of mysql 5.1 export a dump file that contains mysql5.1 specific features and loading the file into mysql 5.0 will not work.</p>

<p>The solution is a little frustrating but if you run the command with the &mdash;compatible=mysql40 switch, the dump file extracts fine :&ndash;
<code>mysqldump &mdash;compatible=mysql40</code>
Don&rsquo;t ask me why there&rsquo;s no &mdash;compatible=mysql50 flag.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-10T18:15:47+00:00" pubdate data-updated="true">Nov 10<span>th</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/email/save-space-with-the-new-gmail-look.html">Save Space With the New Gmail Look!</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>The new gmail look certainly makes it look the same as many of Google&rsquo;s other services, but it&rsquo;s quite space in efficient by default. Fortunately Google thought of that and made it&rsquo;s space efficiency configurable! There is a button in the top right of gmail that allows you to change it.
<img src="/assets/gmail.png"></p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-11-02T15:22:00+00:00" pubdate data-updated="true">Nov 2<span>nd</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/web%20design/the-end-of-an-era-internet-explorer-drops-below-50-percent-of-web-usage.html">The End of an Era: Internet Explorer Drops Below 50 Percent of Web Usage</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p><a href="http://www.webmonkey.com/2011/11/the-end-of-an-era-internet-explorer-drops-below-50-percent-of-web-usage/">http://www.webmonkey.com/2011/11/the-end-of-an-era-internet-explorer-drops-below-50-percent-of-web-usage/</a> </p>


<p>Anyone who had had to either do an extra 50% of work to get IE working, or had to pay someone else to do so. I&#8217;m sure you are thinking what we think. Yes!</p>

</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-10-31T21:34:07+00:00" pubdate data-updated="true">Oct 31<span>st</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/php/php-swift-mailer-not-working-with-google-apps.html">PHP Swift Mailer Not Working With Google Apps</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>If you are struggling trying to get PHPMailer working with Google Apps then perhaps this is the solution for you.</p>

<p>I went to the PHPMailer site and found my way to a SourceForge download. After a lot of debugging and wrestling with this I just could not get it to work. In the end I looked at other projects that I knew were using PHPMailer for their mail and that were working with Google Apps or Gmail and found that their version was drastically more up to date than the one I downloaded from SourceForge.</p>

<p>In a nutshell &ndash; the version I had was never going to work.</p>

<p>A quick update later and I have PHPMailer working with Google Apps.</p>

<p>For reference the version <a href="https://github.com/KyleAMathews/phpmailer/blob/master/class.phpmailer.php">here</a> seems to be the up to date.</p>

<p>Here is some example code that IS working with Google Apps</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'>    <span class="nv">$to</span> <span class="o">=</span> <span class="s1">&#39;info@edmondscommerce.co.uk&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$message</span> <span class="o">=</span> <span class="s1">&#39;testing swift mailer&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">require</span><span class="p">(</span><span class="s2">&quot;class.phpmailer.php&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$mail</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PHPMailer</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">IsSMTP</span><span class="p">();</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">SMTPAuth</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">SMTPSecure</span> <span class="o">=</span> <span class="s1">&#39;tls&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Host</span> <span class="o">=</span> <span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Port</span> <span class="o">=</span> <span class="mi">587</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Username</span> <span class="o">=</span> <span class="s1">&#39;your@email.com&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Password</span> <span class="o">=</span> <span class="s1">&#39;yourpasswordwhatever&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">From</span> <span class="o">=</span> <span class="nv">$to</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">FromName</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Subject</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">WordWrap</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="c1">// set word wrap</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Body</span> <span class="o">=</span> <span class="nb">eregi_replace</span><span class="p">(</span><span class="s2">&quot;[\]&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$message</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">IsHTML</span><span class="p">(</span><span class="k">true</span><span class="p">);</span> <span class="c1">// send as HTML</span>
</span><span class='line'><span class="c1">//To</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">AddAddress</span><span class="p">(</span><span class="nv">$to</span><span class="p">);</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">SMTPDebug</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">CharSet</span> <span class="o">=</span> <span class="s1">&#39;us-ascii&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Encoding</span> <span class="o">=</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Charset</span> <span class="o">!=</span> <span class="s1">&#39;us-ascii&#39;</span> <span class="o">?</span> <span class="s1">&#39;8bit&#39;</span> <span class="o">:</span> <span class="s1">&#39;7bit&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">Send</span><span class="p">())</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">echo</span> <span class="s2">&quot;Message could not be sent. &lt;p&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="s2">&quot;Mailer Error: &quot;</span> <span class="o">.</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">ErrorInfo</span><span class="p">;</span>
</span><span class='line'>        <span class="k">exit</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">echo</span> <span class="s2">&quot;Message has been sent&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-10-31T17:32:23+00:00" pubdate data-updated="true">Oct 31<span>st</span>, 2011</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/magento/magento-create-admin-user-script.html">Magento Create Admin User Script</a></h1>
    
  </header>


  <div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>Often we will be asked to work on a site and have to test backend features but without asking for admin passwords, so we need a way to create admin users without admin access.  Of course we already have file and database access.</p>

<p>For this, we use phpmyadmin or adminer to give us database access and run the following php script at the commandline :&ndash;</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'><span class="k">function</span> <span class="nf">Readln</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s1">&#39;php://stdin&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nb">fgets</span><span class="p">(</span><span class="nv">$handle</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Enter username [or hit enter for &quot;someadminuser&quot;]: &#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$username</span> <span class="o">=</span> <span class="nx">Readln</span><span class="p">();</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="s2">&quot;&quot;</span> <span class="o">==</span> <span class="nv">$username</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nv">$username</span> <span class="o">=</span> <span class="s1">&#39;someadminuser&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Enter password [or hit enter for the usual one]: &#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$password</span> <span class="o">=</span> <span class="nx">Readln</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Enter table prefix [or hit enter for none]: &#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$prefix</span> <span class="o">=</span> <span class="nx">Readln</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$salt</span> <span class="o">=</span> <span class="s1">&#39;EC&#39;</span><span class="p">;</span>
</span><span class='line'><span class="k">echo</span> <span class="s2">&quot;Salted is : &quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$password</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">echo</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$salt</span><span class="o">.</span><span class="nv">$password</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="nv">$salt</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">echo</span> <span class="nv">$hash</span> <span class="o">=</span> <span class="s1">&#39;20f808df3d6e913ec43164ad2e7be85e:EC&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">echo</span> <span class="s2">&quot;SQL for insert : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">echo</span> <span class="o">&lt;&lt;&lt;</span> <span class="nx">EOT</span>
</span><span class='line'><span class="nx">insert</span> <span class="nx">into</span> <span class="err">$</span><span class="p">{</span><span class="nx">prefix</span><span class="p">}</span><span class="nx">admin_user</span>
</span><span class='line'><span class="nx">select</span>
</span><span class='line'><span class="p">(</span><span class="nx">select</span> <span class="nx">max</span><span class="p">(</span><span class="nx">user_id</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="nx">from</span> <span class="err">$</span><span class="p">{</span><span class="nx">prefix</span><span class="p">}</span><span class="nx">admin_user</span><span class="p">)</span> <span class="nx">user_id</span><span class="p">,</span>
</span><span class='line'><span class="s1">&#39;Edmonds&#39;</span> <span class="nx">first_name</span><span class="p">,</span>
</span><span class='line'><span class="s1">&#39;Commerce&#39;</span> <span class="nx">last_name</span><span class="p">,</span>
</span><span class='line'><span class="s1">&#39;nojunkplease@mailinator.com&#39;</span> <span class="nx">email</span><span class="p">,</span>
</span><span class='line'><span class="s1">&#39;$username&#39;</span> <span class="nx">username</span><span class="p">,</span>
</span><span class='line'><span class="s1">&#39;$hash&#39;</span> <span class="nx">password</span><span class="p">,</span>
</span><span class='line'><span class="nx">now</span><span class="p">()</span> <span class="nx">created</span><span class="p">,</span>
</span><span class='line'><span class="k">NULL</span> <span class="nx">modified</span><span class="p">,</span>
</span><span class='line'><span class="k">NULL</span> <span class="nx">logdate</span><span class="p">,</span>
</span><span class='line'><span class="mi">0</span> <span class="nx">lognum</span><span class="p">,</span>
</span><span class='line'><span class="mi">0</span> <span class="nx">reload_acl_flag</span><span class="p">,</span>
</span><span class='line'><span class="mi">1</span> <span class="nx">is_active</span><span class="p">,</span>
</span><span class='line'><span class="p">(</span><span class="nx">select</span> <span class="nx">max</span><span class="p">(</span><span class="nx">extra</span><span class="p">)</span> <span class="nx">from</span> <span class="err">$</span><span class="p">{</span><span class="nx">prefix</span><span class="p">}</span><span class="nx">admin_user</span> <span class="nx">where</span> <span class="nx">extra</span> <span class="nx">is</span> <span class="k">not</span> <span class="k">null</span><span class="p">)</span> <span class="nx">extra</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">insert</span> <span class="nx">into</span> <span class="err">$</span><span class="p">{</span><span class="nx">prefix</span><span class="p">}</span><span class="nx">admin_role</span>
</span><span class='line'><span class="nx">select</span>
</span><span class='line'><span class="p">(</span><span class="nx">select</span> <span class="nx">max</span><span class="p">(</span><span class="nx">role_id</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="nx">from</span> <span class="err">$</span><span class="p">{</span><span class="nx">prefix</span><span class="p">}</span><span class="nx">admin_role</span><span class="p">)</span> <span class="nx">role_id</span><span class="p">,</span>
</span><span class='line'><span class="p">(</span><span class="nx">select</span> <span class="nx">role_id</span> <span class="nx">from</span> <span class="err">$</span><span class="p">{</span><span class="nx">prefix</span><span class="p">}</span><span class="nx">admin_role</span> <span class="nx">where</span> <span class="nx">role_name</span> <span class="o">=</span> <span class="s1">&#39;Administrators&#39;</span><span class="p">)</span> <span class="nx">parent_id</span><span class="p">,</span>
</span><span class='line'><span class="mi">2</span> <span class="nx">tree_level</span><span class="p">,</span>
</span><span class='line'><span class="mi">0</span> <span class="nx">sort_order</span><span class="p">,</span>
</span><span class='line'><span class="s1">&#39;U&#39;</span> <span class="nx">role_type</span><span class="p">,</span>
</span><span class='line'><span class="p">(</span><span class="nx">select</span> <span class="nx">user_id</span> <span class="nx">from</span> <span class="err">$</span><span class="p">{</span><span class="nx">prefix</span><span class="p">}</span><span class="nx">admin_user</span> <span class="nx">where</span> <span class="nx">username</span> <span class="o">=</span> <span class="s1">&#39;$username&#39;</span><span class="p">)</span> <span class="nx">user_id</span><span class="p">,</span>
</span><span class='line'><span class="s1">&#39;$username&#39;</span> <span class="nx">role_name</span>
</span><span class='line'><span class="nx">\n</span>
</span><span class='line'><span class="nx">\n</span>
</span><span class='line'><span class="nx">EOT</span><span class="p">;</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>The output looks like this :&ndash;
<code>Enter username [or hit enter for &ldquo;someadminuser&rdquo;]:
Enter password [or hit enter for the usual one]:
Enter table prefix [or hit enter for none]:</p>

<p>Salted is : 20f808df3d6e913ec43164ad2e7be85e:EC</p>

<p>SQL for insert :
insert into admin_user
select
(select max(user_id) + 1 from admin_user) user_id,
&lsquo;Edmonds&rsquo; first_name,
&lsquo;Commerce&rsquo; last_name,
&lsquo;<a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#111;&#x3a;&#110;&#111;&#106;&#x75;&#110;&#x6b;&#112;&#108;&#101;&#x61;&#115;&#101;&#64;&#109;&#x61;&#105;&#x6c;&#x69;&#x6e;&#x61;&#x74;&#x6f;&#114;&#x2e;&#99;&#111;&#109;">&#x6e;&#x6f;&#106;&#117;&#x6e;&#107;&#x70;&#108;&#101;&#97;&#115;&#x65;&#64;&#x6d;&#x61;&#105;&#108;&#x69;&#110;&#97;&#116;&#x6f;&#x72;&#x2e;&#99;&#111;&#x6d;</a>&rsquo; email,
&lsquo;someadminuser&rsquo; username,
&lsquo;20f808df3d6e913ec43164ad2e7be85e:EC&rsquo; password,
now() created,
NULL modified,
NULL logdate,
0 lognum,
0 reload_acl_flag,
1 is_active,
(select max(extra) from admin_user where extra is not null) extra;</p>

<p>insert into admin_role
select
(select max(role_id) + 1 from admin_role) role_id,
(select role_id from admin_role where role_name = &lsquo;Administrators&rsquo;) parent_id,
2 tree_level,
0 sort_order,
&lsquo;U&rsquo; role_type,
(select user_id from admin_user where username = &lsquo;someadminuser&rsquo;) user_id,
&lsquo;someadminuser&rsquo; role_name</code></p>

<p>Which we can then copy and paste into the database admin.  No prizes for guessing the first programming language of the dev who wrote the script.</p>
</div>
  
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous"><a href="/page/32/">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
        <li class="next"><a href="/page/30/">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/Fedora/getting-skype-working-on-fedora-20.html">Getting Skype Working on Fedora 20</a>
    
    <a class="list-group-item " href="/bash/bash-find-files-and-echo-filename-and-contents.html">Bash Find Files and Echo Filename and Contents</a>
    
    <a class="list-group-item " href="/Fedora/upgrading-from-fedora-19-to-20-using-fedup.html">Upgrading From Fedora 19 to 20 Using FedUp</a>
    
    <a class="list-group-item " href="/Fedora/fedora-yum-update-failing-rpmfusion-plus-solution.html">Fedora Yum Update Failing - RPMFusion + Solution</a>
    
    <a class="list-group-item " href="/octopress/code-blocks-with-liquid-or-twig-tags-using-octopress.html">Code Blocks With Liquid or Twig Tags Using Octopress</a>
    
  </div>
</section>




<section class="googleplus panel panel-default">
  <div class="panel-body">
    <h3>
      <a href="https://plus.google.com/104488822194646220248?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h3>
  </div>
</section>


<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">About Us</h3>
    </div>
    <div class="panel-body">
        <p>
            <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
            agency.
        </p>

        <p>
            We are based in <a href="http://www.yorkshire.com/">Yorkshire</a> near <a
                href="http://www.visitleeds.co.uk/">Leeds</a> and <a href="http://www.visitbradford.com/">Bradford</a>.
        </p>

        <p>
            Our primary specialism is <a href="http://magento.com/">Magento</a> and other PHP based E-Commerce platforms
            such as <a href="http://www.opencart.com/">OpenCart</a>.
        </p>

        <p>
            In terms of technology we are very strong in:
        <ul>
            <li><a href="http://php.net/">PHP</a>,</li>
            <li><a href="http://www.mysql.com/">MySQL</a>,</li>
            <li><a href="http://www.linuxfoundation.org/">Linux</a>,</li>
            <li><a href="http://www.w3.org/standards/techs/html#w3c_all">HTML<a/>,</li>
            <li><a href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a></li>
            <li><a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.</li>
        </ul>
        </p>
    </div>
</section>

<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Commercial Enquiries</h3>
    </div>
    <div class="panel-body">
        <p>
            If you would like to discuss your project requirements then please get in touch today.
        </p>

        <p>
            <a href="http://www.edmondscommerce.co.uk">www.edmondscommerce.co.uk</a><br/><br/>
            <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br/><br/>
            <a href="tel:00441274590036">+44 1274 590036</a>
        </p>
    </div>
</section>

      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2014 - EdmondsCommerce Development Team<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>






  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </body>
</html>
