<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>PHP MySQL Dump Script &middot; </title>

  
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/poole.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/highlight/github.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link href="https://edmondscommerce.github.io/favicon.ico" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'google analytics', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
        <a href="/"><img src="/images/eclogo.png"
             alt="gravatar" title="">
        </a>
      
      <h1></h1>
      
    </div>
    <p>
      <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
      agency. We are based in <a href="http://www.yorkshire.com/">Yorkshire</a> near <a href="http://www.visitleeds.co.uk/">Leeds</a> and <a href="http://www.visitbradford.com/">Bradford</a>.
    </p>

    <p>
      Our primary specialism is <a href="http://magento.com/">Magento</a> and other PHP based E-Commerce platforms
      such as <a href="http://www.opencart.com/">OpenCart</a>.
    </p>

    <p>
      In terms of technology we are very strong in <a href="http://php.net/">PHP</a>, <a href="http://www.mysql.com/">MySQL</a>, <a href="http://www.linuxfoundation.org/">Linux</a>,
      <a href="http://www.w3.org/standards/techs/html#w3c_all">HTML</a><a>, <a href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a> and <a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.</li>
  </ul>


    <ul class="sidebar-nav">
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/edmondscommerce"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      <a href="https://www.linkedin.com/company/edmonds-commerce"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/104488822194646220248?rel=author"><i class="fa fa-google-plus-square fa-3x"></i></a>
      
      <a href="https://twitter.com/edmondscommerce"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="https://edmondscommerce.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
      <p>
        <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br>
        <a href="tel:00441138805654">0044 113 880 5654</a>
      </p>
    </ul>

    

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">PHP MySQL Dump Script</h1>
    <span class="post-date">Jan 19, 2009 &middot; 5 minute read
    
    <br/>
      <strong>Category: </strong>
    <a class="label" href="https://edmondscommerce.github.io/categories/mysql">mysql</a><a class="label" href="https://edmondscommerce.github.io/categories/php">php</a>
    </span>
    <p><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>
Don&rsquo;t get me wrong, I love phpMyAdmin and use it every day. However sometimes on client servers the only access to the database is via phpMyAdmin and it hasn&rsquo;t been set up properly. One really irritating example is when trying to dump a database so that it can be installed on my local development server. Do the export etc etc and then phpMyAdmin gives you the download, but no - its an empty file&hellip;</p>

<p>After messing around for 10 minutes you realise that no matter what you do, you aint getting your DB dump this way.</p>

<p>In steps <a href="http://www.mt-soft.com.ar/wordpress/wp-content/uploads/2007/07/mysqldump.zip" rel="nofollow">this script</a>, as mentioned <a href="http://www.mt-soft.com.ar/2007/12/21/php-script-mysqldump/" rel="nofollow">here</a>.</p>

<p>Just in case that link dies - here is the body of the script - with all credit and thanks to the original author:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span></span><span class="cp">&lt;?php</span>

<span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="cm">/*---------------------------------------------------+</span>

<span class="cm">| mysqldump.php</span>

<span class="cm">+----------------------------------------------------+</span>

<span class="cm">| Copyright 2006 Huang Kai</span>

<span class="cm">| hkai@atutility.com</span>

<span class="cm">| http://atutility.com/</span>

<span class="cm">+----------------------------------------------------+</span>

<span class="cm">| Released under the terms &amp; conditions of v2 of the</span>

<span class="cm">| GNU General Public License. For details refer to</span>

<span class="cm">| the included gpl.txt file or visit http://gnu.org</span>

<span class="cm">+----------------------------------------------------*/</span>

<span class="cm">/*</span>

<span class="cm">change log:</span>

<span class="cm">2006-10-16 Huang Kai</span>

<span class="cm">---------------------------------</span>

<span class="cm">initial release</span>



<span class="cm">2006-10-18 Huang Kai</span>

<span class="cm">---------------------------------</span>

<span class="cm">fixed bugs with delimiter</span>

<span class="cm">add paramter header to add field name as CSV file header.</span>



<span class="cm">2006-11-11 Huang Kia</span>

<span class="cm">Tested with IE and fixed the &lt;button&gt; to &lt;input&gt;</span>

<span class="cm">*/</span>

<span class="nv">$mysqldump_version</span><span class="o">=</span><span class="s2">&quot;1.02&quot;</span><span class="p">;</span>



<span class="nv">$print_form</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="nv">$output_messages</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>





<span class="c1">//test mysql connection</span>

<span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span> <span class="p">)</span>

<span class="p">{</span>

	<span class="nv">$mysql_host</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_host&#39;</span><span class="p">];</span>

	<span class="nv">$mysql_database</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_database&#39;</span><span class="p">];</span>

	<span class="nv">$mysql_username</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_username&#39;</span><span class="p">];</span>

	<span class="nv">$mysql_password</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_password&#39;</span><span class="p">];</span>



	<span class="k">if</span><span class="p">(</span> <span class="s1">&#39;Test Connection&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span>

	<span class="p">{</span>

		<span class="nx">_mysql_test</span><span class="p">(</span><span class="nv">$mysql_host</span><span class="p">,</span><span class="nv">$mysql_database</span><span class="p">,</span> <span class="nv">$mysql_username</span><span class="p">,</span> <span class="nv">$mysql_password</span><span class="p">);</span>

	<span class="p">}</span>

	<span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="s1">&#39;Export&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span>

	<span class="p">{</span>

		<span class="nx">_mysql_test</span><span class="p">(</span><span class="nv">$mysql_host</span><span class="p">,</span><span class="nv">$mysql_database</span><span class="p">,</span> <span class="nv">$mysql_username</span><span class="p">,</span> <span class="nv">$mysql_password</span><span class="p">);</span>

		<span class="k">if</span><span class="p">(</span> <span class="s1">&#39;SQL&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">]</span> <span class="p">)</span>

		<span class="p">{</span>

			<span class="nv">$print_form</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>



			<span class="c1">//ob_start(&quot;ob_gzhandler&quot;);</span>

			<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-type: text/plain&#39;</span><span class="p">);</span>

			<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span><span class="o">.</span><span class="nv">$mysql_host</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$mysql_database</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;YmdHis&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;.sql&quot;&#39;</span><span class="p">);</span>

			<span class="k">echo</span> <span class="s2">&quot;/*mysqldump.php version </span><span class="si">$mysqldump_version</span><span class="s2"> */</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

			<span class="nx">_mysqldump</span><span class="p">(</span><span class="nv">$mysql_database</span><span class="p">);</span>



			<span class="c1">//header(&quot;Content-Length: &quot;.ob_get_length());</span>



			<span class="c1">//ob_end_flush();</span>

		<span class="p">}</span>

		<span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="s1">&#39;CSV&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_table&#39;</span><span class="p">]))</span>

		<span class="p">{</span>

			<span class="nv">$print_form</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>



			<span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">);</span>



			<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-type: text/comma-separated-values&#39;</span><span class="p">);</span>

			<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span><span class="o">.</span><span class="nv">$mysql_host</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$mysql_database</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$mysql_table</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;YmdHis&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;.csv&quot;&#39;</span><span class="p">);</span>

			<span class="c1">//header(&#39;Content-type: text/plain&#39;);</span>

			<span class="nx">_mysqldump_csv</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_table&#39;</span><span class="p">]);</span>

			<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Length: &quot;</span><span class="o">.</span><span class="nb">ob_get_length</span><span class="p">());</span>

			<span class="nb">ob_end_flush</span><span class="p">();</span>

		<span class="p">}</span>

	<span class="p">}</span>



<span class="p">}</span>



<span class="k">function</span> <span class="nf">_mysqldump_csv</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span>

<span class="p">{</span>

	<span class="nv">$delimiter</span><span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">;</span>

	<span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;csv_delimiter&#39;</span><span class="p">]))</span>

		<span class="nv">$delimiter</span><span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;csv_delimiter&#39;</span><span class="p">];</span>



	<span class="k">if</span><span class="p">(</span> <span class="s1">&#39;Tab&#39;</span> <span class="o">==</span> <span class="nv">$delimiter</span><span class="p">)</span>

		<span class="nv">$delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">;</span>





	<span class="nv">$sql</span><span class="o">=</span><span class="s2">&quot;select * from `</span><span class="si">$table</span><span class="s2">`;&quot;</span><span class="p">;</span>

	<span class="nv">$result</span><span class="o">=</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span> <span class="nv">$result</span><span class="p">)</span>

	<span class="p">{</span>

		<span class="nv">$num_rows</span><span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>

		<span class="nv">$num_fields</span><span class="o">=</span> <span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>



		<span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

		<span class="k">while</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num_fields</span><span class="p">)</span>

		<span class="p">{</span>

			<span class="nv">$meta</span><span class="o">=</span> <span class="nb">mysql_fetch_field</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span>

			<span class="k">echo</span><span class="p">(</span><span class="nv">$meta</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">);</span>

			<span class="k">if</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num_fields</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

				<span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$delimiter</span><span class="s2">&quot;</span><span class="p">;</span>

			<span class="nv">$i</span><span class="o">++</span><span class="p">;</span>

		<span class="p">}</span>

		<span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>



		<span class="k">if</span><span class="p">(</span> <span class="nv">$num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

		<span class="p">{</span>

			<span class="k">while</span><span class="p">(</span> <span class="nv">$row</span><span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span>

			<span class="p">{</span>

				<span class="k">for</span><span class="p">(</span> <span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num_fields</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span>

				<span class="p">{</span>

					<span class="k">echo</span> <span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>

					<span class="k">if</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num_fields</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

							<span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$delimiter</span><span class="s2">&quot;</span><span class="p">;</span>

				<span class="p">}</span>

				<span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

			<span class="p">}</span>



		<span class="p">}</span>

	<span class="p">}</span>

	<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>



<span class="p">}</span>





<span class="k">function</span> <span class="nf">_mysqldump</span><span class="p">(</span><span class="nv">$mysql_database</span><span class="p">)</span>

<span class="p">{</span>

	<span class="nv">$sql</span><span class="o">=</span><span class="s2">&quot;show tables;&quot;</span><span class="p">;</span>

	<span class="nv">$result</span><span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span> <span class="nv">$result</span><span class="p">)</span>

	<span class="p">{</span>

		<span class="k">while</span><span class="p">(</span> <span class="nv">$row</span><span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span>

		<span class="p">{</span>

			<span class="nx">_mysqldump_table_structure</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>



			<span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;sql_table_data&#39;</span><span class="p">]))</span>

			<span class="p">{</span>

				<span class="nx">_mysqldump_table_data</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

			<span class="p">}</span>

		<span class="p">}</span>

	<span class="p">}</span>

	<span class="k">else</span>

	<span class="p">{</span>

		<span class="k">echo</span> <span class="s2">&quot;/* no tables in </span><span class="si">$mysql_database</span><span class="s2"> */</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

	<span class="p">}</span>

	<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>

<span class="p">}</span>



<span class="k">function</span> <span class="nf">_mysqldump_table_structure</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span>

<span class="p">{</span>

	<span class="k">echo</span> <span class="s2">&quot;/* Table structure for table `</span><span class="si">$table</span><span class="s2">` */</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

	<span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;sql_drop_table&#39;</span><span class="p">]))</span>

	<span class="p">{</span>

		<span class="k">echo</span> <span class="s2">&quot;DROP TABLE IF EXISTS `</span><span class="si">$table</span><span class="s2">`;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>

	<span class="p">}</span>

	<span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;sql_create_table&#39;</span><span class="p">]))</span>

	<span class="p">{</span>



		<span class="nv">$sql</span><span class="o">=</span><span class="s2">&quot;show create table `</span><span class="si">$table</span><span class="s2">`; &quot;</span><span class="p">;</span>

		<span class="nv">$result</span><span class="o">=</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>

		<span class="k">if</span><span class="p">(</span> <span class="nv">$result</span><span class="p">)</span>

		<span class="p">{</span>

			<span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span>

			<span class="p">{</span>

				<span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;Create Table&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>

			<span class="p">}</span>

		<span class="p">}</span>

		<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>

	<span class="p">}</span>

<span class="p">}</span>



<span class="k">function</span> <span class="nf">_mysqldump_table_data</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span>

<span class="p">{</span>



	<span class="nv">$sql</span><span class="o">=</span><span class="s2">&quot;select * from `</span><span class="si">$table</span><span class="s2">`;&quot;</span><span class="p">;</span>

	<span class="nv">$result</span><span class="o">=</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span> <span class="nv">$result</span><span class="p">)</span>

	<span class="p">{</span>

		<span class="nv">$num_rows</span><span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>

		<span class="nv">$num_fields</span><span class="o">=</span> <span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>



		<span class="k">if</span><span class="p">(</span> <span class="nv">$num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

		<span class="p">{</span>

			<span class="k">echo</span> <span class="s2">&quot;/* dumping data for table `</span><span class="si">$table</span><span class="s2">` */</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>



			<span class="nv">$field_type</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>

			<span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

			<span class="k">while</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num_fields</span><span class="p">)</span>

			<span class="p">{</span>

				<span class="nv">$meta</span><span class="o">=</span> <span class="nb">mysql_fetch_field</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span>

				<span class="nb">array_push</span><span class="p">(</span><span class="nv">$field_type</span><span class="p">,</span> <span class="nv">$meta</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">);</span>

				<span class="nv">$i</span><span class="o">++</span><span class="p">;</span>

			<span class="p">}</span>



			<span class="c1">//print_r( $field_type);</span>

			<span class="k">echo</span> <span class="s2">&quot;insert into `</span><span class="si">$table</span><span class="s2">` values</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

			<span class="nv">$index</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

			<span class="k">while</span><span class="p">(</span> <span class="nv">$row</span><span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span>

			<span class="p">{</span>

				<span class="k">echo</span> <span class="s2">&quot;(&quot;</span><span class="p">;</span>

				<span class="k">for</span><span class="p">(</span> <span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num_fields</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span>

				<span class="p">{</span>

					<span class="k">if</span><span class="p">(</span> <span class="nb">is_null</span><span class="p">(</span> <span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>

						<span class="k">echo</span> <span class="s2">&quot;null&quot;</span><span class="p">;</span>

					<span class="k">else</span>

					<span class="p">{</span>

						<span class="k">switch</span><span class="p">(</span> <span class="nv">$field_type</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span>

						<span class="p">{</span>

							<span class="k">case</span> <span class="s1">&#39;int&#39;</span><span class="o">:</span>

								<span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>

								<span class="k">break</span><span class="p">;</span>

							<span class="k">case</span> <span class="s1">&#39;string&#39;</span><span class="o">:</span>

							<span class="k">case</span> <span class="s1">&#39;blob&#39;</span> <span class="o">:</span>

							<span class="k">default</span><span class="o">:</span>

								<span class="k">echo</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>



						<span class="p">}</span>

					<span class="p">}</span>

					<span class="k">if</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num_fields</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

						<span class="k">echo</span> <span class="s2">&quot;,&quot;</span><span class="p">;</span>

				<span class="p">}</span>

				<span class="k">echo</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>



				<span class="k">if</span><span class="p">(</span> <span class="nv">$index</span> <span class="o">&lt;</span> <span class="nv">$num_rows</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

					<span class="k">echo</span> <span class="s2">&quot;,&quot;</span><span class="p">;</span>

				<span class="k">else</span>

					<span class="k">echo</span> <span class="s2">&quot;;&quot;</span><span class="p">;</span>

				<span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>



				<span class="nv">$index</span><span class="o">++</span><span class="p">;</span>

			<span class="p">}</span>

		<span class="p">}</span>

	<span class="p">}</span>

	<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>

	<span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

<span class="p">}</span>



<span class="k">function</span> <span class="nf">_mysql_test</span><span class="p">(</span><span class="nv">$mysql_host</span><span class="p">,</span><span class="nv">$mysql_database</span><span class="p">,</span> <span class="nv">$mysql_username</span><span class="p">,</span> <span class="nv">$mysql_password</span><span class="p">)</span>

<span class="p">{</span>

	<span class="k">global</span> <span class="nv">$output_messages</span><span class="p">;</span>

	<span class="nv">$link</span> <span class="o">=</span> <span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$mysql_host</span><span class="p">,</span> <span class="nv">$mysql_username</span><span class="p">,</span> <span class="nv">$mysql_password</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$link</span><span class="p">)</span>

	<span class="p">{</span>

	   <span class="nb">array_push</span><span class="p">(</span><span class="nv">$output_messages</span><span class="p">,</span> <span class="s1">&#39;Could not connect: &#39;</span> <span class="o">.</span> <span class="nb">mysql_error</span><span class="p">());</span>

	<span class="p">}</span>

	<span class="k">else</span>

	<span class="p">{</span>

		<span class="nb">array_push</span> <span class="p">(</span><span class="nv">$output_messages</span><span class="p">,</span><span class="s2">&quot;Connected with MySQL server:</span><span class="si">$mysql_username</span><span class="s2">@</span><span class="si">$mysql_host</span><span class="s2"> successfully&quot;</span><span class="p">);</span>



		<span class="nv">$db_selected</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$mysql_database</span><span class="p">,</span> <span class="nv">$link</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$db_selected</span><span class="p">)</span>

		<span class="p">{</span>

			<span class="nb">array_push</span> <span class="p">(</span><span class="nv">$output_messages</span><span class="p">,</span><span class="s1">&#39;Can\&#39;t use $mysql_database : &#39;</span> <span class="o">.</span> <span class="nb">mysql_error</span><span class="p">());</span>

		<span class="p">}</span>

		<span class="k">else</span>

			<span class="nb">array_push</span> <span class="p">(</span><span class="nv">$output_messages</span><span class="p">,</span><span class="s2">&quot;Connected with MySQL database:</span><span class="si">$mysql_database</span><span class="s2"> successfully&quot;</span><span class="p">);</span>

	<span class="p">}</span>



<span class="p">}</span>



<span class="k">if</span><span class="p">(</span> <span class="nv">$print_form</span> <span class="o">&gt;</span><span class="mi">0</span> <span class="p">)</span>

<span class="p">{</span>

<span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;</span>



<span class="x">&lt;html&gt;</span>

<span class="x">&lt;head&gt;</span>

<span class="x">&lt;title&gt;mysqldump.php version </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$mysqldump_version</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/title&gt;</span>

<span class="x">&lt;/head&gt;</span>



<span class="x">&lt;body&gt;</span>

<span class="cp">&lt;?php</span>

	<span class="k">foreach</span> <span class="p">(</span><span class="nv">$output_messages</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span>

	<span class="p">{</span>

    	<span class="k">echo</span> <span class="nv">$message</span><span class="o">.</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">;</span>

	<span class="p">}</span>

<span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span>

<span class="x">MySQL connection parameters:</span>

<span class="x">&lt;table border=&quot;0&quot;&gt;</span>

<span class="x">  &lt;tr&gt;</span>

<span class="x">    &lt;td&gt;Host:&lt;/td&gt;</span>

<span class="x">    &lt;td&gt;&lt;input  name=&quot;mysql_host&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_host&#39;</span><span class="p">]))</span><span class="k">echo</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_host&#39;</span><span class="p">];</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&quot;  /&gt;&lt;/td&gt;</span>

<span class="x">  &lt;/tr&gt;</span>

<span class="x">  &lt;tr&gt;</span>

<span class="x">    &lt;td&gt;Database:&lt;/td&gt;</span>

<span class="x">    &lt;td&gt;&lt;input  name=&quot;mysql_database&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_database&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;  /&gt;&lt;/td&gt;</span>

<span class="x">  &lt;/tr&gt;</span>

<span class="x">  &lt;tr&gt;</span>

<span class="x">    &lt;td&gt;Username:&lt;/td&gt;</span>

<span class="x">    &lt;td&gt;&lt;input  name=&quot;mysql_username&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_username&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;  /&gt;&lt;/td&gt;</span>

<span class="x">  &lt;/tr&gt;</span>

<span class="x">  &lt;tr&gt;</span>

<span class="x">    &lt;td&gt;Password:&lt;/td&gt;</span>

<span class="x">    &lt;td&gt;&lt;input  type=&quot;password&quot; name=&quot;mysql_password&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_password&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;  /&gt;&lt;/td&gt;</span>

<span class="x">  &lt;/tr&gt;</span>

<span class="x">  &lt;tr&gt;</span>

<span class="x">    &lt;td&gt;Output format: &lt;/td&gt;</span>

<span class="x">    &lt;td&gt;</span>

<span class="x">      &lt;select name=&quot;output_format&quot; &gt;</span>

<span class="x">        &lt;option value=&quot;SQL&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;SQL&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="k">echo</span> <span class="s2">&quot;selected&quot;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x"> &gt;SQL&lt;/option&gt;</span>

<span class="x">        &lt;option value=&quot;CSV&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;CSV&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="k">echo</span> <span class="s2">&quot;selected&quot;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x"> &gt;CSV&lt;/option&gt;</span>



<span class="x">        &lt;/select&gt;</span>

<span class="x">    &lt;/td&gt;</span>

<span class="x">  &lt;/tr&gt;</span>

<span class="x">&lt;/table&gt;</span>

<span class="x">&lt;input type=&quot;submit&quot; name=&quot;action&quot;  value=&quot;Test Connection&quot;&gt;&lt;br /&gt;</span>



<span class="x">  &lt;br&gt;Dump options(SQL):</span>

<span class="x">  &lt;table border=&quot;0&quot;&gt;</span>



<span class="x">    &lt;tr&gt;</span>

<span class="x">      &lt;td&gt;Drop table statement: &lt;/td&gt;</span>

<span class="x">      &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;sql_drop_table&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;sql_drop_table&#39;</span><span class="p">]))</span> <span class="p">;</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;checked&#39;</span> <span class="cp">?&gt;</span><span class="x"> /&gt;&lt;/td&gt;</span>

<span class="x">    &lt;/tr&gt;</span>

<span class="x">    &lt;tr&gt;</span>

<span class="x">      &lt;td&gt;Create table statement: &lt;/td&gt;</span>

<span class="x">      &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;sql_create_table&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;sql_create_table&#39;</span><span class="p">]))</span> <span class="p">;</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;checked&#39;</span> <span class="cp">?&gt;</span><span class="x"> /&gt;&lt;/td&gt;</span>

<span class="x">    &lt;/tr&gt;</span>

<span class="x">    &lt;tr&gt;</span>

<span class="x">      &lt;td&gt;Table data: &lt;/td&gt;</span>

<span class="x">      &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;sql_table_data&quot;  </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;sql_table_data&#39;</span><span class="p">]))</span> <span class="p">;</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;checked&#39;</span> <span class="cp">?&gt;</span><span class="x">/&gt;&lt;/td&gt;</span>

<span class="x">    &lt;/tr&gt;</span>

<span class="x">  &lt;/table&gt;</span>

<span class="x">  &lt;br&gt;Dump options(CSV):</span>

<span class="x">  &lt;table border=&quot;0&quot;&gt;</span>

<span class="x">  &lt;tr&gt;</span>

<span class="x">    &lt;td&gt;Delimiter:&lt;/td&gt;</span>

<span class="x">    &lt;td&gt;&lt;select name=&quot;csv_delimiter&quot;&gt;</span>

<span class="x">      &lt;option value=&quot;,&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;,&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="k">echo</span> <span class="s2">&quot;selected&quot;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&gt;,&lt;/option&gt;</span>

<span class="x">      &lt;option value=&quot;Tab&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;Tab&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="k">echo</span> <span class="s2">&quot;selected&quot;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&gt;Tab&lt;/option&gt;</span>

<span class="x">      &lt;option value=&quot;|&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;|&#39;</span> <span class="o">==</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;output_format&#39;</span><span class="p">])</span> <span class="k">echo</span> <span class="s2">&quot;selected&quot;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&gt;|&lt;/option&gt;</span>

<span class="x">    &lt;/select&gt;</span>

<span class="x">    &lt;/td&gt;</span>

<span class="x">  &lt;/tr&gt;</span>

<span class="x">  &lt;tr&gt;</span>

<span class="x">    &lt;td&gt;Table:&lt;/td&gt;</span>

<span class="x">    &lt;td&gt;&lt;input  type=&quot;input&quot; name=&quot;mysql_table&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;mysql_table&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;  /&gt;&lt;/td&gt;</span>

<span class="x">  &lt;/tr&gt;</span>

<span class="x">	&lt;tr&gt;</span>

<span class="x">      &lt;td&gt;Header: &lt;/td&gt;</span>

<span class="x">      &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;csv_header&quot;  </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;csv_header&#39;</span><span class="p">]))</span> <span class="p">;</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;checked&#39;</span> <span class="cp">?&gt;</span><span class="x">/&gt;&lt;/td&gt;</span>

<span class="x">    &lt;/tr&gt;</span>

<span class="x">&lt;/table&gt;</span>





<span class="x">&lt;input type=&quot;submit&quot; name=&quot;action&quot;  value=&quot;Export&quot;&gt;&lt;br /&gt;</span>

<span class="x">&lt;/form&gt;</span>

<span class="x">&lt;/body&gt;</span>

<span class="x">&lt;/html&gt;</span>



<span class="cp">&lt;?php</span>

<span class="p">}</span>

<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

  </div>
  
  <br/>
  <strong>Tags: </strong>
  <a class="label" href="https://edmondscommerce.github.io/tags/edmondscommerce">edmondscommerce</a>
  
  
</div>




<script src="https://edmondscommerce.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

