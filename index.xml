<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Edmonds Commerce Dev Blog</title>
    <link>https://edmondscommerce.github.io/</link>
    <description>Recent content on Edmonds Commerce Dev Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 23 Aug 2016 10:12:48 +0000</lastBuildDate>
    <atom:link href="https://edmondscommerce.github.io/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Magento Allow Customers to Switch Between Mobile and Desktop Themes</title>
      <link>https://edmondscommerce.github.io/magento-allow-customers-to-switch-between-mobile-and-desktop-themes/</link>
      <pubDate>Tue, 23 Aug 2016 10:12:48 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-allow-customers-to-switch-between-mobile-and-desktop-themes/</guid>
      <description>

&lt;p&gt;In this post I&amp;rsquo;ll cover how to create a basic theme switcher for switching between mobile and
desktop themes in Magento.&lt;/p&gt;

&lt;p&gt;The basic steps for the theme switcher are as follows:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Customer clicks &amp;lsquo;switch to desktop site&amp;rsquo; link&lt;/li&gt;
&lt;li&gt;Cookie is set saying the user has requested the desktop theme&lt;/li&gt;
&lt;li&gt;The cookie is detected and the correct user agent is set in index.php.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;By using a cookie we can make the selection persistent so customers don&amp;rsquo;t need to click this link
each time they visit the site.&lt;/p&gt;

&lt;h2 id=&#34;switcher-block-and-template&#34;&gt;Switcher Block and Template&lt;/h2&gt;

&lt;p&gt;First we want to create our switcher block and template.&lt;/p&gt;

&lt;p&gt;NameSpace/ModuleName/Block/Switcher.php&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;class NameSpace_ModuleName_Block_Switcher&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    extends Mage_Core_Block_Template&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    public function setSwitchToTheme($switchToTheme)&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;        $this-&amp;gt;setData(&amp;#39;switch_to_theme&amp;#39;, $switchToTheme);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    }&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;    public function getSwitchToTheme()&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;        return $this-&amp;gt;getData(&amp;#39;switch_to_theme&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    }&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;app/design/frontend/base/default/template/your/folder/structure/switcher.phtml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&amp;lt;a id=&amp;quot;theme_switcher&amp;quot; href=&amp;quot;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Mage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;helper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;core/url&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getCurrentUrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    switch to &lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getSwitchToTheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt; site&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$viewDesktopTheme&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getSwitchToTheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;desktop&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;true&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;false&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;$maxAge&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;157680000&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// 157680000 secs = 5 years (but set this to whatever you want)&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    $(&amp;#39;theme_switcher&amp;#39;).observe(&amp;#39;click&amp;#39;, function (e) {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;        document.cookie = &amp;#39;view_desktop_theme=&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$viewDesktopTheme&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;; max-age=&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$maxAge&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&amp;#39;;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    });&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;By using the setter provided by our block within our layout.xml (we&amp;rsquo;ll see this later) we can use the
same block and template for both our mobile and desktop themes.&lt;/p&gt;

&lt;h2 id=&#34;add-block-to-page&#34;&gt;Add Block to Page&lt;/h2&gt;

&lt;p&gt;Next we want to add our switcher block to both our mobile and desktop themes.&lt;/p&gt;

&lt;p&gt;app/design/frontend/your/desktop/theme/layout/mobile_to_desktop_switcher.xml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;layout&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;version=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;0.1.0&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;default&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;reference&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;where_you_want_the_switcher_to_go&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;lt;block&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;mobile_to_desktop_switcher&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;namespace_modulename/switcher&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;template=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;your/folder/structure/switcher.phtml&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;nt&#34;&gt;&amp;lt;action&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;method=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;setSwitchToTheme&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&#34;nt&#34;&gt;&amp;lt;switch_to_theme&amp;gt;&lt;/span&gt;mobile&lt;span class=&#34;nt&#34;&gt;&amp;lt;/switch_to_theme&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;nt&#34;&gt;&amp;lt;/action&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;lt;/block&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/reference&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;/default&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/layout&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;app/design/frontend/your/mobile/theme/layout/mobile_to_desktop_switcher.xml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;layout&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;version=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;0.1.0&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;default&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;reference&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;where_you_want_the_switcher_to_go&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;lt;block&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;mobile_to_desktop_switcher&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;namespace_modulename/switcher&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;template=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;your/folder/structure/switcher.phtml&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;nt&#34;&gt;&amp;lt;action&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;method=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;setSwitchToTheme&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&#34;nt&#34;&gt;&amp;lt;switch_to_theme&amp;gt;&lt;/span&gt;desktop&lt;span class=&#34;nt&#34;&gt;&amp;lt;/switch_to_theme&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;nt&#34;&gt;&amp;lt;/action&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;lt;/block&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/reference&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;/default&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/layout&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This is where we make use of our blocks setter. By placing a layout.xml in each theme we can tell the
block which theme we should switch to. In the desktop theme we pass &amp;lsquo;mobile&amp;rsquo;, in the mobile theme
we pass &amp;lsquo;desktop&amp;rsquo;.&lt;/p&gt;

&lt;p&gt;You can then add the switcher to your theme using:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getBlockHtml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mobile_to_desktop_switcher&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;add-switch-to-index-php&#34;&gt;Add Switch to index.php&lt;/h2&gt;

&lt;p&gt;Finally we need to add code to index.php which checks for our cookie and sets the current user agent
based on this.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;/* Show theme based on view_desktop_theme cookie */&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;if (isset($_COOKIE[&amp;#39;view_desktop_theme&amp;#39;])) {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    if ($_COOKIE[&amp;#39;view_desktop_theme&amp;#39;] === &amp;#39;true&amp;#39;) {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;        $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;]&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;            = &amp;#39;Mozilla/5.0 (X11; Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36&amp;#39;;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    }&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    else if ($_COOKIE[&amp;#39;view_desktop_theme&amp;#39;] === &amp;#39;false&amp;#39;) {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;        $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;]&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;            = &amp;#39;Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1&amp;#39;;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    }&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And that&amp;rsquo;s it, now when your customers click the link they should be toggled between the mobile and
desktop themes.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Doctrine Create New Entity From Legacy Database Shell Script</title>
      <link>https://edmondscommerce.github.io/doctrine-create-new-entity-from-legacy-database-shell-script/</link>
      <pubDate>Thu, 18 Aug 2016 17:09:53 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/doctrine-create-new-entity-from-legacy-database-shell-script/</guid>
      <description>&lt;p&gt;Here is a nice little script I have just written to help me with migration of a legacy application onto a Symfony based architecture, including Doctrine for entities.&lt;/p&gt;

&lt;p&gt;In this scenario I have created a new database and am importing tables across from the legacy database as I bring them into the application.&lt;/p&gt;

&lt;p&gt;The process is a little tricky and unfortunately I figured it out, then went on holiday and came back having totally forgotten how to do it. So I wrote a nice script to document and automate the process for me.&lt;/p&gt;

&lt;p&gt;Here is the script:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;readonly&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;DIR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt; dirname &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BASH_SOURCE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[0]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -e
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -u
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -o pipefail
&lt;span class=&#34;nv&#34;&gt;standardIFS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$IFS&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;$&amp;#39;\n\t&amp;#39;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===========================================&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;hostname&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$0&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$@&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===========================================&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#Usage&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$#&lt;/span&gt; &amp;lt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;Usage:&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;./&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$0&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; [tableToCreateEntityFrom] {bundle - defaults to AppBundle}&lt;/span&gt;

&lt;span class=&#34;s2&#34;&gt;    &amp;quot;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; 1
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#Parameters&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;tableToCreateEntityFrom&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;bundle&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;:-&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;AppBundle&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;camelCaseEntityName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tableToCreateEntityFrom&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sed -r &lt;span class=&#34;s1&#34;&gt;&amp;#39;s/(^|_)([a-z])/\U\2/g&amp;#39;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;newDb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;NEW_DB_NAME_HERE

&lt;span class=&#34;nv&#34;&gt;oldDb&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;OLD_DB_NAME_HERE


mysql &lt;span class=&#34;nv&#34;&gt;$newDb&lt;/span&gt; -e &lt;span class=&#34;se&#34;&gt;\&amp;quot;&lt;/span&gt;

    drop table &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; exists &lt;span class=&#34;nv&#34;&gt;$newDb&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$tableToCreateEntityFrom&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

    create table &lt;span class=&#34;nv&#34;&gt;$newDb&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$tableToCreateEntityFrom&lt;/span&gt; like &lt;span class=&#34;nv&#34;&gt;$oldDb&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$tableToCreateEntityFrom&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

    insert into &lt;span class=&#34;nv&#34;&gt;$newDb&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$tableToCreateEntityFrom&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; * from &lt;span class=&#34;nv&#34;&gt;$oldDb&lt;/span&gt;.&lt;span class=&#34;nv&#34;&gt;$tableToCreateEntityFrom&lt;/span&gt; ORDER BY
    &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;   SELECT COLUMN_NAME
        FROM information_schema.COLUMNS
        WHERE &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TABLE_SCHEMA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;$oldDb&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
          AND &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TABLE_NAME&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;$tableToCreateEntityFrom&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
          AND &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;COLUMN_KEY&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;PRI&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; DESC limit 0,500&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;se&#34;&gt;\&amp;quot;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;/../bin/console doctrine:mapping:import &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$bundle&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; annotation --filter&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;^&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$camelCaseEntityName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;\$&amp;quot;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;/../bin/console doctrine:generate:entities &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$bundle&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$camelCaseEntityName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; --no-backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The script will take a single parameter which is the table name. If not importing to AppBundle, you can also specify a bundle name.&lt;/p&gt;

&lt;p&gt;It will then create the Upper Camel Case version of the table name (as used by Doctrine).&lt;/p&gt;

&lt;p&gt;Then it runs some SQL which will drop and recreate the table and then import the most recent 500 rows from that table as defined by the primary key.&lt;/p&gt;

&lt;p&gt;Finally, we do a couple of doctrine commands to create the annotation class and then create the getters and setters. Notice the use of regex to prevent bringing in anything other than an exact match on the table name.&lt;/p&gt;

&lt;p&gt;I think this is pretty slick and makes me love Doctrine that little bit more, hope you find it useful too!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Magento 2 SSH Library</title>
      <link>https://edmondscommerce.github.io/magento-2-ssh-library/</link>
      <pubDate>Thu, 18 Aug 2016 11:49:53 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-2-ssh-library/</guid>
      <description>&lt;p&gt;One of the composer dependcies in Magento 2 is &lt;a href=&#34;https://github.com/phpseclib/phpseclib&#34; target=&#34;_blank&#34;&gt;phpseclib&lt;/a&gt;. This means for integrations using ssh you can use this instad of needing the php ssh module for your integration you can use this module.&lt;/p&gt;

&lt;p&gt;To run a remote ssh command you can use the following snippet as an example for either the straight echo or the callback way of dealing with the result:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;use phpseclib\Net\SSH2;&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;$ssh = new SSH2(&amp;#39;my-ssh-server.com&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ssh-&amp;gt;login($username, $password);&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;if($ssh-&amp;gt;isConnected()) {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;	echo $ssh-&amp;gt;exec(&amp;#39;ls -la&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;	$ssh-&amp;gt;exec(&amp;#39;ls -la&amp;#39; function($result){&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;		echo $result&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;	});&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To do a file transfer use the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;use phpseclib\Net\SFTP;&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;$sftp = new SFTP(&amp;#39;my-ssh-server.com&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$sftp-&amp;gt;login($username, $password);&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;if($sftp-&amp;gt;isConnected()) {&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;	echo $sftp-&amp;gt;get(&amp;#39;file1.txt&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You can also use the php streams with the library by running the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;use phpseclib\Net\SFTP\Stream;&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;Stream::register()&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$txt = fopen(&amp;#39;sftp://user:pass@host.com:/home/user/file.txt&amp;#39;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Magento 2 Controller Output Types</title>
      <link>https://edmondscommerce.github.io/magento-2-controller-output-types/</link>
      <pubDate>Tue, 16 Aug 2016 13:22:03 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-2-controller-output-types/</guid>
      <description>

&lt;p&gt;Magento 2 now introduces the Framework result object for handing requests that will handling non page results such as JSON, redirects and other non html returns.&lt;/p&gt;

&lt;p&gt;So to use the result factory in your controller in your controller construct simply have the following code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;$this-&amp;gt;resultFactory = $context-&amp;gt;getResultFactory();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then in the run method simply write the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;$result = $resultRedirect = $this-&amp;gt;resultFactory-&amp;gt;create($type);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;So the type value has to be one of the following constants:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;\Magento\Framework\Controller\ResultFactory::TYPE_JSON&lt;/li&gt;
&lt;li&gt;\Magento\Framework\Controller\ResultFactory::TYPE_RAW&lt;/li&gt;
&lt;li&gt;\Magento\Framework\Controller\ResultFactory::TYPE_REDIRECT&lt;/li&gt;
&lt;li&gt;\Magento\Framework\Controller\ResultFactory::TYPE_FORWARD&lt;/li&gt;
&lt;li&gt;\Magento\Framework\Controller\ResultFactory::TYPE_LAYOUT&lt;/li&gt;
&lt;li&gt;\Magento\Framework\Controller\ResultFactory::TYPE_PAGE&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;json&#34;&gt;JSON&lt;/h2&gt;

&lt;p&gt;This is for returning a JSON object from a controller with the correct mime type in the response. For returning json there are to methods:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;return $result-&amp;gt;setData([&amp;#39;variable&amp;#39;=&amp;gt;&amp;#39;value&amp;#39;]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The first method allows you to pass a php associative array which Magento 2 framework will run the serialization for you.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;return $result-&amp;gt;setJsonData(&amp;#39;{&amp;quot;variable&amp;quot;: &amp;quot;value&amp;quot;}&amp;#39;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The second method allows for you to set a raw json string to respond with instead of letting Magento 2 handle serialization of the reponse.&lt;/p&gt;

&lt;h2 id=&#34;raw&#34;&gt;Raw&lt;/h2&gt;

&lt;p&gt;This is for setting raw string and binary contents. To use this simply run the following.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;return $result-&amp;gt;setHeader(&amp;#39;Content-Type&amp;#39;,&amp;#39;text/plain&amp;#39;)-&amp;gt;setContents(&amp;#39;string&amp;#39;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;redirect&#34;&gt;Redirect&lt;/h2&gt;

&lt;p&gt;This is for redirecting a user to another page via a 301, 302 and 307 based redirects. To use this simply use the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;return $result-&amp;gt;setUrl(&amp;#39;https://www.google.co.uk&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;return $result-&amp;gt;setPath(&amp;#39;checkout&amp;#39;, [&amp;#39;_secure&amp;#39; =&amp;gt; true]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;forward&#34;&gt;Forward&lt;/h2&gt;

&lt;p&gt;Occasionaly you will want to do a internal redirect to a another controller without having the client to do a second request for this we have the forward type. To use this simply do the following.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;return $result-&amp;gt;setModule(&amp;#39;moduleName&amp;#39;)-&amp;gt;setController(&amp;#39;controller&amp;#39;)-&amp;gt;setParam([&amp;#39;id&amp;#39;=&amp;gt;1])-&amp;gt;view(&amp;#39;action&amp;#39;);&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;return $result-&amp;gt;setController(&amp;#39;controller&amp;#39;)-&amp;gt;view(&amp;#39;action&amp;#39;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The convention is controller should be folder name inside your modules &amp;lsquo;Controller&amp;rsquo; folder and action should be the name of your action php file with out the php extension. As for moduleName you can normally find out what this should be in you routes.xml file and it should be the value set in frontName attribute set in your route declaration xml.&lt;/p&gt;

&lt;p&gt;Please note if moduleName is not given then Magento 2 will assume that the module is the current one.&lt;/p&gt;

&lt;h2 id=&#34;layout-and-page&#34;&gt;Layout and Page&lt;/h2&gt;

&lt;p&gt;The last two is to simply use xml layout handling to render the contents. The only difference is that layout will not have a default layout handle so you will need to assign layout handles and Page will assign the default and controler specific handles. As expected Page extends the Layout object since there only difference is the fact that layout assumes no layout handlers to begin with.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Ssh Copy Id As Another User in Bash</title>
      <link>https://edmondscommerce.github.io/ssh-copy-id-as-another-user-in-bash/</link>
      <pubDate>Wed, 27 Jul 2016 13:01:02 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/ssh-copy-id-as-another-user-in-bash/</guid>
      <description>&lt;p&gt;Here is a nice BASH one liner that will allow you as (presumably root) copy another users SSH keys up to a server.&lt;/p&gt;

&lt;p&gt;This is ideal for setting up multiple users on a machine as the root user in bulk as part of a batch process.&lt;/p&gt;

&lt;p&gt;Ideally you will have already added the server to your ssh_config file so that ports, users etc do not need to be specified and also you have run &lt;code&gt;ssh-copy-id serverName&lt;/code&gt; as root so that you no longer have to set any passwords.&lt;/p&gt;

&lt;p&gt;Then for each user, simply run this command, replacing the placeholders as you see fit.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;cat /home/__USER__/.ssh/id_rsa.pub &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh __SERVER__ &lt;span class=&#34;s2&#34;&gt;&amp;quot;tee -a ~/.ssh/authorized_keys&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I tried a few techniques before settling on this one as by far the cleanest and easiest. Original credit goes to this &lt;a href=&#34;http://superuser.com/a/978182/573510&#34; target=&#34;_blank&#34;&gt;answer on superuser.com&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Fixing Logrotate Rotating Its Own Files</title>
      <link>https://edmondscommerce.github.io/fixing-logrotate-rotating-its-own-files/</link>
      <pubDate>Tue, 26 Jul 2016 17:50:25 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/fixing-logrotate-rotating-its-own-files/</guid>
      <description>&lt;p&gt;From time to time I come across a server that has had logRotate setup in such a way that it is rotating its own files creating hundreds of copies and increasing disk usage rather than controlling it&lt;/p&gt;

&lt;p&gt;This is caused by a misconfiguration of the logrotate config file. The file that is causing the problems can normally be found be running the following command&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;user@host$ grep &lt;span class=&#34;s1&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt; /etc/logrotate.d/*
/etc/logrotate.d/misconfiguredFile:/path/to/logs/* &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Which should display all of the paths that include a wild card that are being checked and rotated. The problem happens when the file path end s with a wildcard, as on the next run the newly rotated files will be checked and rotated again.&lt;/p&gt;

&lt;p&gt;The simple way to fix this is to either specify which files need to be rotated exactly, or add the expected suffix to the path (i.e. /path/to/dir/*log).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CVE-2011-2461 - How to Patch Magento Adobe Flex Vulnerability</title>
      <link>https://edmondscommerce.github.io/cve-2011-2461---how-to-patch-magento-adobe-flex-vulnerability/</link>
      <pubDate>Tue, 26 Jul 2016 13:25:31 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/cve-2011-2461---how-to-patch-magento-adobe-flex-vulnerability/</guid>
      <description>

&lt;h1 id=&#34;cve-2011-2461&#34;&gt;CVE-2011-2461&lt;/h1&gt;

&lt;p&gt;For magento versions older than 1.9.1.0 you can patch this vulnerability by simply installing the patched .swf
files hosted on our GitHub repo
&lt;a href=&#34;https://github.com/edmondscommerce/CVE-2011-2461_Magento_Patch&#34; target=&#34;_blank&#34;&gt;CVE-2011-2461_Magento_Patch&lt;/a&gt;.&lt;/p&gt;

&lt;h1 id=&#34;am-i-vulnerable&#34;&gt;Am I Vulnerable?&lt;/h1&gt;

&lt;p&gt;To confirm whether you&amp;rsquo;re vulnerable or not you can download
&lt;a href=&#34;https://github.com/ikkisoft/ParrotNG/releases&#34; target=&#34;_blank&#34;&gt;ParrotNG&lt;/a&gt; and run this against the
&lt;code&gt;skin/adminhtml/default/default/media&lt;/code&gt; folder.&lt;/p&gt;

&lt;h1 id=&#34;more-info&#34;&gt;More Info&lt;/h1&gt;

&lt;p&gt;Find more information regarding the CVE here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://peterocallaghan.co.uk/2016/07/magento-csrf-vulnerability-via-adobe-flex/&#34; target=&#34;_blank&#34;&gt;Peter O&amp;rsquo;Callaghan - Magento CSRF vulnerability via Adobe Flex&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.mindedsecurity.com/2015/03/the-old-is-new-again-cve-2011-2461-is.html&#34; target=&#34;_blank&#34;&gt;Minded Security - The old is new, again. CVE-2011-2461 is back!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://helpx.adobe.com/flash-builder/kb/flex-security-issue-apsb11-25.html&#34; target=&#34;_blank&#34;&gt;Adobe - Flex Security Issue APSB11-25&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Magento 2 Js Frameworks</title>
      <link>https://edmondscommerce.github.io/magento-2-js-frameworks/</link>
      <pubDate>Thu, 21 Jul 2016 16:02:34 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-2-js-frameworks/</guid>
      <description>

&lt;p&gt;There is a running joke in the Magento 1.x community where we wished we had jQuery instead of Prototype as the main JavaScript framework. Magento went with Prototype as at the time Magento 1.x was first being built, Prototype was more mature than jQuery.&lt;/p&gt;

&lt;p&gt;So with the Magento 2 overhaul we now have jQuery but it&amp;rsquo;s not the only Javascript library in Magento 2. But fear not as Magento uses it in tandem with other Libraries for good reasons.&lt;/p&gt;

&lt;h2 id=&#34;requirejs&#34;&gt;RequireJs&lt;/h2&gt;

&lt;p&gt;So this is the main one and its single use is to allow for loading in Javascript dependencies asynchronously instead of requiring everything initially through the script tags. This can be used for custom modules to load in extra javascript models and to loading in other dependencies from the Magento install.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;/*browser:true*/&lt;/span&gt;
&lt;span class=&#34;cm&#34;&gt;/*global define*/&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
        &lt;span class=&#34;s1&#34;&gt;&amp;#39;ko&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;s1&#34;&gt;&amp;#39;jquery&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;s1&#34;&gt;&amp;#39;underscore&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;s1&#34;&gt;&amp;#39;Magento_Checkout/js/model/shipping-service&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
	&lt;span class=&#34;s1&#34;&gt;&amp;#39;My_CustomModule/js/model/foo&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ko&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;shippingService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;s1&#34;&gt;&amp;#39;use strict&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This also means that javascript libraries can be shared without the conflicting variable names, especially for jQuery.&lt;/p&gt;

&lt;h3 id=&#34;knockout&#34;&gt;Knockout&lt;/h3&gt;

&lt;p&gt;A lot of the data driven JavaScript in the cart and checkout is handled by KnockoutJS which observes view models and updates the DOM on the fly without requiring you to manipulate the DOM yourself through use of jQuery or Prototype. As mentioned this is used extensively on the single page checkout, but also for the cart mini display.&lt;/p&gt;

&lt;h3 id=&#34;angularjs&#34;&gt;AngularJS&lt;/h3&gt;

&lt;p&gt;This looks to be be used for the web based installer. However, given it is available it may be possible to integrate it in to your theme with RequireJS. Please be aware that some search bots may have difficulty crawling sites using such themes.&lt;/p&gt;

&lt;h3 id=&#34;jquery&#34;&gt;jQuery&lt;/h3&gt;

&lt;p&gt;DOM manipulation which is not reliant on underlying data models, such as banners, now uses jQuery. This brings the ability to use some nice jQuery add-ons that are out there without the conflicting javascript variable names when combined with RequireJS. It also looks to provide the functionality for AJAX requests on the front end allowing you to use &lt;a href=&#34;http://api.jquery.com/category/ajax/&#34; target=&#34;_blank&#34;&gt;methods shown here&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;underscore&#34;&gt;Underscore&lt;/h3&gt;

&lt;p&gt;This provides some useful Javascript functions to manipulate Javascript arrays, functions, objects and collections. This library is not required for you to use but provides a great alternative to rolling your own functions for dealing with arrays.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Jira Release With Git Tag</title>
      <link>https://edmondscommerce.github.io/jira-release-with-git-tag/</link>
      <pubDate>Thu, 21 Jul 2016 11:10:42 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/jira-release-with-git-tag/</guid>
      <description>

&lt;h2 id=&#34;create-jira-release&#34;&gt;Create Jira Release&lt;/h2&gt;

&lt;p&gt;When on the Kanban board for your current project:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Ensure all tasks you wish to be included in your release are marked as &amp;lsquo;Done&amp;rsquo;.&lt;/li&gt;
&lt;li&gt;Click the &amp;lsquo;Release&amp;hellip;&amp;rsquo; link in the top right corner of the board.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;You should now be presented with a form asking you to enter details about this
release (the version number you add into &amp;lsquo;Version name&amp;rsquo; will be used later
for the Git tag).&lt;/p&gt;

&lt;p&gt;Once the release has been created you need to navigate to the releases page
using the ship icon on the left. Select your release. You should now see
a &amp;lsquo;Release Notes&amp;rsquo; link.&lt;/p&gt;

&lt;p&gt;In order to get a nice markdown version of your release notes you&amp;rsquo;ll want to
convert the HTML version into markdown (you can use:
&lt;a href=&#34;https://domchristie.github.io/to-markdown/&#34; target=&#34;_blank&#34;&gt;domchristie.github.io/to-markdown&lt;/a&gt;).&lt;/p&gt;

&lt;h2 id=&#34;create-git-tag&#34;&gt;Create Git Tag&lt;/h2&gt;

&lt;p&gt;Now you have your pretty release notes it&amp;rsquo;s time to create your Git tag for
this release.&lt;/p&gt;

&lt;p&gt;To create the tag run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;git tag -a &amp;lt;release version number&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You should now be in you editor of choice; paste the markdown release notes
we just created into there (be sure to remove any &amp;lsquo;#&amp;rsquo; characters as they will
be interpreted as comments).&lt;/p&gt;

&lt;p&gt;Save the notes and that&amp;rsquo;s it. You can now view the tag for this release
using:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;git show &amp;lt;release version number&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Magento 2 Setup Script</title>
      <link>https://edmondscommerce.github.io/magento-2-setup-script/</link>
      <pubDate>Thu, 21 Jul 2016 10:10:56 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-2-setup-script/</guid>
      <description>

&lt;h3 id=&#34;summary&#34;&gt;Summary&lt;/h3&gt;

&lt;p&gt;The main set up file, will set up the database and source a couple scripts to help with the process.
Make sure you set up all the scripts correctly in the same working directory.&lt;/p&gt;

&lt;p&gt;The scripts assume that they are placed in a &lt;code&gt;shellscripts&lt;/code&gt; directory within the Magento 2 root directory (not pub).&lt;/p&gt;

&lt;h3 id=&#34;instructions&#34;&gt;Instructions&lt;/h3&gt;

&lt;p&gt;Make a directory call &lt;code&gt;shellscripts&lt;/code&gt; in the Magento 2 root and create each of the following files in the new directory.&lt;/p&gt;

&lt;p&gt;To run the scripts &lt;code&gt;cd&lt;/code&gt; in to the directory and run &lt;code&gt;setup.bash&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If a database already exists then it will be dropped and recreated.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;setup.bash&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;readonly&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;DIR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt; dirname &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BASH_SOURCE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[0]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt; ./_top.inc.bash&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;detailsFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/mageDetails.txt&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;authJson&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/../auth.json&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;



&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[[&lt;/span&gt; -f &lt;span class=&#34;nv&#34;&gt;$detailsFile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Found existing details file, aborting&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; 1&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; -f &lt;span class=&#34;nv&#34;&gt;$authJson&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Auth json detected, continuing&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;auth.json is missing, it is required to download composer dependencies&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; 1&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Details file not found, continuing install process...&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Cleaning var directories&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
rm -rf &lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;/*&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;repoPublicKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;YOUR_MAGENTO2_PUBLIC_KEY&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;repoPrivateKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;YOUR_MAGENTO2_PRIVATE_KEY&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;#Defaults&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;adminFName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;admin_firstname_here&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;adminLName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;admin_lastname_here&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;adminUName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;myadminusername&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;adminPass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;2p&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&amp;lt; /dev/urandom tr -dc _A-Z-a-z-0-9 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head -c7&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;echo&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;adminEmail&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;info@yourdomain.com&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;dbPrefix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&amp;lt; /dev/urandom tr -dc _A-Z-a-z-0-9 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head -c6&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;echo&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;_&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;storeLanguage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;en_GB&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;storeCurrency&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;GBP&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;storeTimezone&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Europe/London&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;urlSecure&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;urlRewrites&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;phpCommand&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;php&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt; ./env.inc.bash

&lt;span class=&#34;c1&#34;&gt;#Set up the database&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Recreating database &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; ...&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
mysql -e &lt;span class=&#34;s2&#34;&gt;&amp;quot;DROP DATABASE IF EXISTS &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; mysql -e &lt;span class=&#34;s2&#34;&gt;&amp;quot;CREATE DATABASE &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Composer dependencies ...&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ../&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
composer install&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;


&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Installing Magento 2 ...&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$phpCommand&lt;/span&gt; ../bin/magento setup:install &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --admin-firstname &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$adminFName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --admin-lastname &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$adminLName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --admin-email &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$adminEmail&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --admin-user &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$adminUName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --admin-password &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$adminPass&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --db-host &lt;span class=&#34;nv&#34;&gt;$dbHost&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --db-name &lt;span class=&#34;nv&#34;&gt;$dbName&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --db-user &lt;span class=&#34;nv&#34;&gt;$dbUser&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --db-password &lt;span class=&#34;nv&#34;&gt;$dbPass&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --db-prefix &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dbPrefix&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --base-url &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$urlBase&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --use-secure &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$urlSecure&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --backend-frontname &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$urlAdmin&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Username: &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$adminUName&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; Password: &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$adminPass&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &amp;gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/mageDetails.txt&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

bash &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/fixpermissions.bash&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;fixpermissions.bash&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;[[&lt;/span&gt; -z &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]]&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;readonly&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;DIR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt; dirname &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BASH_SOURCE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[0]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;source&lt;/span&gt; ./_top.inc.bash&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;


mkdir -p &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/page_cache&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Finding files to update permissions ...&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; fixMagentoPermissionsForDir&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;dirChange&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    chmod -R &lt;span class=&#34;m&#34;&gt;777&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirChange&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#TODO Replace with chown and env file for web user&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;arrDirToChange&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=(&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/page_cache&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/cache&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/cache/*&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/generation&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/generation/*&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/log&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirVar&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/log/*.log&amp;quot;&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; d in &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;arrDirToChange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[@]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Fixing: &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$d&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    fixMagentoPermissionsForDir &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$d&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;_top.inc.bash&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -e
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -u
&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; -o pipefail
&lt;span class=&#34;nv&#34;&gt;standardIFS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$IFS&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;IFS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;$&amp;#39;\n\t&amp;#39;&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===========================================&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;hostname&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$0&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$@&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;===========================================&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;


&lt;span class=&#34;c1&#34;&gt;#### VARIABLES ####&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;dirProjectRoot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;realpath &lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;/../&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;dirVar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$dirProjectRoot&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/var&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;env.inc.dist&lt;/code&gt; (rename to env.inc and add overrides for environments where needed)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# Copy this and rename .dist to .bash&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;dbHost&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;localhost&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;dbUser&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;root&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;dbPass&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;dbName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;magento&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;urlBase&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;urlAdmin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;admin&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Lenovo Carbon X1 Fedora 24 Wifi Issues &#43; Solution</title>
      <link>https://edmondscommerce.github.io/lenovo-carbon-x1-fedora-24-wifi-issues-&#43;-solution/</link>
      <pubDate>Wed, 20 Jul 2016 19:28:43 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/lenovo-carbon-x1-fedora-24-wifi-issues-&#43;-solution/</guid>
      <description>&lt;p&gt;So my new Lenovo ultrabook is very nice, but trying to transfer a database dump over SCP was failing, every, time.&lt;/p&gt;

&lt;p&gt;In my trade, transferring large files around is pretty much a requirement so I had to find a solution. A lot of Googling later and I did the following that seemed to fix it:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;sudo bash -c &lt;span class=&#34;s1&#34;&gt;&amp;#39; echo &amp;quot;options iwlwifi 11n_disable=1&amp;quot;  &amp;gt;&amp;gt;  /etc/modprobe.d/iwlwifi.conf &amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In order to test if the above fix works, I wrote this little script and placed in my ~/bin directory (called fixwifi)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/usr/bin/env bash
echo &amp;quot;f******g linux wifi...&amp;quot;
sudo bash -c &amp;quot;modprobe -r iwlmvm; modprobe -r iwlwifi; modprobe iwlwifi 11n_disable=1; modprobe iwlmvm&amp;quot;
echo &amp;quot;sorted&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Something else I did which I&amp;rsquo;m not sure if it has helped is to symlink the firmware specified in &lt;code&gt;modinfo iwlwifi&lt;/code&gt; to what seems to be a more up to date verion.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[joseph@josephlaptop ~] $ ll /lib/firmware/ | grep 8000C
lrwxrwxrwx. 1 root root      22 Jul 20 17:06 iwlwifi-8000C-13.ucode -&amp;gt; iwlwifi-8000C-21.ucode
-rw-r--r--. 1 root root 1745176 Jul 20 17:05 iwlwifi-8000C-13.ucode.bak
-rw-r--r--. 1 root root 2351636 Jun  9 14:17 iwlwifi-8000C-16.ucode
-rw-r--r--. 1 root root 2394060 Jun  9 14:17 iwlwifi-8000C-21.ucode
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When I did this, things did seem to improve but its hard to know if its just a coincidence. Its working fine now though so I&amp;rsquo;m leaving it that way.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve now repeatedly transferred large amounts of data using SCP and it has worked fine every time, so regarding this as solved :)&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Fedora 24 Bash Script to Change Desktop Background</title>
      <link>https://edmondscommerce.github.io/fedora-24-bash-script-to-change-desktop-background/</link>
      <pubDate>Tue, 19 Jul 2016 20:05:32 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/fedora-24-bash-script-to-change-desktop-background/</guid>
      <description>

&lt;h2 id=&#34;bash-script-to-change-desktop-on-gnome-shell&#34;&gt;Bash Script to Change Desktop on Gnome Shell&lt;/h2&gt;

&lt;p&gt;Previously on this blog I had a script that will change your desktop background and can be used on cron&lt;/p&gt;

&lt;p&gt;This is an updated version of that script, mainly the pgrep no longer works as the gdm login is matching as well so we need to be more specific when pulling out the process ID.&lt;/p&gt;

&lt;p&gt;Here is the script, copy paste into a bash script, edit the path for images and then add to your crontab and enjoy nice backgrounds of your choosing.&lt;/p&gt;

&lt;p&gt;I like to combine this with a transparent top panel for something a bit less bland and depressing than the solid black bar that we have by default. You can install this &lt;a href=&#34;https://extensions.gnome.org/extension/358/activities-configurator/&#34; target=&#34;_blank&#34;&gt;gnome shell extension&lt;/a&gt; to easily set transparency and also other tweaks.`&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;PID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;ps waux &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;g&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;nome-session-binary &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep -v gdm &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -d &lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; -f 5&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;DBUS_SESSION_BUS_ADDRESS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;grep -z DBUS_SESSION_BUS_ADDRESS /proc/&lt;span class=&#34;nv&#34;&gt;$PID&lt;/span&gt;/environ&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;cut -d&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; -f2-&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;GSETTINGS_BACKEND&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dconf 
gsettings &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; org.gnome.desktop.background picture-uri &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;quot;file://&amp;#39;&lt;/span&gt;/home/joseph/Pictures/Wallpapers/&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;ls /home/joseph/Pictures/Wallpapers/ &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; shuf -n 1&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Magento 1.9.2.3 Fixes Php 5.6 Compatibility</title>
      <link>https://edmondscommerce.github.io/magento-1.9.2.3-fixes-php-5.6-compatibility/</link>
      <pubDate>Tue, 19 Jul 2016 19:20:14 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-1.9.2.3-fixes-php-5.6-compatibility/</guid>
      <description>&lt;p&gt;There&amp;rsquo;s been a long standing issue with Magento, or more specifically the Zend version it ships with, not supporting the latest version of PHP - v5.6&lt;/p&gt;

&lt;p&gt;The issue is in a couple of places where it calls a now deprecated function &lt;code&gt;iconv_set_encoding(&#39;internal_encoding&#39;, &#39;UTF-8&#39;);&lt;/code&gt; in &lt;code&gt;lib/Zend/Validate/Hostname.php&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;With PHP 5.5 having gone out of support, leaving &lt;a href=&#34;http://php.net/supported-versions.php&#34; target=&#34;_blank&#34;&gt;PHP 5.6 being the only 5.x version currently supported&lt;/a&gt;, this has become a pressing issue.&lt;/p&gt;

&lt;p&gt;Fortunately Magento has finally addressed this with a change in 1.9.2.3 changing the code in question to use the valid &lt;code&gt;ini_set(&#39;default_charset&#39;, &#39;UTF-8&#39;);&lt;/code&gt; function call.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://community.magento.com/t5/Version-Upgrades/Is-1-9-2-3-compatible-with-PHP-5-6/td-p/27411&#34; target=&#34;_blank&#34;&gt;More details can be found at this Magento community post&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Magento 2 Dependency Injection and Swapping Dependencies with Virtual Types</title>
      <link>https://edmondscommerce.github.io/magento-2-dependency-injection-and-swapping-dependencies-with-virtual-types/</link>
      <pubDate>Tue, 19 Jul 2016 11:22:52 +0100</pubDate>
      
      <guid>https://edmondscommerce.github.io/magento-2-dependency-injection-and-swapping-dependencies-with-virtual-types/</guid>
      <description>&lt;p&gt;Recently we came across a scenario where we wanted to swap dependencies depending on the class that required them. The scenario was that we were using either the console or logging as an output
when writing a module to use an API for product data among other things.&lt;/p&gt;

&lt;p&gt;We wanted to be able to easily swap out the class that handled the output to logging or console (one for each output using an interface contract to standardise the classes)&lt;/p&gt;

&lt;p&gt;Suppose we have an output contract aptly named &lt;code&gt;OutputContract&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;interface OutputContract&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;{&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    /**&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;     * @param string $message&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;     */&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    public function write($message);&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;    /**&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;     * @param string $message&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;     */&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    public function writeln($message);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We would then have two classes that implement this contract also aptly named &lt;code&gt;Console&lt;/code&gt; and &lt;code&gt;Logger&lt;/code&gt; (these can be placed in a namespace to group them together as implementations).&lt;/p&gt;

&lt;p&gt;In Magento 2 dependency injection we can explicitly declare what dependencies a specific class will be given but we can also declare a virtual type.
In this instance we have two classes that will use the output contract, one that is used when running under cron where we want to output to a log file and the other that will use used when running
a command using &lt;code&gt;bin/magento&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Here is a sample di.xml that is used by a module to specify the dependencies.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; ?&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;config&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;xsi:noNamespaceSchemaLocation=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;urn:magento:framework:ObjectManager/etc/config.xsd&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;preference&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;for=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;EdmondsCommerce\Module\Contracts\OutputContract&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;EdmondsCommerce\Module\Helper\Output\Logger&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/config&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here we have specified that we want the output contract to use the logger output by default which is a sane default as everything is written to a log file to be referred to if issues arise.
When the interface is type hinted in a constructor we will get the type specified in the preference for that interface.&lt;/p&gt;

&lt;p&gt;As for swapping out the dependency we can do the following.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span&gt;&lt;/span&gt;    ...
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;virtualType&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;SimpleConsoleImport&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;EdmondsCommerce\Module\Helper\Importer&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;arguments&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;lt;argument&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;output&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;xsi:type=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;object&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;EdmondsCommerce\Module\Helper\Output\Console&lt;span class=&#34;nt&#34;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/arguments&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;/virtualType&amp;gt;&lt;/span&gt;
    
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;type&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;EdmondsCommerce\Module\Console\Api\Products&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;lt;arguments&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;nt&#34;&gt;&amp;lt;argument&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;productImport&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;xsi:type=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;object&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;SimpleConsoleImport&lt;span class=&#34;nt&#34;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;nt&#34;&gt;&amp;lt;/arguments&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/type&amp;gt;&lt;/span&gt;
    ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here instead of using a direct implementation or interface we have specified a virtual type. The virtual type declares that there is a pseudo class named &lt;code&gt;SimpleConsoleImport&lt;/code&gt; that uses a different
implementation of the &lt;code&gt;OutputContract&lt;/code&gt; which writes to the console instead of to a log file. This class is then used by the console command and so the output is written where we want it.&lt;/p&gt;

&lt;p&gt;This is a simple demonstration of how we can swap dependencies using the virtual type system which gives a lot of power to the developer which slightly resembles the rewrite system with swapping
out classes for bespoke code.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Fedora 24 Install on Lenovo X1 Carbon</title>
      <link>https://edmondscommerce.github.io/fedora-24-install-on-lenovo-x1-carbon/</link>
      <pubDate>Mon, 18 Jul 2016 14:48:36 +0000</pubDate>
      
      <guid>https://edmondscommerce.github.io/fedora-24-install-on-lenovo-x1-carbon/</guid>
      <description>

&lt;h1 id=&#34;installing-fedora-on-my-new-lenovo-x1-carbon&#34;&gt;Installing Fedora on my new Lenovo X1 Carbon&lt;/h1&gt;

&lt;p&gt;I have just bought a nice new Lenovo x1 Carbon laptop. Plenty of power and portability was what I was looking for. It&amp;rsquo;s also really important that it runs Linux with the minumum of fuss.&lt;/p&gt;

&lt;p&gt;Having done a load of research it seemed that Lenovo was the brand of choice for Red Hat developers and so, hopefully, Fedora - which is very closely related to Red Hat - should work fine.&lt;/p&gt;

&lt;p&gt;Booting into the LiveCD was hassle free and the installation seemed to go great. But then trying to boot and it just wouldn&amp;rsquo;t work at all, neither would windows, or even the recovery system. It was bricked.&lt;/p&gt;

&lt;h2 id=&#34;bios&#34;&gt;BIOS&lt;/h2&gt;

&lt;p&gt;Much fiddling with BIOS later I had the idea of disabling the legacy boot options and forcing UEFI only. I know that Fedora has supported UEFI for some time so this should be no issue. I also had a sneaking (desparately hoping) suspicion that Fedora had detected the fact that the laptop BIOS was preconfigured to support legacy BIOS operating systems and so had not done its UEFI thing. Perhaps a reinstall with only UEFI enabled at the BIOS would fix things.&lt;/p&gt;

&lt;h2 id=&#34;success&#34;&gt;Success&lt;/h2&gt;

&lt;p&gt;Turns out the hunch was right, reinstalling with only UEFI enabled in the BIOS seems to have fixed things and so now I&amp;rsquo;m onto the more fun step of taking my baseline shiny new Fedora 24 and making it my own.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>