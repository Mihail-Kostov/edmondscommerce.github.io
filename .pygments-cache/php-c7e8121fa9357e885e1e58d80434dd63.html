<div class="highlight"><pre><span class="k">function</span> <span class="nf">ean13_check_digit</span><span class="p">(</span><span class="nv">$digits</span><span class="p">){</span>
<span class="c1">//first change digits to a string so that we can access individual numbers</span>
<span class="nv">$digits</span> <span class="o">=</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$digits</span><span class="p">;</span>
<span class="c1">// 1. Add the values of the digits in the even-numbered positions: 2, 4, 6, etc.</span>
<span class="nv">$even_sum</span> <span class="o">=</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">5</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">7</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">9</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">11</span><span class="p">};</span>
<span class="c1">// 2. Multiply this result by 3.</span>
<span class="nv">$even_sum_three</span> <span class="o">=</span> <span class="nv">$even_sum</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>
<span class="c1">// 3. Add the values of the digits in the odd-numbered positions: 1, 3, 5, etc.</span>
<span class="nv">$odd_sum</span> <span class="o">=</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">6</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">8</span><span class="p">}</span> <span class="o">+</span> <span class="nv">$digits</span><span class="p">{</span><span class="mi">10</span><span class="p">};</span>
<span class="c1">// 4. Sum the results of steps 2 and 3.</span>
<span class="nv">$total_sum</span> <span class="o">=</span> <span class="nv">$even_sum_three</span> <span class="o">+</span> <span class="nv">$odd_sum</span><span class="p">;</span>
<span class="c1">// 5. The check character is the smallest number which, when added to the result in step 4,  produces a multiple of 10.</span>
<span class="nv">$next_ten</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ceil</span><span class="p">(</span><span class="nv">$total_sum</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="mi">10</span><span class="p">;</span>
<span class="nv">$check_digit</span> <span class="o">=</span> <span class="nv">$next_ten</span> <span class="o">-</span> <span class="nv">$total_sum</span><span class="p">;</span>
<span class="k">return</span> <span class="nv">$digits</span> <span class="o">.</span> <span class="nv">$check_digit</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>