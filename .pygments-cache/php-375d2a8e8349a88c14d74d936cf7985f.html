<div class="highlight"><pre><span class="k">class</span> <span class="nc">EdmondsCommerce_LegacyPassword_Model_Encryption</span> <span class="k">extends</span> <span class="nx">Mage_Core_Model_Encryption</span> <span class="p">{</span>

    <span class="sd">/**</span>
<span class="sd">     * Validate hash against hashing method (with or without salt)</span>
<span class="sd">     * </span>
<span class="sd">     * Extended to support the legacy password hashing of the previous system</span>
<span class="sd">     *</span>
<span class="sd">     * @param string $password</span>
<span class="sd">     * @param string $hash</span>
<span class="sd">     * @return bool</span>
<span class="sd">     * @throws Exception</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">validateHash</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="cm">/*password matches legacy pattern (as stored hash in DB)*/</span><span class="p">)</span> <span class="p">{</span>            
            <span class="c1">// create a hash of the plain text password and compare to the stored hash</span>
            <span class="k">return</span> <span class="nv">$hashed_pass</span> <span class="o">==</span> <span class="nv">$hashval</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">//default magento hashing from here</span>
        <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">validateHash</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>