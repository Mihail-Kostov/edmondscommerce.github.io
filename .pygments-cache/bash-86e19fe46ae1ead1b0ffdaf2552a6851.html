<div class="highlight"><pre>// The duplicated directory
<span class="nv">DUPLICATED_DIR_NAME</span><span class="o">=</span><span class="s1">&#39;uploads&#39;</span>
// A new directory <span class="k">for </span>the files to go into
<span class="nv">NEW_DIR_NAME</span><span class="o">=</span><span class="s1">&#39;realuploads&#39;</span>
<span class="k">for </span>f in <span class="sb">`</span>find ./ | grep <span class="nv">$DUPLICATED_DIR_NAME</span>/<span class="nv">$DUPLICATED_DIR_NAME</span> <span class="sb">`</span>; 
<span class="k">do </span>
<span class="nv">NEWFILE</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$f</span> | sed <span class="s1">&#39;s/$DUPLICATED_DIR_NAME\//\//g&#39;</span><span class="sb">`</span>; 
<span class="nv">NEWDIR</span><span class="o">=</span>../<span class="nv">$NEW_DIR_NAME</span>/<span class="sb">`</span>dirname <span class="nv">$NEWFILE</span><span class="sb">`</span>; 
<span class="k">if</span> <span class="o">[[</span> ! -d <span class="nv">$NEWDIR</span> <span class="o">]]</span>
<span class="k">then</span>
mkdir <span class="nv">$NEWDIR</span>; 
<span class="k">fi</span>
cp -f &amp;quot;<span class="nv">$f</span>&amp;quot; ../<span class="nv">$NEW_DIR_NAME</span>/<span class="nv">$NEWFILE</span>; 
<span class="k">done</span>
</pre></div>