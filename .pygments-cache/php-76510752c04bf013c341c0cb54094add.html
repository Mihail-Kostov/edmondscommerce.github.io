<div class="highlight"><pre><span class="nv">$cache_days</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="nv">$cache_days</span> <span class="o">=</span> <span class="nv">$cache_days</span> <span class="o">*</span> <span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">);</span>

<span class="k">function</span> <span class="nf">cached_download</span><span class="p">(</span><span class="nv">$remote</span><span class="p">,</span> <span class="nv">$local</span><span class="p">){</span>
<span class="nv">$cache_days</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cache_days&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$local</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$local</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="nb">time</span><span class="p">()</span> <span class="o">-</span> <span class="nv">$cache_days</span><span class="p">))){</span>
<span class="c1">// we have a local copy that is less than $cache_days old</span>
<span class="k">echo</span> <span class="s1">&#39;</span>
<span class="s1">&lt;h3&gt;Using Cached - Last Downloaded &#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;H:m:s d/m/Y&#39;</span><span class="p">,</span> <span class="nb">filemtime</span><span class="p">(</span><span class="nv">$local</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/h3&gt;</span>
<span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">echo</span> <span class="s1">&#39;</span>
<span class="s1">&lt;h3&gt;Downloading Now...&lt;/h3&gt;</span>
<span class="s1">&#39;</span><span class="p">;</span>
<span class="nb">flush</span><span class="p">();</span>
<span class="nb">copy</span><span class="p">(</span><span class="nv">$remote</span><span class="p">,</span> <span class="nv">$local</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>