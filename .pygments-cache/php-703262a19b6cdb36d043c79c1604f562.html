<div class="highlight"><pre><span class="nv">$blockToDisplay</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getLayout</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">createBlock</span><span class="p">(</span><span class="s1">&#39;cms/block&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setBlockId</span><span class="p">(</span><span class="s1">&#39;static_block_id_to_display&#39;</span><span class="p">);</span>
<span class="sd">/**</span>
<span class="sd">* Here we create an array of custom variables that will be passed to the static block. You can set as many as you</span>
<span class="sd">* need and call them whatever makes sense. The important part is in the Static Block you call these like this</span>
<span class="sd">* {{var customer_name}}</span>
<span class="sd">* Note there are no spaces between the braces and the characters - this is something that caught me out</span>
<span class="sd">*/</span>
<span class="nv">$customVariables</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="nv">$customVariables</span><span class="p">[</span><span class="s1">&#39;customer_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Mage</span><span class="o">::</span><span class="na">helper</span><span class="p">(</span><span class="s1">&#39;customer&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getCustomerName</span><span class="p">();</span>
<span class="nv">$filter</span> <span class="o">=</span> <span class="nx">Mage</span><span class="o">::</span><span class="na">getModel</span><span class="p">(</span><span class="s1">&#39;core/email_template_filter&#39;</span><span class="p">);</span>
<span class="nv">$filter</span><span class="o">-&gt;</span><span class="na">setVariables</span><span class="p">(</span><span class="nv">$customVariables</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$filter</span><span class="o">-&gt;</span><span class="na">filter</span><span class="p">(</span><span class="nv">$blockToDisplay</span><span class="o">-&gt;</span><span class="na">toHtml</span><span class="p">());</span>
</pre></div>