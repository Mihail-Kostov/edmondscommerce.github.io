<div class="highlight"><pre><span class="nv">$query</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;select * from table&quot;</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span><span class="nv">$q</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$query</span><span class="p">)){</span>
	<span class="nv">$output</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$q</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">require_once</span> <span class="s2">&quot;excel.php&quot;</span><span class="p">;</span>
<span class="nv">$export_file</span> <span class="o">=</span> <span class="s2">&quot;xlsfile://export.xls&quot;</span><span class="p">;</span>
<span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$export_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span>
<span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Cannot open </span><span class="si">$export_file</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$output</span><span class="p">));</span>
<span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="nx">header</span> <span class="p">(</span><span class="s2">&quot;Content-Type: application/x-msexcel&quot;</span><span class="p">);</span>
<span class="nx">header</span> <span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">exports.xls</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="p">);</span>
<span class="nb">readfile</span><span class="p">(</span><span class="s2">&quot;xlsfile://export.xls&quot;</span><span class="p">);</span>
<span class="k">exit</span><span class="p">;</span>
</pre></div>