<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: php 5.6 | Edmonds Commerce Dev Blog]]></title>
  <link href="http://edmondscommerce.github.io/tag/php-5-dot-6/atom.xml" rel="self"/>
  <link href="http://edmondscommerce.github.io/"/>
  <updated>2015-05-13T14:00:16+01:00</updated>
  <id>http://edmondscommerce.github.io/</id>
  <author>
    <name><![CDATA[EdmondsCommerce Development Team]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[PHP json_encode Failing with No Clear Reason + Solution]]></title>
    <link href="http://edmondscommerce.github.io/php/php-json-encode-failing-with-no-clear-reason-plus-solution.html"/>
    <updated>2015-05-13T13:05:35+01:00</updated>
    <id>http://edmondscommerce.github.io/php/php-json-encode-failing-with-no-clear-reason-plus-solution</id>
    <content type="html"><![CDATA[<p>I recently had an issue on a server that has been updated to use PHP 5.6. Code that was using json_encode had stopped working for no apparent reason.</p>

<p>Reading into the issue, it seems that one scenario that this would happen is if the strings in an array were not valid utf8. An obvious solution to this was to encode the strings.</p>

<p>Here is a simple function to process an array ready for use with json_encode. It solved the issue for me, maybe it can help you too?</p>

<p>``` php</p>

<p>/<em>*
 * Process an array and utf8 encode all leaf elements ready for json encode
 * @param array &amp;$arr &ndash; reference to an array to process
 </em>/
function utf8_array_for_json(array &amp;$arr){</p>

<pre><code>array_walk_recursive($arr, function(&amp;$valByRef){$valByRef = utf8_encode($valByRef);});
</code></pre>

<p>}</p>

<p>```</p>

<p>To use this, simply pass in your array (by reference) before calling json_encode on the array, for example:</p>

<p>``` php</p>

<p>utf8_array_for_json($myArray);
echo json_encode($myArray);</p>

<p>```</p>
]]></content>
  </entry>
  
</feed>
