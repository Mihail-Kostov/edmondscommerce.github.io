<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: class | Edmonds Commerce Dev Blog]]></title>
  <link href="http://edmondscommerce.github.io/tag/class/atom.xml" rel="self"/>
  <link href="http://edmondscommerce.github.io/"/>
  <updated>2014-12-10T18:11:47+00:00</updated>
  <id>http://edmondscommerce.github.io/</id>
  <author>
    <name><![CDATA[EdmondsCommerce Development Team]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Magento Shell Scripts and Memory Limit Woes + Solution]]></title>
    <link href="http://edmondscommerce.github.io/magento/magento-shell-scripts-and-memory-limit-woes-solution.html"/>
    <updated>2012-12-19T11:53:48+00:00</updated>
    <id>http://edmondscommerce.github.io/magento/magento-shell-scripts-and-memory-limit-woes-solution</id>
    <content type="html"><![CDATA[<p>OK so you love Magento&rsquo;s shell scripts! They are great for quickly putting together bulk processes that have full access to the Magento ORM.</p>

<p>These kinds of shell scripts will often require above normal amounts of RAM for the kind of heavy lifting they lend themselves well to. If you are finding your script is banging against some mysterious memory limit that really shouldn&rsquo;t be there then perhaps this is your answer:</p>

<p>You might see an error message such as this:</p>

<p>```</p>

<p>Fatal error:  Allowed memory size of 134217728 bytes exhausted (tried to allocate 20 bytes)</p>

<p>```</p>

<p>The reason this might be happening is that one of the things the abstract shell class does is parse the .htaccess file and apply any PHP configuration it finds. This is pretty slick and I can definitely see the value of it however if you are not aware its happening and you have a memory limit defined in a .htaccess file then it will be applied to your shell environment.</p>

<p>The solution is up to you, edit the htaccess file or override this method in your shell class so that it doesn&rsquo;t do things you do not want:</p>

<p>```php</p>

<pre><code>/**
 * Parse .htaccess file and apply php settings to shell script
 *
 */
protected function _applyPhpVariables()
{
    $htaccess = $this-&gt;_getRootPath() . '.htaccess';
    if (file_exists($htaccess)) {
        // parse htaccess file
        $data = file_get_contents($htaccess);
        $matches = array();
        preg_match_all('#^\s+?php_value\s+([a-z_]+)\s+(.+)$#siUm', $data, $matches, PREG_SET_ORDER);
        if ($matches) {
            foreach ($matches as $match) {
                @ini_set($match[1], $match[2]);
            }
        }
        preg_match_all('#^\s+?php_flag\s+([a-z_]+)\s+(.+)$#siUm', $data, $matches, PREG_SET_ORDER);
        if ($matches) {
            foreach ($matches as $match) {
                @ini_set($match[1], $match[2]);
            }
        }
    }
}
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Magento Block Caching Cache Key Helper Method - Generate Safe Unique Cache Keys]]></title>
    <link href="http://edmondscommerce.github.io/magento/magento-block-caching-cache-key-helper-method-generate-safe-unique-cache-keys.html"/>
    <updated>2012-12-04T12:21:44+00:00</updated>
    <id>http://edmondscommerce.github.io/magento/magento-block-caching-cache-key-helper-method-generate-safe-unique-cache-keys</id>
    <content type="html"><![CDATA[<p>If you do any work at all on Magento performance optimisation with a view to making pages load faster then you must have come across block caching. To understand block caching you need to first of all understand that a Magento page is actually made up of a lot of nested chunks called blocks.</p>

<p>Blocks can have their HTML generated dynamically every time though it is also possible to make Magento cache the block HTML output so that it loads a LOT faster, especially with heavy and slow blocks such as best sellers etc.</p>

<p>When setting up block caching, you need to specify a cache key. If your cache key is not unique enough then there is a risk that you will display the wrong cache for a particular scenario.</p>

<p>For this reason I created a block caching helper with this method that can generate a very unique cache key based on the current block usage.
/app/code/local/EdmondsCommerce/Helper/Data.php
```php</p>

<p>/**</p>

<pre><code> * Generate a nice unique block cache key
 *
 * @param Mage_Core_Block_Abstract $block
 * @return string
 */
public function ecCacheKey(Mage_Core_Block_Abstract $block){
    $class = get_class($block);
    $template = $block-&gt;getTemplateFile();
    $md5 = md5(var_export($block-&gt;getData(), true));
    $params = trim(implode(",", $block-&gt;getRequest()-&gt;getParams()), ',');
    $category=($block-&gt;getCurrentCategory())?$block-&gt;getCurrentCategory()-&gt;getName():'no-category';
    $store_id = Mage::app()-&gt;getStore()-&gt;getId();
    return 'edmondscommerce-'. $params . '-'. $category . '-' . $store_id . '-' . $class.'-'.$template.'-'.$md5;
}
</code></pre>

<p>```</p>

<p>You would use this in the following way:</p>

<p>In a block class, set up the following:
```php</p>

<pre><code>public function _construct(){
    parent::_construct();
    $this-&gt;addData(array(
        'cache_lifetime' =&gt; 999999999,
        'cache_tags' =&gt; array(Mage_Catalog_Model_Product::CACHE_TAG, Mage_Catalog_Model_Category::CACHE_TAG),
        'cache_key' =&gt; Mage::helper('blockcaching')-&gt;ecCacheKey($this)
    ));

}
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using Netbeans to generate PHP class methods]]></title>
    <link href="http://edmondscommerce.github.io/netbeans/using-netbeans-to-generate-php-class-methods.html"/>
    <updated>2012-03-08T14:31:19+00:00</updated>
    <id>http://edmondscommerce.github.io/netbeans/using-netbeans-to-generate-php-class-methods</id>
    <content type="html"><![CDATA[<p>One of the features that I was previously unaware of in Netbeans is its ability to automatically generate common class methods. This post is a quick guide of how this works for future reference.</p>

<p>To get the system to work, first load up a php class. For this example I&rsquo;m going to be extending the Magento Product Model. This basic class can be seen here, with a couple of extra properties added.
<img src="/assets/screenshot5-600x166.png"></p>

<p>To start generating the methods you need to press [Alt] &amp; [Insert] and you will be presented with a menu similar to the one below</p>

<p><img src="/assets/screenshot6.png"></p>

<p>This lists all of the common methods that do not currently exist within the class. The first thing that we&rsquo;ll do is to generate a constructor, which gives us the following options</p>

<p><img src="/assets/screenshot7.png"></p>

<p>Here you can select which of the class properties you want to be set using the constructor. Pick the ones you want and click OK, and the following code is generated</p>

<p><img src="/assets/screenshot8-600x368.png"></p>

<p>The Getters and Setters work in the same way, and the Override &amp; Implement provides you with a list of all of the methods that the class can override from its parents. Using these together can help you to quickly all of the methods you need in minutes, as shown below.</p>

<p><img src="/assets/screenshot14-600x547.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHP DomPDF Bug - page_cache.cls.php on line 66 dompdf + Solution]]></title>
    <link href="http://edmondscommerce.github.io/php/php-dompdf-bug-page_cache-cls-php-on-line-66-dompdf-solution.html"/>
    <updated>2011-06-24T15:29:39+01:00</updated>
    <id>http://edmondscommerce.github.io/php/php-dompdf-bug-page_cache-cls-php-on-line-66-dompdf-solution</id>
    <content type="html"><![CDATA[<div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>If you are struggling with a weird bug with DomPDF, something about it trying to connect to a postgres database..</p>

<p>well here is the solution that will get you up and running:</p>

<p>open the file and make the init method just return false</p>

<p>```php</p>

<p>class Page_Cache {</p>

<pre><code>const DB_USER = "dompdf_page_cache";
const DB_PASS = "some meaningful password";
const DB_NAME = "dompdf_page_cache";

static private $__connection = null;

function init() {
    return false;
    if (is_null(self::$__connection)) {
        $con_str = "host=" . DB_HOST .
                " dbname=" . self::DB_NAME .
                " user=" . self::DB_USER .
                " password=" . self::DB_PASS;

        if (!self::$__connection = pg_connect($con_str))
            throw new Exception("Database connection failed.");
    }
}
</code></pre>

<p>```</p>

<p>Not sure really why this is trying to do this, obviously some kind of hard coded postgres caching system but anyway this fixed it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Netbeans Autocomplete on Class Properties Using PHPDoc]]></title>
    <link href="http://edmondscommerce.github.io/netbeans/netbeans-autocomplete-on-class-properties-using-phpdoc.html"/>
    <updated>2010-05-12T11:26:41+01:00</updated>
    <id>http://edmondscommerce.github.io/netbeans/netbeans-autocomplete-on-class-properties-using-phpdoc</id>
    <content type="html"><![CDATA[<div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>If you are using netbeans for PHP classes and you have some of your class properties are instances of other objects and you want to get autocomplete working for them, then you might struggle to figure out which PHPDoc syntax to use to get autocomplete working.</p>

<p>Here is the answer:</p>

<p>```php</p>

<p>/<em>*
* @property MyObject $myObject
* @property AnotherObject $anotherObject
</em>/
class MyClass{</p>

<pre><code> protected $myObject;
 protected $anotherObject;

 public function __construct($myObject, $anotherObject){
     $this-&gt;myObject=$myObject;
     $this-&gt;anotherObject=$anotherObject;
 }

 public function autocomplete(){
     $this-&gt;myObject-&gt;//autocomplete works here
 }
</code></pre>

<p>}</p>

<p>```</p>
]]></content>
  </entry>
  
</feed>
