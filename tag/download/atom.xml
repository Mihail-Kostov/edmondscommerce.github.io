<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: download | Edmonds Commerce Dev Blog]]></title>
  <link href="http://edmondscommerce.github.io/tag/download/atom.xml" rel="self"/>
  <link href="http://edmondscommerce.github.io/"/>
  <updated>2015-06-24T10:23:39+01:00</updated>
  <id>http://edmondscommerce.github.io/</id>
  <author>
    <name><![CDATA[EdmondsCommerce Development Team]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[PHP Force Download with Custom Filename]]></title>
    <link href="http://edmondscommerce.github.io/php/php-force-download-with-custom-filename.html"/>
    <updated>2012-01-23T15:22:03+00:00</updated>
    <id>http://edmondscommerce.github.io/php/php-force-download-with-custom-filename</id>
    <content type="html"><![CDATA[<p>If you want to serve up text files for download (perhaps product feeds etc) then you might like this little snippet.</p>

<p>Not only will it force the file to be downloaded but it allows you to specify a custom filename that it should be saved as.</p>

<p>```php</p>

<p>if(isset($_GET[&lsquo;download_file&rsquo;])){</p>

<pre><code>header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=Export.txt");
readfile('Export.txt');
die;
</code></pre>

<p>}</p>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Kevin Mayhew]]></title>
    <link href="http://edmondscommerce.github.io/portfolio/kevin-mayhew.html"/>
    <updated>2011-06-09T14:24:14+01:00</updated>
    <id>http://edmondscommerce.github.io/portfolio/kevin-mayhew</id>
    <content type="html"><![CDATA[<div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<h2>Magento Site Upgrade</h2>


<p>Kevin Mayhew Ltd. required their Magento site to be upgraded from Enterprise 1.7 to the current release. They are looking to do this because the current site is having problems with some of the functionality which can only be correct by upgrading an extension and the extensions latest version is not compatibility with 1.7. 1.7 is also preventing them from improving the site and adding functionality. This mainly involved updating their site templates to function correctly the the new release as well as resolving issues related to old/new extensions.</p>

<h3>Kevin Mayhew</h3>


<p>Kevin Mayhew is a Christian religious product and music retailer, Christian church resource supplier and Christian book publisher.</p>

<p><img src="/assets/kevinmayhew1-300x216.png"></p>

<p>This project went really well with the pushing to live been successful. With the site now running the latest version of Magento the company can look forward toward to expanding the functionality of the site as well as resolving issues the old site was having.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using PHP to Stream SQL results dynamically as CSV, even to IE]]></title>
    <link href="http://edmondscommerce.github.io/php/using-php-to-stream-sql-results-dynamically-as-csv-even-to-ie.html"/>
    <updated>2011-06-06T10:49:46+01:00</updated>
    <id>http://edmondscommerce.github.io/php/using-php-to-stream-sql-results-dynamically-as-csv-even-to-ie</id>
    <content type="html"><![CDATA[<div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>


<p>If you want to offer a csv feed and want the results to be on demand and like the idea of avoiding messing about righting to files on the server etc, you might like this little manuever.</p>

<p>You will notice I&rsquo;m using a non standard db_query function, just assume that this does all the sensible stuff it should.</p>

<p>Also the query needs to be modified to suit.</p>

<p>The trick is writing to PHP&rsquo;s built in php://output stream which is basically just STDOUT.</p>

<p>Note the headers which are specifically required to get IE to accept the file as a download. Other browsers will accept less headers but will also work fine with these.</p>

<p>```php</p>

<p>header(&ldquo;Pragma: public&rdquo;);
header(&ldquo;Expires: 0&rdquo;);
header(&ldquo;Cache-Control: must-revalidate, post-check=0, pre-check=0&rdquo;);
header(&ldquo;Cache-Control: private&rdquo;, false);
header(&ldquo;Content-Type: application/octet-stream&rdquo;);
header(&ldquo;Content-Disposition: attachment; filename=\"file.csv\&rdquo;;&ldquo;);
header("Content-Transfer-Encoding: binary&rdquo;);</p>

<p>$outstream = fopen(&ldquo;php://output&rdquo;, &lsquo;w&rsquo;);</p>

<p>$sql = &ldquo; select * from a_table&rdquo;;
$q = db_query(&ldquo;$sql&rdquo;);</p>

<p>$header = false;
while ($r = mysql_fetch_assoc($q)) {</p>

<pre><code>if (!$header) {
    fputcsv($outstream, array_keys($r));
    $header = true;
}
fputcsv($outstream, $r);
</code></pre>

<p>}
fclose($outstream);</p>

<p>```</p>
]]></content>
  </entry>
  
</feed>
