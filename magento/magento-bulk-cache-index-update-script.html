<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Magento Bulk Cache / Index Update Script - Edmonds Commerce Dev Blog</title>
  <meta name="author" content="EdmondsCommerce Development Team">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://edmondscommerce.github.io/magento/magento-bulk-cache-index-update-script.html">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Edmonds Commerce Dev Blog" type="application/atom+xml">

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27853727-2', 'edmondscommerce.github.io');
  ga('send', 'pageview');

</script>

</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img height="20" src="https://2.gravatar.com/avatar/04b807394911b26ea8a79dbe25ea4e1a?d=https%3A%2F%2Fidenticons.github.com%2Fccb745f4b144d30c4b883330a1114834.png&amp;r=x&amp;s=140" width="20"> Dev Blog</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
                
                <li ><a href="/categories/index.html">Categories</a></li>
                
                <li ><a href="/contact-us/index.html">Contact</a></li>
                
            </ul>
            <ul class="nav pull-right">
                
                
                <li><a href="http://linkedin.com/in/edmondscommerce" title="Linkedin Profile"><i class="icon-linkedin-sign social-navbar"></i></a></li>
                
                
                
                <li><a href="http://plus.google.com/104488822194646220248" title="Google+ Profile"><i class="icon-google-plus-sign social-navbar"></i></a></li>
                
                
                
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="http://google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:edmondscommerce.github.io">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <article class="hentry" role="article">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2009-05-11T15:00:46+01:00" pubdate data-updated="true">May 11<span>th</span>, 2009</time>
        
      </p>
    
    
    <h1 class="entry-title">
        Magento Bulk Cache / Index Update Script
        
    </h1>
    
  </header>


<div class="entry-content clearfix"><div class="oldpost"><h4>This is an old post. The information it contains is probably out of date or innacurate</h4>
<p>
This is a post that was written a long time ago and is only being kept here for posterity.
You should probably look up more recent blog posts related to the subject you are researching
</p>
</div>


<p>If you are doing any kind of bulk updating etc then you also need to make sure that you rebuild all of the caches and indexes after your bulk updates otherwise things can go wrong.</p>

<p>I have just managed to get the following script to work including when flat catalog is enabled (thanks to <a href="http://www.nicksays.co.uk/2009/02/testing-magento-modules/" target="_blank">Nick of Meanbee</a> for the Mage::app() tip).</p>

<p>This script can be called from the browser (I would highly recommend some form of IP restriction or other security) or called from a cron job.</p>

<figure class='code panel panel-default'><figcaption class='panel-heading'><h3 class='panel-title'></h3></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'><span class="nv">$magePath</span> <span class="o">=</span> <span class="s1">&#39;/path/to/Mage.php&#39;</span><span class="p">;</span>
</span><span class='line'><span class="k">require_once</span> <span class="nv">$magePath</span><span class="p">;</span>
</span><span class='line'><span class="c1">//Varien_Profiler::enable();</span>
</span><span class='line'><span class="c1">//Mage::setIsDeveloperMode(true);</span>
</span><span class='line'><span class="c1">//ini_set(&#39;display_errors&#39;, 1);</span>
</span><span class='line'><span class="nb">umask</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">setCurrentStore</span><span class="p">(</span><span class="nx">Mage_Core_Model_App</span><span class="o">::</span><span class="na">ADMIN_STORE_ID</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;&lt;h3&gt;Cleaning overall Cache&lt;/h3&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="c1">// clean overall cache</span>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">app</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cleanCache</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;done&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;&lt;h3&gt;Cleaning Catalog Rewrites&lt;/h3&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="c1">// clear &#39;refresh_catalog_rewrites&#39;:</span>
</span><span class='line'><span class="c1">//Mage::getSingleton(&#39;catalog/url&#39;)-&gt;refreshRewrites();</span>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">getModel</span><span class="p">(</span><span class="s1">&#39;catalog/url&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">refreshRewrites</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Catalog Rewrites was refreshed succesfuly&lt;br&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;&lt;h3&gt;Cleaning Image Cache&lt;/h3&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="c1">//  clear &#39;clear_images_cache&#39;:</span>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">getModel</span><span class="p">(</span><span class="s1">&#39;catalog/product_image&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">clearCache</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Image cache was cleared succesfuly&lt;br&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;&lt;h3&gt;Cleaning Layered Navigation&lt;/h3&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="c1">//  clear &#39;refresh_layered_navigation&#39;:</span>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">getSingleton</span><span class="p">(</span><span class="s1">&#39;catalogindex/indexer&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">plainReindex</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Layered Navigation Indices was refreshed succesfuly&lt;br&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;&lt;h3&gt;Clearing out Search Index&lt;/h3&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">getModel</span><span class="p">(</span><span class="s1">&#39;catalogsearch/fulltext&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">rebuildIndex</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Search index was rebuilt succesfully&lt;br&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;&lt;h3&gt;Rebuilding Flat Category&lt;/h3&gt;&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">getResourceSingleton</span><span class="p">(</span><span class="s1">&#39;catalog/category_flat&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">rebuild</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;flat category was rebuilt successfully&lt;br&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;&lt;h3&gt;Rebuilding Flat Products&lt;/h3&gt;&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nx">Mage</span><span class="o">::</span><span class="na">getResourceSingleton</span><span class="p">(</span><span class="s1">&#39;catalog/product_flat_indexer&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">rebuild</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;flat product was rebuilt successfully&lt;br&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">flush</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<h4>More&#8230;</h4>


<pre><code>        &lt;div style="font-size: .6em;"&gt;&lt;a href="http://ecommerce.aheadworks.com/blog/2009/05/magento-world-newsletter-may-5-2009/" rel="nofollow"&gt;Magento World Newsletter (May 5, 2009)&lt;/a&gt;&lt;br&gt;&lt;a href="http://kernelhack.com/?p=37" rel="nofollow"&gt;How to add custom fields to &lt;b&gt;Magento&lt;/b&gt; checkout | KERNELHACK.com&lt;/a&gt;&lt;br&gt;&lt;a href="http://www.magento.cn/111/ecommerce-seo/magento-stores-ecommerce-search-engine-optimization/" rel="nofollow"&gt;&lt;b&gt;Magento&lt;/b&gt; Stores Ecommerce Search Engine Optimization, &lt;b&gt;Magento&lt;/b&gt; store &lt;b&gt;...&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;/div&gt;
</code></pre>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="byline author vcard">Posted by <span class="fn">admin</span></span></span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2009-05-11T15:00:46+01:00" pubdate data-updated="true">May 11<span>th</span>, 2009</time>
          

<span class="glyphicon glyphicon-folder-open" title="categories"></span>&nbsp;
<span class="categories">
  
    <a class='category label label-primary' href='/category/magento/'>magento</a>
  
</span>


          

<br/>
<span class="glyphicon glyphicon-tags" title="tags"></span>&nbsp;
<span class="tags">
  
    <a class='tag' href='/tag/magento-cache/'>magento cache</a>
  
</span>



        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://edmondscommerce.github.io/magento/magento-bulk-cache-index-update-script.html" data-via="" data-counturl="http://edmondscommerce.github.io/magento/magento-bulk-cache-index-update-script.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/oscommerce/creloaded-uk.html" title="Previous Post: CRE Loaded UK">&laquo; CRE Loaded UK</a></li>
            
            
            <li class="next"><a href="/magento/new-magento-based-site-launched-with-advanced-catalogue-handling.html" title="Next Post: New Magento Based Site Launched with Advanced Catalogue Handling.">New Magento Based Site Launched with Advanced Catalogue Handling. &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/phpstorm/wrapping-a-list-in-quotes-in-phpstorm.html">Wrapping a List in Quotes in PHPStorm</a>
    
    <a class="list-group-item " href="/composer/merging-forks-for-composer.html">Merging Forks for Composer</a>
    
    <a class="list-group-item " href="/SEO/the-first-thing-you-should-read-on-seo.html">The First Thing You Should Read on SEO</a>
    
    <a class="list-group-item " href="/Octoress/octopress-auto-building-the-site-locally-for-one-blog-post.html">Octopress Auto Building the Site Locally for One Blog Post</a>
    
    <a class="list-group-item " href="/mysql/sorting-results-arbitrarily-in-mysql.html">Sorting Results Arbitrarily in MySQL</a>
    
  </div>
</section>




<section class="googleplus panel panel-default">
  <div class="panel-body">
    <h3>
      <a href="https://plus.google.com/104488822194646220248?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h3>
  </div>
</section>


<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">About Us</h3>
    </div>
    <div class="panel-body">
        <p>
            <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
            agency.
        </p>

        <p>
            We are based in <a href="http://www.yorkshire.com/">Yorkshire</a> near <a
                href="http://www.visitleeds.co.uk/">Leeds</a> and <a href="http://www.visitbradford.com/">Bradford</a>.
        </p>

        <p>
            Our primary specialism is <a href="http://magento.com/">Magento</a> and other PHP based E-Commerce platforms
            such as <a href="http://www.opencart.com/">OpenCart</a>.
        </p>

        <p>
            In terms of technology we are very strong in:
        <ul>
            <li><a href="http://php.net/">PHP</a>,</li>
            <li><a href="http://www.mysql.com/">MySQL</a>,</li>
            <li><a href="http://www.linuxfoundation.org/">Linux</a>,</li>
            <li><a href="http://www.w3.org/standards/techs/html#w3c_all">HTML<a/>,</li>
            <li><a href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a></li>
            <li><a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.</li>
        </ul>
        </p>
    </div>
</section>

<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Commercial Enquiries</h3>
    </div>
    <div class="panel-body">
        <p>
            If you would like to discuss your project requirements then please get in touch today.
        </p>

        <p>
            <a href="http://www.edmondscommerce.co.uk">www.edmondscommerce.co.uk</a><br/><br/>
            <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br/><br/>
            <a href="tel:00441274590036">+44 1274 590036</a>
        </p>
    </div>
</section>

    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2013 - EdmondsCommerce Development Team<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>






  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </body>
</html>
