<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Running out of disk space but df shows you have lots of space left &middot; </title>

  
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/poole.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="https://edmondscommerce.github.io/css/highlight/github.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link href="https://edmondscommerce.github.io/favicon.ico" rel="icon">

  
  
  
  

  <meta name="description" content="Server reporting disk space shortage when there is plenty">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'google analytics', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
        <a href="/"><img src="/images/eclogo.png"
             alt="gravatar" title="">
        </a>
      
      <h1></h1>
      
    </div>
    <p>
      <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
      agency. We are based in <a href="http://www.yorkshire.com/">Yorkshire</a> near <a href="http://www.visitleeds.co.uk/">Leeds</a> and <a href="http://www.visitbradford.com/">Bradford</a>.
    </p>

    <p>
      Our primary specialism is <a href="http://magento.com/">Magento</a> and other PHP based E-Commerce platforms
      such as <a href="http://www.opencart.com/">OpenCart</a>.
    </p>

    <p>
      In terms of technology we are very strong in <a href="http://php.net/">PHP</a>, <a href="http://www.mysql.com/">MySQL</a>, <a href="http://www.linuxfoundation.org/">Linux</a>,
      <a href="http://www.w3.org/standards/techs/html#w3c_all">HTML</a><a>, <a href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a> and <a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.</li>
  </ul>


    <ul class="sidebar-nav">
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/edmondscommerce"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      <a href="https://www.linkedin.com/company/edmonds-commerce"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/104488822194646220248?rel=author"><i class="fa fa-google-plus-square fa-3x"></i></a>
      
      <a href="https://twitter.com/edmondscommerce"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="https://edmondscommerce.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
      <p>
        <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br>
        <a href="tel:00441138805654">0044 113 880 5654</a>
      </p>
    </ul>

    

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">Running out of disk space but df shows you have lots of space left</h1>
    <span class="post-date">May 7, 2015 &middot; 1 minute read
    
    <br/>
      <strong>Category: </strong>
    <a class="label" href="https://edmondscommerce.github.io/categories/linux">linux</a><a class="label" href="https://edmondscommerce.github.io/categories/vps">vps</a><a class="label" href="https://edmondscommerce.github.io/categories/server">server</a>
    </span>
    <p>Had a strange occurency this morning with an server reporting it had no disk space when disk usage according to df was at 50%. After some head scratching I decided to read the man page for the df command and came across the -i flag. According the man page this lists inode information instead of block usage. After running it I got the following:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>Filesystem      Inodes   IUsed  IFree IUse% Mounted on
/dev/xvda1     <span class="m">2621440</span> <span class="m">2621440</span>      <span class="m">0</span>  100% /
udev            <span class="m">124879</span>     <span class="m">398</span> <span class="m">124481</span>    1% /dev
tmpfs           <span class="m">126892</span>     <span class="m">288</span> <span class="m">126604</span>    1% /run
none            <span class="m">126892</span>       <span class="m">4</span> <span class="m">126888</span>    1% /run/lock
none            <span class="m">126892</span>       <span class="m">1</span> <span class="m">126891</span>    1% /run/shm
none            <span class="m">126892</span>       <span class="m">1</span> <span class="m">126891</span>    1% /run/user
</code></pre></div>

<p>So it turned out that the system had reached its max inodes so the next line of investigation was to find any excess of files in an directory. Which was sone by using:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="k">for</span> i in /var/*<span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$i</span><span class="p">;</span> find <span class="nv">$i</span> <span class="p">|</span> wc -l<span class="p">;</span> <span class="k">done</span>
</code></pre></div>

<p>This will list the total number of files in a given directory. You can change the path to work your way down the directory tree finding directories with lots of files. In the end we found excess of old logs which I was able to remove.</p>

  </div>
  
  <br/>
  <strong>Tags: </strong>
  <a class="label" href="https://edmondscommerce.github.io/tags/linux">linux</a><a class="label" href="https://edmondscommerce.github.io/tags/disk-space">disk space</a><a class="label" href="https://edmondscommerce.github.io/tags/inode">inode</a><a class="label" href="https://edmondscommerce.github.io/tags/server">server</a><a class="label" href="https://edmondscommerce.github.io/tags/vps">vps</a>
  
  
</div>




<script src="https://edmondscommerce.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

