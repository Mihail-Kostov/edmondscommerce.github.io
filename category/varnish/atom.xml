<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: varnish | Edmonds Commerce Dev Blog]]></title>
  <link href="http://edmondscommerce.github.io/category/varnish/atom.xml" rel="self"/>
  <link href="http://edmondscommerce.github.io/"/>
  <updated>2015-02-11T16:19:12+00:00</updated>
  <id>http://edmondscommerce.github.io/</id>
  <author>
    <name><![CDATA[EdmondsCommerce Development Team]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Varnish and Nginx redirecting to port 8080]]></title>
    <link href="http://edmondscommerce.github.io/nginx/varnish/varnish-and-nginx-redirecting-to-port-8080.html"/>
    <updated>2015-01-23T15:22:43+00:00</updated>
    <id>http://edmondscommerce.github.io/nginx/varnish/varnish-and-nginx-redirecting-to-port-8080</id>
    <content type="html"><![CDATA[<p>So theres a strange problem where any redirects are going port 8080 when running your web application or site under varnish and nginx. Now arroung the web the solution apears to have varnish listen locally on port 80 while leaving nginx to listen on port 80 for any network addresses. The issue is that nginx when doing a redirect will add the port automatically to any redirect specified in nginx or is triggered from php, this is so that you dont have to ajust your rewrites if you are running on a non standard web port. But in the case of running varnish on top we dont want this behaviour to happen.</p>

<p>To stop this in the location, server or http context of your nginx config. Simply add:</p>

<p><code>bash
port_in_redirect off;
</code></p>

<p>As by default according to the <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#port_in_redirect">nginx documentation</a> this behaviour is on by default.</p>
]]></content>
  </entry>
  
</feed>
