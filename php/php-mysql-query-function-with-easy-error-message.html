<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>PHP MySQL Query Function with Easy Error Message &middot; </title>

  
  <link rel="stylesheet" href="http://example.com/css/poole.css">
  <link rel="stylesheet" href="http://example.com/css/hyde.css">
  <link rel="stylesheet" href="http://example.com/css/poole-overrides.css">
  <link rel="stylesheet" href="http://example.com/css/hyde-overrides.css">
  <link rel="stylesheet" href="http://example.com/css/hyde-x.css">
  <link rel="stylesheet" href="http://example.com/css/highlight/github.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link href="http://example.com/favicon.ico" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'google analytics', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
        <a href="/"><img src="/images/eclogo.png"
             alt="gravatar" title="">
        </a>
      
      <h1></h1>
      
    </div>
    <p>
      <a href="http://www.edmondscommerce.co.uk">Edmonds Commerce</a> are a UK based E-Commerce web development
      agency. We are based in <a href="http://www.yorkshire.com/">Yorkshire</a> near <a href="http://www.visitleeds.co.uk/">Leeds</a> and <a href="http://www.visitbradford.com/">Bradford</a>.
    </p>

    <p>
      Our primary specialism is <a href="http://magento.com/">Magento</a> and other PHP based E-Commerce platforms
      such as <a href="http://www.opencart.com/">OpenCart</a>.
    </p>

    <p>
      In terms of technology we are very strong in <a href="http://php.net/">PHP</a>, <a href="http://www.mysql.com/">MySQL</a>, <a href="http://www.linuxfoundation.org/">Linux</a>,
      <a href="http://www.w3.org/standards/techs/html#w3c_all">HTML</a><a>, <a href="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a> and <a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a>.</li>
  </ul>


    <ul class="sidebar-nav">
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/edmondscommerce"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      <a href="https://www.linkedin.com/company/edmonds-commerce"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/104488822194646220248?rel=author"><i class="fa fa-google-plus-square fa-3x"></i></a>
      
      <a href="https://twitter.com/edmondscommerce"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="http://example.com/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
      <p>
        <a href="mailto:info@edmondscommerce.co.uk">info@edmondscommerce.co.uk</a><br>
        <a href="tel:00441138805654">0044 113 880 5654</a>
      </p>
    </ul>

    

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">PHP MySQL Query Function with Easy Error Message</h1>
    <span class="post-date">Mar 3, 2008 &middot; 2 minute read
    
    <br/>
    <a class="label" href="http://example.com/categories/php">php</a>
    </span>
    <p><div class="oldpost"><h4>This is post is now quite old and the the information it contains may be out of date or innacurate.</h4>
<p>
If you find any errors or have any suggestions to update the information <a href="http://edmondscommerce.github.io/contact-us/index.html">please let us know</a>
or <a href="https://github.com/edmondscommerce/edmondscommerce.github.io">create a pull request on GitHub</a>
</p>
</div>
This is a simple mysql query function that gives you a nice understandable error message if something goes wrong. You probably would not want this kind of error reporting on a live site, but for testing and developing its pretty handy.</p>

<p>What the function does it perform the database query as normal, but if the query fails, the function gives you a full breakdown of the mysql error messsage allowing you to easily see what has gone wrong and fix it.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span></span><span class="x">function db_query($query){</span>

<span class="x">$output = mysql_query($query) or die(&#39;</span>
<span class="x">&lt;h1 style=&quot;color: red&quot;&gt;Uh Oh......MySQL Error:&lt;/h1&gt;</span>
<span class="x">&lt;h3&gt;Query:&lt;/h3&gt;</span>
<span class="x">&lt;pre&gt;&#39; . htmlentities($query) . &#39;&lt;/pre&gt;</span>
<span class="x">&lt;h3&gt;MySQL Error:&lt;/h3&gt;</span>
<span class="x">&#39; . mysql_error() . &#39;</span>
<span class="x">&lt;hr /&gt; &lt;hr /&gt;&#39;);	return $output;</span>

<span class="x">}</span>
</code></pre></div>

<p>You would not want to use this query on a live site that is public facing as the error messages will help someone who is trying to break into your system. If you wanted to be able to use this function on a live site and quickly turn the error reporting on and off, we could use a definition like this:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span></span><span class="x">define(MYSQL_ERROR_REPORTING: false;);</span>
</code></pre></div>

<p>Then change the function to be like this:</p>

<p>```php</p>

<p>function db_query($query){
if(MYSQL_ERROR_REPORTING){
$output = mysql_query($query) or die(&rsquo;
<h1 style="color: red">Uh Oh&hellip;&hellip;MySQL Error:</h1>
<h3>Query:</h3>
<pre>&rsquo; . htmlentities($query) . &lsquo;</pre>
<h3>MySQL Error:</h3>
&lsquo; . mysql_error() . &lsquo;
<hr /> <hr />&rsquo;);
}else{
$output = mysql_query($query);
}
return $output;
}</p>

<p>```Then if you need to see the mysql errors, you can quickly edit the definition to allow mysql error reporting by changing the definition to true.</p>

<p>We would always recommend developing and debugging web sites on the localhost and only making changes to the live site once you are sure that everything works. However sometimes for whatever reason it is hard to replicate an error on the localhost so you really need to see what&rsquo;s happening on the live site.</p>

<p>Alternatively if you are developing an internal system that will only be accessed by your own staff, then some built in error reporting helps you to fix problems that may occur, and also helps your more savvy staff to understand what has gone wrong and give you a good idea so that you can fix it.</p>

  </div>
  
</div>




<script src="http://example.com/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

